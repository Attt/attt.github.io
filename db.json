{"meta":{"version":1,"warehouse":"4.0.1"},"models":{"Asset":[{"_id":"themes/fluid/source/css/gitalk.css","path":"css/gitalk.css","modified":1,"renderable":1},{"_id":"themes/fluid/source/css/highlight-dark.styl","path":"css/highlight-dark.styl","modified":1,"renderable":1},{"_id":"themes/fluid/source/css/highlight.styl","path":"css/highlight.styl","modified":1,"renderable":1},{"_id":"themes/fluid/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/fluid/source/img/avatar.png","path":"img/avatar.png","modified":1,"renderable":1},{"_id":"themes/fluid/source/img/default.png","path":"img/default.png","modified":1,"renderable":1},{"_id":"themes/fluid/source/img/fluid.png","path":"img/fluid.png","modified":1,"renderable":1},{"_id":"themes/fluid/source/img/loading.gif","path":"img/loading.gif","modified":1,"renderable":1},{"_id":"themes/fluid/source/img/police_beian.png","path":"img/police_beian.png","modified":1,"renderable":1},{"_id":"themes/fluid/source/js/boot.js","path":"js/boot.js","modified":1,"renderable":1},{"_id":"themes/fluid/source/js/color-schema.js","path":"js/color-schema.js","modified":1,"renderable":1},{"_id":"themes/fluid/source/js/events.js","path":"js/events.js","modified":1,"renderable":1},{"_id":"themes/fluid/source/js/leancloud.js","path":"js/leancloud.js","modified":1,"renderable":1},{"_id":"themes/fluid/source/js/img-lazyload.js","path":"js/img-lazyload.js","modified":1,"renderable":1},{"_id":"themes/fluid/source/js/local-search.js","path":"js/local-search.js","modified":1,"renderable":1},{"_id":"themes/fluid/source/js/plugins.js","path":"js/plugins.js","modified":1,"renderable":1},{"_id":"themes/fluid/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"themes/fluid/source/xml/local-search.xml","path":"xml/local-search.xml","modified":1,"renderable":1},{"_id":"source/fonts/LXGWWenKaiMono-Regular.woff2","path":"fonts/LXGWWenKaiMono-Regular.woff2","modified":1,"renderable":0},{"_id":"source/fonts/LXGWWenKaiScreenR.woff2","path":"fonts/LXGWWenKaiScreenR.woff2","modified":1,"renderable":0},{"_id":"source/images/0.jpg","path":"images/0.jpg","modified":1,"renderable":0},{"_id":"source/images/eye0.jpg","path":"images/eye0.jpg","modified":1,"renderable":0},{"_id":"source/images/eye1.jpg","path":"images/eye1.jpg","modified":1,"renderable":0},{"_id":"source/images/takadanobaba.jpg","path":"images/takadanobaba.jpg","modified":1,"renderable":0},{"_id":"source/images/jojo.jpg","path":"images/jojo.jpg","modified":1,"renderable":0},{"_id":"source/images/me.png","path":"images/me.png","modified":1,"renderable":0},{"_id":"source/images/takadanobaba1.jpg","path":"images/takadanobaba1.jpg","modified":1,"renderable":0},{"_id":"source/images/wechat.jpg","path":"images/wechat.jpg","modified":1,"renderable":0}],"Cache":[{"_id":"source/_posts/case-sensitive-collation-in-mysql.md","hash":"6ad6b04431166eed2419eb3042329480039b2a90","modified":1655559295711},{"_id":"source/_posts/arch-linux-setup-guide.md","hash":"a5edcc8eb8e772877fd1b58c4f37f531ff21f953","modified":1655558841585},{"_id":"source/_posts/fgo-frida-il2cpp-bridge.md","hash":"8eb7a5af4a05b7d144110f5b14b134b1a0d622c9","modified":1655133826980},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class.md","hash":"db9875e7e33d36a1d18893608857e3e2cab07c11","modified":1655558280176},{"_id":"source/_posts/spring-rabbitmq-binding-trap.md","hash":"738033aaefdf3d0ca675a0affd298a07130af07a","modified":1655559370158},{"_id":"source/_posts/shell-some-memos-for-shell-script.md","hash":"fa84b9618884501ee2b02ebb0f204de5d63aee4d","modified":1655558725042},{"_id":"source/_posts/useful-utils.md","hash":"a6e9fa651b4c134d9f0177447fe30790884604ae","modified":1655559379132},{"_id":"source/about/index.md","hash":"157149d8dffd335039397ac3bdb413af81024e56","modified":1655540763802},{"_id":"source/categories/index.md","hash":"6ccd1de20346e08e0a76785ae7628524f934a9be","modified":1655131084755},{"_id":"source/css/fix-input-shadow.css","hash":"720b6f75c588d206c26209a17f902d82cc74e2d8","modified":1655547925714},{"_id":"source/css/fonts.css","hash":"83c77623075995cc36038c2d2b288e650678131e","modified":1655542542676},{"_id":"source/tags/index.md","hash":"1c60e5c61c112001eccf9ff4e35958a47d4de0be","modified":1655132808750},{"_id":"source/search/index.md","hash":"277a816084d58b4e9adaa8d868975c7e793e8e7f","modified":1655207277390},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/6.png","hash":"9066953c0c3dda2e33b7196e2c76607df9031842","modified":1655558257220},{"_id":"source/_data/languages/ja.yml","hash":"03fb195b7534ac9f710f7b04ad62c28dd58024ac","modified":1655545109645},{"_id":"source/_data/languages/zh-CN.yml","hash":"b05d1a43516dc6886d65631d90d6995acae673db","modified":1655539327767},{"_id":"source/images/eye0.jpg","hash":"7ecd3ae249dfa1d2285ef3b8c6a4637487416f49","modified":1655548835058},{"_id":"source/images/me.png","hash":"0a5449222d1957e9b69dabca1db65b51c53798ea","modified":1650264016856},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/0.png","hash":"622a8e751c216e4020cb319f9e0ca67f462d5208","modified":1650264016820},{"_id":"source/images/wechat.jpg","hash":"0f58bc98fcf489da3fd675de82191e77f7392dba","modified":1655540492511},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/5.png","hash":"32d8635ee433032162bc323cc0c7a9e1388649dc","modified":1650264016852},{"_id":"source/images/takadanobaba1.jpg","hash":"c94442a686c825fca464db1e9dd660d029652d63","modified":1655551071934},{"_id":"source/images/0.jpg","hash":"974145668d7657911d0fee01f816868293fe2e4f","modified":1650264016855},{"_id":"source/images/takadanobaba.jpg","hash":"c6f00d8d38492a0abd090ecb2a97163140d17210","modified":1655550430802},{"_id":"themes/fluid/source/css/_pages/_tag/tag.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1655539327853},{"_id":"themes/fluid/.editorconfig","hash":"b595159772f3ee1ef5e6780ce307270e741cb309","modified":1655539327754},{"_id":"themes/fluid/.eslintrc","hash":"3df89453e1f63051fafc90f16a8d83951050e316","modified":1655539327755},{"_id":"themes/fluid/.gitattributes","hash":"3e00e1fb043438cd820d94ee3dc9ffb6718996f3","modified":1655539327755},{"_id":"themes/fluid/.gitignore","hash":"9ede98b8d9dca802f82f651afb3b0366d69f05f1","modified":1655539327761},{"_id":"themes/fluid/LICENSE","hash":"511e49f0bd8282a0d002c527474da8e1e5add393","modified":1655539327762},{"_id":"themes/fluid/README_en.md","hash":"10ff41f4b3cf24ad0fece6555b77f61694916133","modified":1655539327763},{"_id":"themes/fluid/README.md","hash":"2ec6a89d66f8e41fded68aa8ec3b3363a20ea48c","modified":1655539327762},{"_id":"themes/fluid/_config.yml","hash":"3e309acfd433067266c4f6c6e9e4726eb814d6c3","modified":1655539327764},{"_id":"themes/fluid/package.json","hash":"1c05cec69cd3cf349b268f027a6916a9187601e0","modified":1655539327806},{"_id":"themes/fluid/languages/de.yml","hash":"c52ce73a291fa50953edbd11c1dfb1cc7cab52c2","modified":1655539327765},{"_id":"themes/fluid/languages/en.yml","hash":"2839da328f197cf90cafdf2b538fcd027ab6cfba","modified":1655539327765},{"_id":"themes/fluid/languages/eo.yml","hash":"76d2920b49c8d2489c37514489545d0fc4eac834","modified":1655539327766},{"_id":"themes/fluid/languages/ja.yml","hash":"411aa49e2e8dea90a6d8cc2dc92f264609ea273b","modified":1655539327767},{"_id":"themes/fluid/languages/es.yml","hash":"7fcd16cd363f1a166a3270c23c0660eff7475744","modified":1655539327766},{"_id":"themes/fluid/languages/zh-CN.yml","hash":"b05d1a43516dc6886d65631d90d6995acae673db","modified":1655539327767},{"_id":"themes/fluid/languages/zh-HK.yml","hash":"676b3ee8a16d796b4a898a9e5be2f52c372055ed","modified":1655539327768},{"_id":"themes/fluid/languages/zh-TW.yml","hash":"aac765cccef9f9044c4a88941fd01ba1883178fc","modified":1655539327769},{"_id":"themes/fluid/layout/404.ejs","hash":"0a589faccde6c2c9572e8d3d359e7c8fb166335e","modified":1655539327769},{"_id":"themes/fluid/layout/about.ejs","hash":"bd3ede2a5f45c5256cf8f883bb8fcca645834869","modified":1655539327798},{"_id":"themes/fluid/layout/archive.ejs","hash":"c524ce76747042ec2f9ed8d5025f80e01b462b3b","modified":1655539327799},{"_id":"themes/fluid/layout/categories.ejs","hash":"838a68e210bddfca6d4ba070e1e2f1ca53cb7d06","modified":1655539327800},{"_id":"themes/fluid/layout/category.ejs","hash":"264f68cbf826787e683a30e1377c56c0895c7386","modified":1655539327800},{"_id":"themes/fluid/layout/index.ejs","hash":"33ee985aaf03c8839d8f48e38113e851705cb2db","modified":1655539327801},{"_id":"themes/fluid/layout/layout.ejs","hash":"d4ffeb7eff398dea154340794bd277f75ddeedef","modified":1655539327801},{"_id":"themes/fluid/layout/links.ejs","hash":"fbed4b3d1e475b3de9d8ce05362abcc658a53408","modified":1655539327802},{"_id":"themes/fluid/layout/post.ejs","hash":"5a712dded014ff5a5ffea79fb0e30b429ae715c7","modified":1655539327804},{"_id":"themes/fluid/layout/page.ejs","hash":"8ba210724c023d45a4564415762f3da299bd1d0e","modified":1655539327802},{"_id":"themes/fluid/layout/tag.ejs","hash":"e87fc58829ea214ac16e8e4f13cd5c389133697b","modified":1655539327804},{"_id":"themes/fluid/layout/tags.ejs","hash":"b7c1a6d8fc1097fc16d2300260297013cb692153","modified":1655539327805},{"_id":"themes/fluid/.github/ISSUE_TEMPLATE/bug_report.md","hash":"beb3474d6f65c1e56700ba872c6a0d0836d4168e","modified":1655539327756},{"_id":"themes/fluid/.github/ISSUE_TEMPLATE/bug_report_zh.md","hash":"78ce211415d502c5a4398d786d5c697d34d868b9","modified":1655539327757},{"_id":"themes/fluid/.github/ISSUE_TEMPLATE/feature_request_zh.md","hash":"7db378613df2b7d13e8c428c006399a879a4a852","modified":1655539327758},{"_id":"themes/fluid/.github/ISSUE_TEMPLATE/feature_request.md","hash":"5cc30e7b6e7b77c8b40b182ba02a5d93d37d2fc2","modified":1655539327758},{"_id":"themes/fluid/.github/ISSUE_TEMPLATE/question.md","hash":"102213e5d6790d060c0e26b4a3a7ec744d753c52","modified":1655539327759},{"_id":"themes/fluid/.github/ISSUE_TEMPLATE/question_zh.md","hash":"18381d03518526d7cefd024a0bdd8d9e7c6440f5","modified":1655539327759},{"_id":"themes/fluid/.github/workflows/limit.yaml","hash":"bdbdb66da69ab7353b546f02150a6792f4787975","modified":1655539327760},{"_id":"themes/fluid/layout/_partials/archive-list.ejs","hash":"78c34e32746041f23678669bbadfbede15e4c6d2","modified":1655539327770},{"_id":"themes/fluid/layout/_partials/category-chains.ejs","hash":"508254a648d8597e62e4012c8beab44bfa82e904","modified":1655539327771},{"_id":"themes/fluid/layout/_partials/category-list.ejs","hash":"bd763ffc145a1f0b2c4a5dc8a101f0bc94b3f2f7","modified":1655539327772},{"_id":"themes/fluid/layout/_partials/comments.ejs","hash":"bfea4674af78eb72b3a6baaa7ec9fc3c3db55ebd","modified":1655539327772},{"_id":"themes/fluid/layout/_partials/css.ejs","hash":"70646e7f7a7684e12b298cd8a36fbea2814c3635","modified":1655539327780},{"_id":"themes/fluid/layout/_partials/head.ejs","hash":"3ca4c60a38b6b895986b15128a668266b1b12009","modified":1655539327783},{"_id":"themes/fluid/layout/_partials/footer.ejs","hash":"52b8954ae0eff5eb66a3841b37f144336b8f0866","modified":1655539327781},{"_id":"themes/fluid/layout/_partials/markdown-plugins.ejs","hash":"b5cd435b27f090939b6051bef41a38a3376044ac","modified":1655539327786},{"_id":"themes/fluid/layout/_partials/header.ejs","hash":"3668304d08c48b68d532532921a12069a2736150","modified":1655539327784},{"_id":"themes/fluid/layout/_partials/paginator.ejs","hash":"0d443f23c459787338917900f50fec1c8b3b3bdd","modified":1655539327786},{"_id":"themes/fluid/layout/_partials/scripts.ejs","hash":"89fc9f663a1091911b79ab9697c09446d16184f9","modified":1655539327797},{"_id":"themes/fluid/layout/_partials/search.ejs","hash":"57a0f61242d9ce2bd2c51b2f84193f6dc1377ef9","modified":1655539327798},{"_id":"themes/fluid/scripts/events/index.js","hash":"6c3b24207e4ea3ae4edeb715af40ef23711b92b9","modified":1655539327807},{"_id":"themes/fluid/scripts/filters/default-injects.js","hash":"3d30c722b9e24c33577d6fab822628841fadf992","modified":1655539327813},{"_id":"themes/fluid/scripts/filters/post-filter.js","hash":"1c9156e12030fa2219a933edde460ec563836047","modified":1655539327814},{"_id":"themes/fluid/scripts/filters/locals.js","hash":"2340a576635b16fd2456b3494f5afe89cd7764db","modified":1655539327813},{"_id":"themes/fluid/scripts/generators/local-search.js","hash":"bda7fbe58082a2a02c0db066794b791b14462271","modified":1655539327814},{"_id":"themes/fluid/scripts/generators/pages.js","hash":"a2a15ea722863aba09dcad578558432682a3b6b3","modified":1655539327815},{"_id":"themes/fluid/scripts/helpers/date.js","hash":"9bc9ba08d1d871394ee1c3a1cc2f21dc343f515a","modified":1655539327816},{"_id":"themes/fluid/scripts/helpers/engine.js","hash":"96af7e55fdbe0819bacc554ecbfe42375a088df6","modified":1655539327816},{"_id":"themes/fluid/scripts/helpers/export-config.js","hash":"00a41768fe258bb8f3323bf4bb0b862d6e2d97c0","modified":1655539327817},{"_id":"themes/fluid/scripts/helpers/import.js","hash":"f9821f7789ea6f069977a8c642aa5ccb6d19077c","modified":1655539327818},{"_id":"themes/fluid/scripts/helpers/page.js","hash":"49b2c6449d7be35739c6cfea3cab4e790580983a","modified":1655539327819},{"_id":"themes/fluid/scripts/helpers/injects.js","hash":"9219d59c51930c7a82fcde918d6efbc5aa572ea2","modified":1655539327818},{"_id":"themes/fluid/scripts/helpers/scope.js","hash":"a93b87835bfa491fa2aa90f97f25281e3a4ffed9","modified":1655539327820},{"_id":"themes/fluid/scripts/helpers/url.js","hash":"f713ddb6c8018ec7b96d3567057f1f932609beea","modified":1655539327820},{"_id":"themes/fluid/scripts/helpers/utils.js","hash":"d7ff7cf5e721dfeafe0c2a77a5929b2c3f8fee2a","modified":1655539327821},{"_id":"themes/fluid/scripts/helpers/wordcount.js","hash":"9c01393f446c490c56b6b0d482aaa8d97cc8b717","modified":1655539327821},{"_id":"themes/fluid/scripts/tags/button.js","hash":"e1d0caed12e7cd9a35cf64272c41854b2901a58f","modified":1655539327822},{"_id":"themes/fluid/scripts/tags/checkbox.js","hash":"aa03d0b914d87b9194ee3a0612ab5827a8dedbdd","modified":1655539327822},{"_id":"themes/fluid/scripts/tags/group-image.js","hash":"cc176cc1d7e7cc28cedf8397ae748c691d140be2","modified":1655539327823},{"_id":"themes/fluid/scripts/tags/label.js","hash":"6c5916d86c63795c7e910bf614b0e7ece5073702","modified":1655539327824},{"_id":"themes/fluid/scripts/tags/mermaid.js","hash":"dbfe59fde77d87b1d7d0c46480a2a729010988eb","modified":1655539327824},{"_id":"themes/fluid/scripts/tags/note.js","hash":"8020acc2c4bb3a2054e3cb349fac7cd10b79a0be","modified":1655539327825},{"_id":"themes/fluid/scripts/utils/compare-versions.js","hash":"37f90bd4e35ce49457dc2a348b9f66e0b242c014","modified":1655539327826},{"_id":"themes/fluid/scripts/utils/resolve.js","hash":"a5d70005913ab03cea0a0dc601097628b4dbd5a8","modified":1655539327827},{"_id":"themes/fluid/scripts/utils/object.js","hash":"3e03b534e2e92a6e17567b006d7e3eaad4b37598","modified":1655539327827},{"_id":"themes/fluid/scripts/utils/url-join.js","hash":"dbdb10b23fcd3928e86a4cb46fa3455e060b4aa0","modified":1655539327828},{"_id":"themes/fluid/source/css/gitalk.css","hash":"1fe60b2ab1d704f5a4f55e700dca5b8785fb390e","modified":1655539327856},{"_id":"themes/fluid/source/css/highlight-dark.styl","hash":"c74d7aed425d20f2fa096f386a9521b67b9ab269","modified":1655539327856},{"_id":"themes/fluid/source/css/highlight.styl","hash":"57ce8b8f95ab1f40612a9dce1793de5ab9b4bbfc","modified":1655539327857},{"_id":"themes/fluid/source/css/main.styl","hash":"9e9171325bb7148c11ceee283d00c137c8a1c5c5","modified":1655539327857},{"_id":"themes/fluid/source/img/avatar.png","hash":"fe739a158cc128f70f780eb5fa96f388b81d478f","modified":1655539327859},{"_id":"themes/fluid/source/img/fluid.png","hash":"64b215db2cb3af98fe639e94537cb5209f959c78","modified":1655539327862},{"_id":"themes/fluid/source/img/loading.gif","hash":"2d2fc0f947940f98c21afafef39ecf226a2e8d55","modified":1655539327862},{"_id":"themes/fluid/source/js/boot.js","hash":"3f92a93cb12e01f5ce54bc941fa6626b3ee2571a","modified":1655539327864},{"_id":"themes/fluid/source/img/police_beian.png","hash":"90efded6baa2dde599a9d6b1387973e8e64923ea","modified":1655539327863},{"_id":"themes/fluid/source/js/color-schema.js","hash":"31d35fe044ad01dda7975d47c99d636eaa81bfc8","modified":1655539327864},{"_id":"themes/fluid/source/js/leancloud.js","hash":"e9ad1b5659f0af867174687daa0ecf4375e40b75","modified":1655539327866},{"_id":"themes/fluid/source/js/events.js","hash":"7d70feed0a19e3d9f5886416ae99a72e21e2f10c","modified":1655539327865},{"_id":"themes/fluid/source/js/img-lazyload.js","hash":"67f6250f98b36a6599ea982d11cbb060c5ffb92a","modified":1655539327866},{"_id":"themes/fluid/source/js/local-search.js","hash":"1ab61ed47ec88c876e447872342fed9be560b0f0","modified":1655539327867},{"_id":"themes/fluid/source/js/plugins.js","hash":"5f33939016d0a7bb72d4376af46ebb28fbf85c04","modified":1655539327868},{"_id":"themes/fluid/source/js/utils.js","hash":"61e8108fe16fbf19ce13ea89b3120c1191bb4665","modified":1655539327868},{"_id":"themes/fluid/source/xml/local-search.xml","hash":"85fcc23b4db654a7f91fc55b6fb0442bb3ed3a9a","modified":1655539327869},{"_id":"themes/fluid/layout/_partials/comments/changyan.ejs","hash":"0c410ef79785897c8de3da333b057a2936fd569b","modified":1655539327773},{"_id":"themes/fluid/layout/_partials/comments/cusdis.ejs","hash":"1e93ca89777e4beb0f0e5cb70e03aab48e958542","modified":1655539327773},{"_id":"themes/fluid/layout/_partials/comments/disqus.ejs","hash":"79ec17eec6e15076c685688e740230e92c66efa9","modified":1655539327774},{"_id":"themes/fluid/layout/_partials/comments/gitalk.ejs","hash":"7f04e5c22821bb94da791973d9c6692b03bac81d","modified":1655539327776},{"_id":"themes/fluid/layout/_partials/comments/giscus.ejs","hash":"66995ec9dab10ed35c2a775010c447113c6848d4","modified":1655539327775},{"_id":"themes/fluid/layout/_partials/comments/livere.ejs","hash":"bcceafab01fe695c59951d939f7cef502f3d7b48","modified":1655539327776},{"_id":"themes/fluid/layout/_partials/comments/remark42.ejs","hash":"45c879768b40ba56af62e18ad54bffbf73a6f3a1","modified":1655539327777},{"_id":"themes/fluid/layout/_partials/comments/twikoo.ejs","hash":"1568d377cd1d214be50a6560197c185ead0f7740","modified":1655539327778},{"_id":"themes/fluid/layout/_partials/comments/utterances.ejs","hash":"d7bcc183fc31af643e7835b13da10fe2ab8614ce","modified":1655539327778},{"_id":"themes/fluid/layout/_partials/comments/valine.ejs","hash":"ef04d4fc3f26588ae9d8712938d648304fc05455","modified":1655539327779},{"_id":"themes/fluid/layout/_partials/comments/waline.ejs","hash":"99fe072ec17e83332325b3c59464bd39ea1f5a96","modified":1655539327780},{"_id":"themes/fluid/layout/_partials/footer/beian.ejs","hash":"77d0c9df31a22ed8a3e341637bde4165a11a7ce9","modified":1655539327782},{"_id":"themes/fluid/layout/_partials/header/banner.ejs","hash":"a84d8dcb44f5f6289ef09db4d02ab14de72c2c87","modified":1655539327785},{"_id":"themes/fluid/layout/_partials/header/navigation.ejs","hash":"1560b1ca7f1f40fe1e18047ab68a3576f6613619","modified":1655539327785},{"_id":"themes/fluid/layout/_partials/post/category-bar.ejs","hash":"eac44cfb6b0843304b2da35b32b0fa24afd9d7f9","modified":1655539327793},{"_id":"themes/fluid/layout/_partials/footer/statistics.ejs","hash":"ed2348bd9f56d19836b508c52ce9cc9122471f51","modified":1655539327783},{"_id":"themes/fluid/layout/_partials/post/meta-bottom.ejs","hash":"f9c0f25eee37cc6e72a5fbefb2cd7284a9fd16d7","modified":1655539327794},{"_id":"themes/fluid/layout/_partials/post/copyright.ejs","hash":"77cda31b5434b75ff7ac600f60a97918bc389616","modified":1655539327794},{"_id":"themes/fluid/layout/_partials/post/meta-top.ejs","hash":"cef058fd6f33651118b5bdaa3c814757f5c82154","modified":1655539327795},{"_id":"themes/fluid/layout/_partials/post/sidebar-left.ejs","hash":"db4ecdcc762bb1b1bae5060f0baa6115174779ff","modified":1655539327796},{"_id":"themes/fluid/layout/_partials/post/sidebar-right.ejs","hash":"2507cdad08f61cf8c1d9b0ca7f4f1dc8c4e5841b","modified":1655539327796},{"_id":"themes/fluid/layout/_partials/post/toc.ejs","hash":"ac544baecc05df96c6558d42b57af219e1d59e52","modified":1655539327797},{"_id":"themes/fluid/layout/_partials/plugins/analytics.ejs","hash":"ea10caef2e655200e275b70d40d464e34123d10b","modified":1655539327787},{"_id":"themes/fluid/layout/_partials/plugins/anchorjs.ejs","hash":"3b31e068f394c3f63a98843711e64ac4af463fef","modified":1655539327788},{"_id":"themes/fluid/layout/_partials/plugins/code-widget.ejs","hash":"03c7c69fbb1754fdccfa18671aac23b8637b869e","modified":1655539327788},{"_id":"themes/fluid/layout/_partials/plugins/encrypt.ejs","hash":"76a224723775388d3fbb0433b32dfb5dcbc75a4c","modified":1655539327789},{"_id":"themes/fluid/layout/_partials/plugins/fancybox.ejs","hash":"3900e54ade140e0e49c571a1955f0b1f3a59b281","modified":1655539327790},{"_id":"themes/fluid/layout/_partials/plugins/highlight.ejs","hash":"502b99e19e496825df7032ca2b0b1a95ebb2b357","modified":1655539327790},{"_id":"themes/fluid/layout/_partials/plugins/math.ejs","hash":"887292388acb8e90c1a7a415a82d128d881f8c9d","modified":1655539327791},{"_id":"themes/fluid/layout/_partials/plugins/mermaid.ejs","hash":"fedcfb5de65c0828f6925d60a758e0c79a45396f","modified":1655539327791},{"_id":"themes/fluid/layout/_partials/plugins/nprogress.ejs","hash":"47c1df255aa552ad71ef3e57deca46530a8f2802","modified":1655539327792},{"_id":"themes/fluid/layout/_partials/plugins/typed.ejs","hash":"7bf29bd9faf12030e19993576299936a999c0e46","modified":1655539327793},{"_id":"themes/fluid/scripts/events/lib/compatible-configs.js","hash":"31208a0db986ba864f756a8ec806b7d254440f9b","modified":1655539327808},{"_id":"themes/fluid/scripts/events/lib/footnote.js","hash":"235dc1c2f7086dcdb9a2091cd219ef2a37aebfa4","modified":1655539327808},{"_id":"themes/fluid/scripts/events/lib/hello.js","hash":"c9efdd41b8606969e5b55f49a2f6df596641b995","modified":1655539327809},{"_id":"themes/fluid/scripts/events/lib/highlight.js","hash":"3f06fd3a865a703eed67aac30692d2c4b348d3a6","modified":1655539327810},{"_id":"themes/fluid/scripts/events/lib/injects.js","hash":"92123b7280695b4ac6650f5e1d7fa0d772c71f5b","modified":1655539327811},{"_id":"themes/fluid/scripts/events/lib/lazyload.js","hash":"c9696633f77dd8055e900497469f9e64eca4d97f","modified":1655539327811},{"_id":"themes/fluid/scripts/events/lib/merge-configs.js","hash":"ec6bf395ccad3dd41f29dc0080aeabf413e30fd9","modified":1655539327812},{"_id":"themes/fluid/source/css/_functions/base.styl","hash":"171697018fd384fce0834875ca94b91f16564cac","modified":1655539327829},{"_id":"themes/fluid/source/css/_mixins/base.styl","hash":"046979dbd8cdabd21d89f9c1d8f1bb3f2fd06d6f","modified":1655539327830},{"_id":"themes/fluid/source/css/_pages/pages.styl","hash":"92c062cf55457b6549497244d09ec34e9c0c95c2","modified":1655539327854},{"_id":"themes/fluid/source/css/_variables/base.styl","hash":"9ea66cf79f1e4356b6b402bc3dc5fb55c9862f1f","modified":1655539327855},{"_id":"themes/fluid/source/css/_pages/_about/about.styl","hash":"8ba5fb6a8ced1de6f7893184bf12f4021fe22595","modified":1655539327831},{"_id":"themes/fluid/source/css/_pages/_archive/archive.styl","hash":"e3846fb429f6732bd15fde40f7c28b3492d786c8","modified":1655539327832},{"_id":"themes/fluid/source/css/_pages/_base/base.styl","hash":"cd255079553985722ee80fb1833f6507dde52194","modified":1655539327842},{"_id":"themes/fluid/source/css/_pages/_base/keyframes.styl","hash":"58a7f8f2baea2d58cf5f7edfc91314ee5d7156ca","modified":1655539327845},{"_id":"themes/fluid/source/css/_pages/_base/inline.styl","hash":"96c3bb95dea4b3d3ecd20b810a674bfcef04870c","modified":1655539327844},{"_id":"themes/fluid/source/css/_pages/_base/color-schema.styl","hash":"577f3289d7f3851d4eeb867db3d92f1313a431da","modified":1655539327843},{"_id":"themes/fluid/source/css/_pages/_category/category-bar.styl","hash":"7f95c49025a347605c726b0874fe074d888e1cc2","modified":1655539327846},{"_id":"themes/fluid/source/css/_pages/_category/category-chain.styl","hash":"4263f7b930e6b57e13295d17fd3745a9e5c52494","modified":1655539327846},{"_id":"themes/fluid/source/css/_pages/_category/category-list.styl","hash":"d3aeb7bf22d52d7dde59b292090ef8b46943718a","modified":1655539327847},{"_id":"themes/fluid/source/css/_pages/_links/links.styl","hash":"d3ef491fd449d89a1b95801dee788a5d9bec4320","modified":1655539327849},{"_id":"themes/fluid/source/css/_pages/_index/index.styl","hash":"7d50d2ae4b8b736a764fcce21ec456fa6b72518c","modified":1655539327848},{"_id":"themes/fluid/source/css/_pages/_post/comment.styl","hash":"1fc96d09d52d9502e84e4e2a8d482ea45e8b81ea","modified":1655539327849},{"_id":"themes/fluid/source/css/_pages/_post/highlight.styl","hash":"4bd2449fb8a3620229f0862a3b499faf1eedf2fd","modified":1655539327850},{"_id":"themes/fluid/source/css/_pages/_post/post-page.styl","hash":"2e44047b9fecf662696b9cfce5c77ac3376cda85","modified":1655539327851},{"_id":"themes/fluid/source/css/_pages/_post/markdown.styl","hash":"2d12f23b46d0ce07ae810bc4f5635c490a098fa4","modified":1655539327850},{"_id":"themes/fluid/source/css/_pages/_post/post-tag.styl","hash":"e8fe053ef8734e54fae12e46acd0087bcd67f8a2","modified":1655539327852},{"_id":"themes/fluid/source/css/_pages/_tag/tags.styl","hash":"29e9b72cfda2f2baf9cf2597fcd7f9e66303a9bd","modified":1655539327853},{"_id":"themes/fluid/source/css/_pages/_base/_widget/board.styl","hash":"1068d71721baeed76bf0176f9b964d36b5764c9f","modified":1655539327834},{"_id":"themes/fluid/source/css/_pages/_base/_widget/anchorjs.styl","hash":"26d65475b1c52a61115044db8883df6739c3a473","modified":1655539327833},{"_id":"themes/fluid/source/css/_pages/_base/_widget/banner.styl","hash":"80301db38e448e40e88bb34d0128628b0809b243","modified":1655539327833},{"_id":"themes/fluid/source/css/_pages/_base/_widget/code-widget.styl","hash":"417a7388b39c0203178b0032e151febd66a0e9f3","modified":1655539327835},{"_id":"themes/fluid/source/css/_pages/_base/_widget/copyright.styl","hash":"3ac1eb36e124adef607775aa505386d5680960e2","modified":1655539327835},{"_id":"themes/fluid/source/css/_pages/_base/_widget/footer.styl","hash":"e6f5921ff9009c1853e7db30c482bc1682433ed9","modified":1655539327836},{"_id":"themes/fluid/source/css/_pages/_base/_widget/header.styl","hash":"30f50446609d49c896e92a89225591b606adc863","modified":1655539327837},{"_id":"themes/fluid/source/css/_pages/_base/_widget/footnote.styl","hash":"41935973a66c14ab2bea0539d4b1f15c62534fa4","modified":1655539327836},{"_id":"themes/fluid/source/css/_pages/_base/_widget/modal.styl","hash":"0ca6171ce262339e0e36cfea0978b554d87ae7fc","modified":1655539327838},{"_id":"themes/fluid/source/css/_pages/_base/_widget/ngrogress.styl","hash":"48799d3148ef6493be0e05897c635124e9b05d03","modified":1655539327838},{"_id":"themes/fluid/source/css/_pages/_base/_widget/noscript.styl","hash":"8fad325e411bc83c8ebdc4115015477eed5f60da","modified":1655539327839},{"_id":"themes/fluid/source/css/_pages/_base/_widget/pagination.styl","hash":"f4ae7cbf2f10f459de7864f8e642553b587df889","modified":1655539327839},{"_id":"themes/fluid/source/css/_pages/_base/_widget/qrcode.styl","hash":"04447d3b673be84a1af1dc57933a3c41dd7c0cfe","modified":1655539327840},{"_id":"themes/fluid/source/css/_pages/_base/_widget/scroll-btn.styl","hash":"e4dbbbb1a2508a72bc04680552d7ebbea0eed0fe","modified":1655539327841},{"_id":"themes/fluid/source/css/_pages/_base/_widget/search.styl","hash":"1f4e678d7219815ab62de1b92ec75e021247f90b","modified":1655539327841},{"_id":"themes/fluid/source/css/_pages/_base/_widget/toc.styl","hash":"5defef321e3e933fe84f3f2ca481c88f55381fb0","modified":1655539327842},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/3.png","hash":"68a5a7ff36fe2e3e8288a954ff9df6ba038234a1","modified":1650264016842},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/2.png","hash":"5e49a6750f7235e6581109f549aba4720b0b4e1e","modified":1650264016836},{"_id":"source/images/eye1.jpg","hash":"3666a0e84e2850954a97b31ccc9a48ba46217d12","modified":1655550102264},{"_id":"themes/fluid/source/img/default.png","hash":"167a12978d80371cf578c8a2e45c24a2eb25b6fb","modified":1655539327861},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/4.png","hash":"3734fddc126b1b739525b7298ca463a8e167c2c3","modified":1650264016851},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/1.png","hash":"070e8c7d6bb1139c83822c0148cac0135ec4c448","modified":1650264016829},{"_id":"source/images/jojo.jpg","hash":"6ef9f06fc7c823ce4527755e10b168321a6aadcd","modified":1651078873064},{"_id":"source/fonts/LXGWWenKaiMono-Regular.woff2","hash":"8dd926f9f75ee6fd1dc719b9c72fa7be53debfa8","modified":1655542516682},{"_id":"source/fonts/LXGWWenKaiScreenR.woff2","hash":"ce09459e5d0fb377ad0ec2c7fb628819c57f06f9","modified":1655542168007},{"_id":"public/css/fix-input-shadow.css","hash":"fd7938b34f69b350d67487925f6817caaff8ee0f","modified":1655559422320},{"_id":"public/css/fonts.css","hash":"4663693d7a86ad052b027ff3f75f1d4f823fda6d","modified":1655559422320},{"_id":"public/local-search.xml","hash":"4fcd11879ee866c44a1167a6e117b7b3d6e7c714","modified":1655559422320},{"_id":"public/about/index.html","hash":"c83d0103dbaff4ab854269583ae5a0d0c87b223b","modified":1655559422320},{"_id":"public/search/index.html","hash":"26e7a835105382f9b57003a4b8a1bdfb3b63f399","modified":1655559422320},{"_id":"public/tags/index.html","hash":"255e00c81a4331bec597ae42017560b613b5f4b3","modified":1655559422320},{"_id":"public/archives/index.html","hash":"736dd97ed4dc24a9cfcfc15a61bd633301ff06df","modified":1655559422320},{"_id":"public/archives/2022/index.html","hash":"9c5e5d11f4acae0cc91e6ecab12318c2b215ef94","modified":1655559422320},{"_id":"public/archives/2022/03/index.html","hash":"b6986b68f1bb8676a54cff2b1633479761acc1d4","modified":1655559422320},{"_id":"public/archives/2022/04/index.html","hash":"de122e79b6ae8e4d9712f121f2495250a6da16a4","modified":1655559422320},{"_id":"public/archives/2022/06/index.html","hash":"78b10928077f7f223c398df4edef0b562535150b","modified":1655559422320},{"_id":"public/categories/linux/index.html","hash":"32c7a4845b435cb3209d9363184882ef53772aaf","modified":1655559422320},{"_id":"public/categories/hack/index.html","hash":"1c9c0054dc00775335da255d8327edce20296530","modified":1655559422320},{"_id":"public/categories/java/index.html","hash":"0100751d6fcc0b5af67f747b42fef07cf23884ff","modified":1655559422320},{"_id":"public/categories/mysql/index.html","hash":"1b7595b30b3e42d48d1d0050c59585624d1caca9","modified":1655559422320},{"_id":"public/categories/spring/index.html","hash":"4957e76ce263b75cd0f1fdc7ea95a8f8bc8c23ce","modified":1655559422320},{"_id":"public/categories/tools/index.html","hash":"571b9153a18b10855fcbdeb5a4d469dd2a1d9f4b","modified":1655559422320},{"_id":"public/tags/setup/index.html","hash":"820ba7964df7a1b9b2fab61abbc3d73f2caa62fc","modified":1655559422320},{"_id":"public/tags/arch-linux/index.html","hash":"facc55aba65dd81a98401d105832c16d3e87e400","modified":1655559422320},{"_id":"public/tags/linux/index.html","hash":"9dd56c0589ce6b8822d61b3a47844c23671cde3f","modified":1655559422320},{"_id":"public/tags/wallhack/index.html","hash":"79efd930f94833270a0eb2e2a35d5d63cfb12655","modified":1655559422320},{"_id":"public/tags/injection/index.html","hash":"fe6f03f93a0bdc7d23666cfed2acec5e75ee93a3","modified":1655559422320},{"_id":"public/tags/reverse-engineering/index.html","hash":"240bb388bb16628f5821ce8dc54e205fcc4786fa","modified":1655559422320},{"_id":"public/tags/fgo/index.html","hash":"b8e45fdeed4e3bbf0cd3674ff6c7ff8862066f9c","modified":1655559422320},{"_id":"public/tags/jvm/index.html","hash":"227ada237079b32f79be7253f13b0ecc2acf1d56","modified":1655559422320},{"_id":"public/tags/jvm-memory/index.html","hash":"c13a06f34bbcde2608bea50af71aae3896d5ee5c","modified":1655559422320},{"_id":"public/tags/java/index.html","hash":"3c7f1c061ad4f5ccb6157bb09f70204242ec72d1","modified":1655559422320},{"_id":"public/tags/shell-script/index.html","hash":"2ab656a7162c0e75ba85a7279f0acd9bbcbceae9","modified":1655559422320},{"_id":"public/tags/mysql/index.html","hash":"af01e6368f55eea4bc6019092a2984ca74d1c086","modified":1655559422320},{"_id":"public/tags/charset/index.html","hash":"d84359e098cfc2e4a0ab655c7a7bb53a8af9efd4","modified":1655559422320},{"_id":"public/tags/collation/index.html","hash":"ff2b999e3c6de3634d9d63d0fafe1a60c05811ae","modified":1655559422320},{"_id":"public/tags/rabbitmq/index.html","hash":"c711c8d4b608e392d3feb44273f126f18f6e1e2d","modified":1655559422320},{"_id":"public/tags/spring/index.html","hash":"b9cfb9c0d6c3fc5024c3e8c7474e45774d69946f","modified":1655559422320},{"_id":"public/tags/uri/index.html","hash":"36de7ade1957c1bc4f8021a50ae82cab2bfca4f1","modified":1655559422320},{"_id":"public/404.html","hash":"9d4689d6134c8e86d73c4bb89ffdb65267fb3ef0","modified":1655559422320},{"_id":"public/links/index.html","hash":"1474f02e4563d0246b5ef1adf107ac9e9a96f007","modified":1655559422320},{"_id":"public/categories/index.html","hash":"4e83c4056807c19f313321e38f10f6d3cc130619","modified":1655559422320},{"_id":"public/2022/06/17/case-sensitive-collation-in-mysql/index.html","hash":"cd71391170014df78c85a6d08eb249d951b02a4f","modified":1655559422320},{"_id":"public/2022/06/14/spring-rabbitmq-binding-trap/index.html","hash":"3b2105eec1eb8a5a9f36d829a06cc6a4fb3067be","modified":1655559422320},{"_id":"public/2022/06/14/useful-utils/index.html","hash":"ce7eec9ca5761ee4d9fb6ad9719890733fb4fa1c","modified":1655559422320},{"_id":"public/2022/04/19/arch-linux-setup-guide/index.html","hash":"54130ca52f5c9391cd87eda48b712d5e646e9311","modified":1655559422320},{"_id":"public/2022/03/19/shell-some-memos-for-shell-script/index.html","hash":"e114d0969091027455413f0131b6322abd28cd29","modified":1655559422320},{"_id":"public/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/index.html","hash":"06dbfcb5b62fd06abb61b0a6f72ff8aa566da12d","modified":1655559422320},{"_id":"public/2022/03/17/fgo-frida-il2cpp-bridge/index.html","hash":"e0351f24ea0db8b4003208e393cdcf12f3ff094d","modified":1655559422320},{"_id":"public/index.html","hash":"5fac8fac43a55e38ffbcc463533a096ecf4abd60","modified":1655559422320},{"_id":"public/img/loading.gif","hash":"2d2fc0f947940f98c21afafef39ecf226a2e8d55","modified":1655559422320},{"_id":"public/img/avatar.png","hash":"fe739a158cc128f70f780eb5fa96f388b81d478f","modified":1655559422320},{"_id":"public/img/fluid.png","hash":"64b215db2cb3af98fe639e94537cb5209f959c78","modified":1655559422320},{"_id":"public/xml/local-search.xml","hash":"85fcc23b4db654a7f91fc55b6fb0442bb3ed3a9a","modified":1655559422320},{"_id":"public/img/police_beian.png","hash":"90efded6baa2dde599a9d6b1387973e8e64923ea","modified":1655559422320},{"_id":"public/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/6.png","hash":"9066953c0c3dda2e33b7196e2c76607df9031842","modified":1655559422320},{"_id":"public/images/eye0.jpg","hash":"7ecd3ae249dfa1d2285ef3b8c6a4637487416f49","modified":1655559422320},{"_id":"public/images/me.png","hash":"0a5449222d1957e9b69dabca1db65b51c53798ea","modified":1655559422320},{"_id":"public/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/0.png","hash":"622a8e751c216e4020cb319f9e0ca67f462d5208","modified":1655559422320},{"_id":"public/css/gitalk.css","hash":"a57b3cc8e04a0a4a27aefa07facf5b5e7bca0e76","modified":1655559422320},{"_id":"public/css/highlight-dark.css","hash":"5e2a356c6af5d8f49e79a86149b9378139f0fd70","modified":1655559422320},{"_id":"public/css/highlight.css","hash":"0f9a477d33d3b15ebe7e163e756fb7c54c7ded6b","modified":1655559422320},{"_id":"public/js/boot.js","hash":"2848f8eb5081a7f0550fbd76dc06d3ff877f1913","modified":1655559422320},{"_id":"public/js/color-schema.js","hash":"ba63f7c3324bc1fdd050a90add9d8faaffc27e07","modified":1655559422320},{"_id":"public/js/events.js","hash":"f05a569a9fd6da2fda69a2cf8e276ba81580faf3","modified":1655559422320},{"_id":"public/js/leancloud.js","hash":"eff77c7a5c399fcaefda48884980571e15243fc9","modified":1655559422320},{"_id":"public/js/img-lazyload.js","hash":"cbdeca434ec4da51f488c821d51b4d23c73294af","modified":1655559422320},{"_id":"public/js/local-search.js","hash":"cebcda5991b6a9ab9307c69542389ce9013f04f7","modified":1655559422320},{"_id":"public/js/plugins.js","hash":"2333494add51e5e1374602a4e81f0be36a05d4c2","modified":1655559422320},{"_id":"public/js/utils.js","hash":"45cc86f099db0a2c36ad49711ce66c2d598a2ab1","modified":1655559422320},{"_id":"public/css/main.css","hash":"4d8b4fc8cc375416bce1ed6648188c44ea333c69","modified":1655559422320},{"_id":"public/images/wechat.jpg","hash":"0f58bc98fcf489da3fd675de82191e77f7392dba","modified":1655559422320},{"_id":"public/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/5.png","hash":"32d8635ee433032162bc323cc0c7a9e1388649dc","modified":1655559422320},{"_id":"public/images/takadanobaba1.jpg","hash":"c94442a686c825fca464db1e9dd660d029652d63","modified":1655559422320},{"_id":"public/images/0.jpg","hash":"974145668d7657911d0fee01f816868293fe2e4f","modified":1655559422320},{"_id":"public/img/default.png","hash":"167a12978d80371cf578c8a2e45c24a2eb25b6fb","modified":1655559422320},{"_id":"public/images/takadanobaba.jpg","hash":"c6f00d8d38492a0abd090ecb2a97163140d17210","modified":1655559422320},{"_id":"public/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/3.png","hash":"68a5a7ff36fe2e3e8288a954ff9df6ba038234a1","modified":1655559422320},{"_id":"public/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/2.png","hash":"5e49a6750f7235e6581109f549aba4720b0b4e1e","modified":1655559422320},{"_id":"public/images/eye1.jpg","hash":"3666a0e84e2850954a97b31ccc9a48ba46217d12","modified":1655559422320},{"_id":"public/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/4.png","hash":"3734fddc126b1b739525b7298ca463a8e167c2c3","modified":1655559422320},{"_id":"public/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/1.png","hash":"070e8c7d6bb1139c83822c0148cac0135ec4c448","modified":1655559422320},{"_id":"public/images/jojo.jpg","hash":"6ef9f06fc7c823ce4527755e10b168321a6aadcd","modified":1655559422320},{"_id":"public/fonts/LXGWWenKaiMono-Regular.woff2","hash":"8dd926f9f75ee6fd1dc719b9c72fa7be53debfa8","modified":1655559422320},{"_id":"public/fonts/LXGWWenKaiScreenR.woff2","hash":"ce09459e5d0fb377ad0ec2c7fb628819c57f06f9","modified":1655559422320}],"Category":[{"name":"Linux","_id":"cl4jxc2cs0004nooufebm5y9t"},{"name":"hack","_id":"cl4jxc2cx000anoou1zdx13vh"},{"name":"Java","_id":"cl4jxc2cy000enoou3t4g0opk"},{"name":"MySQL","_id":"cl4jxc2d90013noou28ndcf74"},{"name":"Spring","_id":"cl4jxc2de0018nooubnh92az8"},{"name":"tools","_id":"cl4jxc2de001cnooufqxg2ovz"}],"Data":[{"_id":"languages/ja","data":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"}},{"_id":"languages/zh-CN","data":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}],"Page":[{"title":"about","date":"2022-03-17T07:10:42.000Z","type":"page","layout":"about","comment":"valine","_content":"","source":"about/index.md","raw":"---\ntitle: about\ndate: 2022-03-17 15:10:42\ntype: \"page\"\nlayout: \"about\"\ncomment: 'valine'\n---\n","updated":"2022-06-18T08:26:03.802Z","path":"about/index.html","comments":1,"_id":"cl4jxc2ch0000nooubi020a8w","content":"","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":0,"excerpt":"","more":""},{"title":"categories","date":"2022-06-13T14:09:39.000Z","type":"categories","layout":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2022-06-13 22:09:39\ntype: \"categories\"\nlayout: \"categories\"\n---\n","updated":"2022-06-13T14:38:04.755Z","path":"categories/index.html","comments":1,"_id":"cl4jxc2co0002noou07wq7lha","content":"","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":0,"excerpt":"","more":""},{"_content":".md-form input[type]:focus:not([readonly]) {\n    border-bottom: 1px solid #4285f4;\n    -webkit-box-shadow: none;\n    box-shadow: none;\n}","source":"css/fix-input-shadow.css","raw":".md-form input[type]:focus:not([readonly]) {\n    border-bottom: 1px solid #4285f4;\n    -webkit-box-shadow: none;\n    box-shadow: none;\n}","date":"2022-06-18T10:25:25.714Z","updated":"2022-06-18T10:25:25.714Z","path":"css/fix-input-shadow.css","layout":"false","title":"","comments":1,"_id":"cl4jxc2cu0006noouerkt8ckv","content":".md-form input[type]:focus:not([readonly]) {\n    border-bottom: 1px solid #4285f4;\n    -webkit-box-shadow: none;\n    box-shadow: none;\n}","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":113,"excerpt":"","more":".md-form input[type]:focus:not([readonly]) {\n    border-bottom: 1px solid #4285f4;\n    -webkit-box-shadow: none;\n    box-shadow: none;\n}"},{"title":"search","date":"2022-06-14T03:29:59.000Z","type":"page","layout":"search","_content":"","source":"search/index.md","raw":"---\ntitle: search\ndate: 2022-06-14 11:29:59\ntype: \"page\"\nlayout: \"search\"\n---\n","updated":"2022-06-14T11:47:57.390Z","path":"search/index.html","comments":1,"_id":"cl4jxc2cw0008noou9augas1g","content":"","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":0,"excerpt":"","more":""},{"_content":"@font-face\n{\n    font-family: \"LXGWWenKaiScreenR\";\n    font-style: normal;\n    src: local(\"\"),\n        url(\"../fonts/LXGWWenKaiScreenR.woff2\") format(\"woff2\"); \n}\n\n@font-face\n{\n    font-family: \"LXGWWenKaiMono\";\n    font-style: normal;\n    src: local(\"\"),\n        url(\"../fonts/LXGWWenKaiMono-Regular.woff2\") format(\"woff2\"); \n}","source":"css/fonts.css","raw":"@font-face\n{\n    font-family: \"LXGWWenKaiScreenR\";\n    font-style: normal;\n    src: local(\"\"),\n        url(\"../fonts/LXGWWenKaiScreenR.woff2\") format(\"woff2\"); \n}\n\n@font-face\n{\n    font-family: \"LXGWWenKaiMono\";\n    font-style: normal;\n    src: local(\"\"),\n        url(\"../fonts/LXGWWenKaiMono-Regular.woff2\") format(\"woff2\"); \n}","date":"2022-06-18T08:55:42.676Z","updated":"2022-06-18T08:55:42.676Z","path":"css/fonts.css","layout":"false","title":"","comments":1,"_id":"cl4jxc2cx0009noou9p72gi83","content":"@font-face\n{\n    font-family: \"LXGWWenKaiScreenR\";\n    font-style: normal;\n    src: local(\"\"),\n        url(\"../fonts/LXGWWenKaiScreenR.woff2\") format(\"woff2\"); \n}\n\n@font-face\n{\n    font-family: \"LXGWWenKaiMono\";\n    font-style: normal;\n    src: local(\"\"),\n        url(\"../fonts/LXGWWenKaiMono-Regular.woff2\") format(\"woff2\"); \n}","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":264,"excerpt":"","more":"@font-face\n{\n    font-family: \"LXGWWenKaiScreenR\";\n    font-style: normal;\n    src: local(\"\"),\n        url(\"../fonts/LXGWWenKaiScreenR.woff2\") format(\"woff2\"); \n}\n\n@font-face\n{\n    font-family: \"LXGWWenKaiMono\";\n    font-style: normal;\n    src: local(\"\"),\n        url(\"../fonts/LXGWWenKaiMono-Regular.woff2\") format(\"woff2\"); \n}"},{"title":"tags","date":"2022-06-13T15:06:11.000Z","type":"tags","layout":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2022-06-13 23:06:11\ntype: \"tags\"\nlayout: \"tags\"\n---\n","updated":"2022-06-13T15:06:48.750Z","path":"tags/index.html","comments":1,"_id":"cl4jxc2cy000cnoou0zfw28z3","content":"","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":0,"excerpt":"","more":""}],"Post":[{"title":"Arch Linux 安装笔记","date":"2022-04-19T03:23:08.000Z","_content":"> https://wiki.archlinux.org/\n\n## 基本系统安装\n### 前置准备\n- 检查网络\n  ```bash \n  ip link\n  ```\n- 更新系统时间\n  ```bash\n  timedatectl set-ntp true\n  ```\n### 准备磁盘\n- 分区\n  - 查看当前磁盘信息\n  ```bash\n  fdisk -l\n  ```\n  - 进入分区\n  ```bash\n  fdisk /dev/the_disk_to_be_partitioned（要被分区的磁盘）\n  ```\n  uefi参考：\n  | 挂载点 | 分区 | 分区类型 | 大小 |\n  | -- | -- | -- | -- |\n  | /mnt/boot/EFI| /dev/efi_system_partition | EFI系统分区 | 300M |\n  | \\[swap\\] **移动设备建议不要**| /dev/swap_partition/ |Linux swap (交换空间) | > 512M (2G if physical ram > 4G) |\n  | /mnt| /dev/root_partition | Linux x86-64 根目录 (/) | 剩余空间 |\n\n  - *移动设备的情况下:*\n    | 挂载点 | 分区 | 分区类型 | 大小 |\n    | -- | -- | -- | -- |\n    | *none* | *none* | BIOS启动分区 | 1M |\n    | /mnt/boot/EFI| /dev/efi_system_partition | EFI系统分区 | 300M |\n    | /mnt| /dev/root_partition | Linux x86-64 根目录 (/) | 剩余空间 |\n\n  - 格式化分区\n  ```bash\n   mkfs.ext4 /dev/root_partition（根分区）\n   # 移动设备关闭日志 mkfs.ext4 -O \"^has_journal\" /dev/root_partition（根分区）\n   mkswap /dev/swap_partition（交换空间分区）\n   mkfs.fat -F 32 /dev/efi_system_partition\n  ```\n  - 挂载分区&启用交换空间\n  ```bash\n  mount /dev/root_partition（根分区） /mnt\n  mount /dev/efi_system_partition /mnt/boot/efi\n  swapon /dev/swap_partition（交换空间分区）\n  ```\n### 安装系统\n  - 设置cn源\n    \n    第一种方法\n      ```bash\n      #!/bin/bash\n      curl 'https://archlinux.org/mirrorlist/?country=CN&prototcol=http&protocol=https&ip_version=4' > /etc/pacman.d/mirrorlist && \\\n      echo /etc/pacman.d/mirrorlist && \\\n      sudo vim /etc/pacman.d/mirrorlist && \\\n      echo 'pacman mirror list updated'\n      ```\n      然后将`/etc/pacman.d/mirrorlist`中注释去掉\n        \n    第二种方法\n\n    在`/etc/pacman.d/mirrorlist`中搜索CN，放到最前面，推荐aliyun的源\n\n  - 安装系统&软件包\n  ```bash\n  pacstrap /mnt base base-devel linux linux-firmware vim vi sudo git\n  # 移动设备 可以使用基于BFQ的io调度内核linux-zen，把linux换成linux-zen\n  ```\n  *参考：[BFQ](https://www.kernel.org/doc/html/latest/block/bfq-iosched.html)*\n\n## 系统配置\n### 系统引导\n  - 配置fstab\n  ```bash\n  genfstab -U /mnt >> /mnt/etc/fstab\n  ```\n  - 安装grub\n  ```bash\n  pacman -S efibootmgr grub\n\n  # uefi\n  grub-install --target=x86_64-efi --efi-directory={挂载点,如/mnt/boot/EFI} --bootloader-id=GRUB\n\n  # bios(非GPT分区无需其他空间，但GPT分区需要有一块1M的BIOS boot分区)\n  grub-install --target=i386-pc /dev/sdX\n  ```\n  *移动设备的情况下*\n\n  假设分区顺序是：\n    - BIOS\n    - EFI\n    - root\n  要先在这块设备上写入引导信息，运行`gdisk /dev/sdX`\n\n  ```bash\n  # gdisk /dev/sdX\n\n  Command (? for help): r\n  Recovery/transformation command (? for help): h\n\n  WARNING! Hybrid MBRs are flaky and dangerous! If you decide not to use one,\n  just hit the Enter key at the below prompt and your MBR partition table will\n  be untouched.\n\n  Type from one to three GPT partition numbers, separated by spaces, to be added to the hybrid MBR, in sequence: 1 2 3\n  Place EFI GPT (0xEE) partition first in MBR (good for GRUB)? (Y/N): N\n\n  Creating entry for GPT partition #1 (MBR partition #1)\n  Enter an MBR hex code (default EF): \n  Set the bootable flag? (Y/N): N\n\n  Creating entry for GPT partition #2 (MBR partition #2)\n  Enter an MBR hex code (default EF): \n  Set the bootable flag? (Y/N): N\n\n  Creating entry for GPT partition #3 (MBR partition #3)\n  Enter an MBR hex code (default 83): \n  Set the bootable flag? (Y/N): Y\n\n  Recovery/transformation command (? for help): x\n  Expert command (? for help): h\n  Expert command (? for help): w\n\n  Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING\n  PARTITIONS!!\n\n  Do you want to proceed? (Y/N): Y\n  ```\n  \n  > **如果不需要兼容，不用做这一步，混合分区会在设备上存在两个分区表，系统识别这个设备分区的时候具体的行为完全依赖于系统的实现，非常不稳定**\n\n  > **注意：写完hybrid之后，默认的windows中就只认MBR分区，假设分区按上面的例子，且还有一个4号分区，那么由于MBR的限制**\n  > **在windows中第四个分区是无法正确识别文件系统的，如果要使用第四个分区且要通过MBR引导，那么这里就要在MBR写入134分区**\n  > **ESP分区可以不用写到MBR里**\n\n\n  ```bash\n  pacman -S efibootmgr grub amd-ucode intel-ucode\n\n  # uefi + MBR(BIOS)混合启动\n  grub-install --target=x86_64-efi --efi-directory={挂载点,如/mnt/boot/EFI} --removable\n   --bootloader-id=GRUB --boot-directory={root挂载点,如/mnt}/boot\n\n  grub-install --target=i386-pc --recheck --boot-directory=/DATA_MOUNTPOINT/boot /dev/sdX #注意这里是整个设备\n\n  # 作为保险\n  grub-install --target=i386-pc --recheck --boot-directory=/DATA_MOUNTPOINT/boot /dev/{root的那个分区}\n  ```\n  - 切换到已经安装的系统\n  ```bash\n  arch-chroot /mnt\n  ```\n\n  - 配置grub.cfg\n  ```bash\n  grub-mkconfig -o /boot/grub/grub.cfg\n  ```\n### 系统初始化设置\n\n  - 设置时区\n  ```bash\n  ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n  hwclock --systohc\n  ```\n  - 本地化\n  ```bash\n  locale-gen\n  ```\n\n  -- 移动设备最小化磁盘访问,把日志放到内存\n  修改`/etc/systemd/journald.conf.d/usbstick.conf`\n  写入\n  ```bash\n  [Journal]\n  Storage=volatile\n  RuntimeMaxUse=30M\n  ```\n\n  - initramfs\n  如果是移动设备，将`/etc/mkinitcpio.conf`中`HOOKS`里面的`block`和`keyboard`放到`autodetect`前面，然后\n  ```bash\n  mkinitcpio -P\n  ```\n\n  创建`/etc/locale.conf`,设置`LANG=en_US.UTF-8`\n  - hostname\n  创建`/etc/hostname`,写入主机名\n  - root密码\n  ```bash\n  passwd\n  ```\n  - hosts\n  向`/etc/hosts`写入\n  ```bash\n  127.0.0.1 localhost\n  ::1 localhost\n  127.0.0.1 {hostname}\n  ```\n\n  - 安装网络工具\n  \n  *networkmanager已经不使用dhcpcd, 因此需要安装dhclient\n  ```bash\n  pacman -S iw wpa_supplicant dialog dhcpcd dhclient netctl networkmanager network-manager-applet gnome-keyring\n  # 设置网络开机启动\n  systemctl enable NetworkManager.service\n  ```\n  - 新增用户\n  ```bash\n  useradd -m -G users,audio,lp,optical,storage,video,wheel,power -s /bin/bash 普通用户名\n  passwd 普通用户名\n  ```\n  运行`visudo`, 去掉`%wheel ALL=(ALL) ALL`注释\n\n**到这里基本已经完成最小系统的配置和安装，在继续之前，改启动项然后reboot**\n\n## DE/WM/DM\n\n  - 安装xorg\n  ```bash\n  sudo pacman -S xorg xorg-xinit\n  ## 移动设备要安装\n  # xf86-input-synaptics 支持触控板\n  # xf86-video-vesa, xf86-video-ati, xf86-video-intel, xf86-video-amdgpu, xf86-video-nouveau and xf86-video-fbdev. 大多数的开源显卡驱动\n  #  libeatmydata  可以禁用fsync，比如对于firefox：eatmydata firefox\n  ```\n  - 安装字体\n  ```bash\n  sudo pacman -S terminus-font \n  ```\n  - 安装DE\n    - Mate\n      - 安装mate\n      ```bash\n      sudo pacman -S mate mate-extra\n      ```\n      - 配置xinitrc\n      ```bash\n      cp /etc/X11/xinit/xinitrc ~/.xinitrc\n      ```\n      把最后的启动换成`exec mate-session`\n    - XFCE\n      - 安装xfce\n      ```bash\n      sudo pacman -S xfce4 xfce4-goodies\n      ```\n      - 配置xinitrc\n      ```bash\n      cp /etc/X11/xinit/xinitrc ~/.xinitrc\n      ```\n      把最后的启动换成`exec startxfce4`\n\n  - 仅安装WM\n    \n    *(略)*\n    \n  - 安装DM\n    - lightdm\n    ```bash\n      sudo pacman -S lightdm-gtk-greeter\n    ```\n\n## 其他\n### 支持hyper-v增强模式\n  ```bash\n  git clone https://www.github.com/Microsoft/linux-vm-tools\n  cd linux-vm-tools/arch\n  # 要先开代理\n  ./make...\n  ./install...\n  ```\n然后记得在win中用管理员设置\n```cmd\nSet-VM -VMName <your_vm_name>  -EnhancedSessionTransportType HvSocket\n```\n\n  **如果无法通过增强模式连接**\n\n  [arch wiki [loginctl or systemctl --user not working]](https://wiki.archlinux.org/title/Xrdp#loginctl_or_systemctl_--user_not_working)\n  \n  Try commenting out all the references to `systemd-home` in `/etc/pam.d/system-auth`, see [github issue](https://github.com/neutrinolabs/xrdp/issues/1684)\n\n### alias\n```bash\nalias s='sudo'\nalias ls='ls --color=auto'\nalias la='ls -a --color=auto'\nalias ll='ls -l --color=auto'\nalias lla='ls -l -a --color=auto'\nalias pac='pacman -S'\nalias pacyu='pacman -Syu'\nalias spac='sudo pacman -S'\nalias spacyu='sudo pacman -Syu'\nalias v='vim'\nalias sv='sudo vim'\n\n```\n### rsync备份\n- 安装rsync\n```bash\nsudo pacman -S rsync\n```\n- backup.sh\n```bash\n#!/bin/bash\necho '==> start to backup... type device:' && \\\n\tread device && \\\n\techo '==> type mount dir:' && \\\n\tread mount_dir && \\\n\techo '==> umount $device...'; \\\n\tumount $device;\\\n\techo '==> umount /mnt/$mount_dir...'; \\\n\tumount /mnt/$mount_dir; \n\techo '==> remove /mnt/$mount_dir...'; \\\n\trm -rf /mnt/$mount_dir && \\\n\techo '==> create directory /mnt/$mount_dir...'; \\\n\tmkdir /mnt/$mount_dir; \\\n\techo '==> mount $device to /mnt/$mount_dir...'; \\\n\tmount $device /mnt/$mount_dir; \\\n\techo '==> create direcotry /mnt/$mount_dir/system_bakcup...'; \\\n\tmkdir /mnt/$mount_dir/system_backup;\n\techo '==> start to sync files to /mnt/$mount_dir/system_backup...'; \\\n\trsync --archive --one-file-system --hard-links \\\n\t--acls --xattrs --sparse \\\n\t--human-readable --numeric-ids --delete --delete-excluded \\\n\t--itemize-changes --verbose --progress \\\n\t--exclude='*~' \\\n\t--exclude='$device' \\\n\t--exclude='/mnt' \\\n\t--exclude='/dev' \\\n\t--exclude='/var/tmp' \\\n\t--exclude='/tmp' \\\n\t/ /mnt/$mount_dir/system_backup && \\\necho '==> finished.'\n```\n\n### 中文及字体设置\n- 语言配置\n去掉`/etc/locale.gen`中的`zh_CN.UTF-8 UTF-8`和`en_US.UTF-8 UTF-8`的注释\n\n根据需要在`~/.xinitrc`或者`~/.bashrc`配置\n\n**在`~/.xinitrc`中配置要注意在`exec xxx`之前**\n```bash\nexport LANG=zh_CN.UTF-8\nexport LANGUAGE=zh_CN:en_US\n```\n- 字体配置\n```bash\nsudo pacman -S wqy-bitmapfont wqy-microhei noto-fonts noto-fonts-emoji\n```\n设置`~/.config/fontconfig/fonts.conf`\n```xml\n<?xml version=\"1.0\"?>\n<!DOCTYPE fontconfig SYSTEM 'fonts.dtd'>\n<fontconfig>\n\n  <!-- 显示器使用的像素排列方式 -->\n  <match target=\"font\">\n    <edit mode=\"assign\" name=\"rgba\">\n      <const>rgb</const>\n    </edit>\n  </match>\n\n  <!-- 字体微调的程度, 可选 hintnone, hintslight (默认), hintmedium, hintfull. -->\n  <!-- 更高的 hinting 等级可使字体更锐利，同时也会损失更多的细节 -->\n  <!-- 如果显示器的 DPI 高得不像话 (>=300), 可关闭 hinting, 字体会自然对齐像素 -->\n  <match target=\"font\">\n    <edit mode=\"assign\" name=\"hintstyle\">\n      <const>hintslight</const>\n    </edit>\n  </match>\n\n  <!-- 抗锯齿. 除非屏幕DPI奇高否则建议开启 -->\n  <match target=\"font\">\n    <edit mode=\"assign\" name=\"antialias\">\n      <bool>true</bool>\n    </edit>\n  </match>\n\n\n<!-- 全局默认字体　-->\n  <match>\n    <edit mode=\"prepend\" name=\"family\">\n      <string>Terminus</string>\n    </edit>\n  </match>\n\n<!-- 全局默认英文字体 -->\n  <match>\n    <test compare=\"contains\" name=\"lang\">\n      <string>en</string>\n    </test>\n    <edit mode=\"prepend\" name=\"family\">\n      <string>Terminus</string>\n    </edit>\n  </match>\n\n<!-- 全局默认中文字体 -->\n  <match>\n    <test compare=\"contains\" name=\"lang\">\n      <string>zh</string>\n    </test>\n    <edit mode=\"prepend\" name=\"family\">\n      <string>WenQuanYi WenQuanYi Bitmap Song</string>\n    </edit>\n  </match>\n\n<!-- 默认无衬线字体 -->\n  <match target=\"pattern\">\n    <test qual=\"any\" name=\"family\">\n      <string>sans-serif</string></test>\n    <edit name=\"family\" mode=\"prepend\" binding=\"same\">\n      <string>Terminus</string>\n    </edit>\n  </match>\n\n<!-- 默认衬线字体 -->\n  <match target=\"pattern\">\n    <test qual=\"any\" name=\"family\">\n      <string>serif</string>\n    </test>\n    <edit name=\"family\" mode=\"prepend\" binding=\"same\">\n      <string>Terminus</string>\n    </edit>\n  </match>\n\n<!-- 默认等宽字体 -->\n  <match target=\"pattern\">\n    <test qual=\"any\" name=\"family\">\n      <string>monospace</string>\n    </test>\n    <edit name=\"family\" mode=\"prepend\" binding=\"same\">\n      <string>Terminus</string>\n    </edit>\n  </match>\n\n  <!-- 字体替换 -->\n  <!--SimSun, Microsoft YaHei, SimHei -> WenQuanYi Micro Hei -->\n  <match target=\"pattern\">\n      <test name=\"family\">\n          <string>宋体</string>\n      </test>\n      <edit name=\"family\" mode=\"assign\" binding=\"strong\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n          <!-- <string>Noto Serif CJK SC</string> -->\n      </edit>\n  </match>\n  <match target=\"pattern\">\n      <test name=\"family\">\n          <string>SimSun</string>\n      </test>\n      <edit name=\"family\" mode=\"assign\" binding=\"strong\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n          <!-- <string>Noto Serif CJK SC</string> -->\n      </edit>\n  </match>\n  <match target=\"pattern\">\n      <test qual=\"any\" name=\"family\">\n          <string>SimSun-18030</string>\n      </test>\n      <edit name=\"family\" mode=\"assign\" binding=\"same\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n         <!-- <string>Noto Serif CJK SC</string> -->\n      </edit>\n  </match>\n\n  <match target=\"pattern\">\n    <test qual=\"any\" name=\"family\">\n        <string>Microsoft YaHei</string>\n    </test>\n    <edit name=\"family\" mode=\"assign\" binding=\"same\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n      </edit>\n  </match>\n\n<match target=\"pattern\">\n    <test qual=\"any\" name=\"family\">\n        <string>SimHei</string>\n    </test>\n    <edit name=\"family\" mode=\"assign\" binding=\"same\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n      </edit>\n  </match>\n\n  <match target=\"pattern\">\n      <test name=\"family\">\n          <string>Times New Roman</string>\n      </test>\n      <edit name=\"family\" mode=\"append\" binding=\"strong\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n      </edit>\n  </match>\n  <match target=\"pattern\">\n      <test name=\"family\">\n          <string>Terminus</string>\n      </test>\n      <edit name=\"family\" mode=\"append\" binding=\"strong\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n      </edit>\n  </match>\n\n\n<!-- 备用字体优先顺序 -->\n  <alias>\n    <family>sans-serif</family>\n    <prefer>\n      <family>Terminus</family>\n      <family>WenQuanYi WenQuanYi Bitmap Song</family>\n      <family>Noto Color Emoji</family>\n      <family>Noto Emoji</family>\n      <family>Noto Sans</family>\n      <family>Noto Sans CJK SC</family>\n      <family>Noto Sans CJK TC</family>\n      <family>Noto Sans CJK JP</family>\n      <family>Noto Sans CJK KR</family>\n    </prefer>\n  </alias>\n  <alias>\n    <family>serif</family>\n    <prefer>\n      <family>Terminus</family>\n      <family>WenQuanYi WenQuanYi Bitmap Song</family>\n      <family>Noto Color Emoji</family>\n      <family>Noto Emoji</family>\n      <family>Noto Sans</family>\n      <family>Noto Sans CJK SC</family>\n      <family>Noto Sans CJK TC</family>\n      <family>Noto Sans CJK JP</family>\n      <family>Noto Sans CJK KR</family>\n      <family>Noto Emoji</family>\n    </prefer>\n  </alias>\n  <alias>\n    <family>monospace</family>\n    <prefer>\n      <family>Terminus</family>\n      <family>WenQuanYi WenQuanYi Bitmap Song</family>\n      <family>Noto Color Emoji</family>\n      <family>Noto Emoji</family>\n      <family>Noto Sans</family>\n      <family>Noto Sans CJK SC</family>\n      <family>Noto Sans CJK TC</family>\n      <family>Noto Sans CJK JP</family>\n      <family>Noto Sans CJK KR</family>\n    </prefer>\n  </alias>\n\n</fontconfig>\n```\n设置字体偏好:`/etc/fonts/conf.d/64-language-selector-prefer.conf`\n```xml\n<?xml version=\"1.0\"?>\n<!DOCTYPE fontconfig SYSTEM 'fonts.dtd'>\n<fontconfig>  \n<alias>\n    <family>sans-serif</family>\n    <prefer>\n      <family>Terminus</family>\n      <family>WenQuanYi WenQuanYi Bitmap Song</family>\n      <family>Noto Color Emoji</family>\n      <family>Noto Emoji</family>\n      <family>Noto Sans</family>\n      <family>Noto Sans CJK SC</family>\n      <family>Noto Sans CJK TC</family>\n      <family>Noto Sans CJK JP</family>\n      <family>Noto Sans CJK KR</family>\n    </prefer>\n  </alias>\n  <alias>\n    <family>serif</family>\n    <prefer>\n      <family>Terminus</family>\n      <family>WenQuanYi WenQuanYi Bitmap Song</family>\n      <family>Noto Color Emoji</family>\n      <family>Noto Emoji</family>\n      <family>Noto Sans</family>\n      <family>Noto Sans CJK SC</family>\n      <family>Noto Sans CJK TC</family>\n      <family>Noto Sans CJK JP</family>\n      <family>Noto Sans CJK KR</family>\n      <family>Noto Emoji</family>\n    </prefer>\n  </alias>\n  <alias>\n    <family>monospace</family>\n    <prefer>\n      <family>Terminus</family>\n      <family>WenQuanYi WenQuanYi Bitmap Song</family>\n      <family>Noto Color Emoji</family>\n      <family>Noto Emoji</family>\n      <family>Noto Sans</family>\n      <family>Noto Sans CJK SC</family>\n      <family>Noto Sans CJK TC</family>\n      <family>Noto Sans CJK JP</family>\n      <family>Noto Sans CJK KR</family>\n    </prefer>\n  </alias>\n</fontconfig>\n\n\n```\n\n### 安装fcitx5\n```bash\nsudo pacman -S fcitx5-im fcitx5-chinese-addons fcitx5-mozc\n```\n\n### xfce的声音\n```bash\n sudo pacman -S alsa-utils pulseaudio pulseaudio-alsa \\\n  pavucontrol      #与xfce4 panel里面的插件配合使用,必须要有这个进程\n```\nxfce4 panel设置里面添加一个pulseaudio plugin的插件\n\n`alsamixer` F6选择声卡,然后把mm的M键去掉,上下箭头调节,auto-mute disable了以后,loopback enable. reboot重启,这时候xfce4的插件就可以调节声音了\n\n### 安装chrome\n```bash\n#AUR 助手\ngit clone https://aur.archlinux.org/yay-git.git\ncd yay-git\nmakepkg -si\n\n#yay不要用root\nyay -S google-chrome\n\n#升级\nyay -Syu\n```\n\n### 安装clash\n\n看[这](https://blog.linioi.com/posts/clash-on-arch/)\n或者[class for windows](https://github.com/Fndroid/clash_for_windows_pkg/releases)\n\n\n### 支持ntfs\n```bash\nsudo pacman -S ntfs-3g\n```","source":"_posts/arch-linux-setup-guide.md","raw":"---\ntitle: Arch Linux 安装笔记\ndate: 2022-04-19 11:23:08\ncategories: \n\t- Linux\ntags:\n\t- setup\n\t- Arch Linux\n\t- Linux\n---\n> https://wiki.archlinux.org/\n\n## 基本系统安装\n### 前置准备\n- 检查网络\n  ```bash \n  ip link\n  ```\n- 更新系统时间\n  ```bash\n  timedatectl set-ntp true\n  ```\n### 准备磁盘\n- 分区\n  - 查看当前磁盘信息\n  ```bash\n  fdisk -l\n  ```\n  - 进入分区\n  ```bash\n  fdisk /dev/the_disk_to_be_partitioned（要被分区的磁盘）\n  ```\n  uefi参考：\n  | 挂载点 | 分区 | 分区类型 | 大小 |\n  | -- | -- | -- | -- |\n  | /mnt/boot/EFI| /dev/efi_system_partition | EFI系统分区 | 300M |\n  | \\[swap\\] **移动设备建议不要**| /dev/swap_partition/ |Linux swap (交换空间) | > 512M (2G if physical ram > 4G) |\n  | /mnt| /dev/root_partition | Linux x86-64 根目录 (/) | 剩余空间 |\n\n  - *移动设备的情况下:*\n    | 挂载点 | 分区 | 分区类型 | 大小 |\n    | -- | -- | -- | -- |\n    | *none* | *none* | BIOS启动分区 | 1M |\n    | /mnt/boot/EFI| /dev/efi_system_partition | EFI系统分区 | 300M |\n    | /mnt| /dev/root_partition | Linux x86-64 根目录 (/) | 剩余空间 |\n\n  - 格式化分区\n  ```bash\n   mkfs.ext4 /dev/root_partition（根分区）\n   # 移动设备关闭日志 mkfs.ext4 -O \"^has_journal\" /dev/root_partition（根分区）\n   mkswap /dev/swap_partition（交换空间分区）\n   mkfs.fat -F 32 /dev/efi_system_partition\n  ```\n  - 挂载分区&启用交换空间\n  ```bash\n  mount /dev/root_partition（根分区） /mnt\n  mount /dev/efi_system_partition /mnt/boot/efi\n  swapon /dev/swap_partition（交换空间分区）\n  ```\n### 安装系统\n  - 设置cn源\n    \n    第一种方法\n      ```bash\n      #!/bin/bash\n      curl 'https://archlinux.org/mirrorlist/?country=CN&prototcol=http&protocol=https&ip_version=4' > /etc/pacman.d/mirrorlist && \\\n      echo /etc/pacman.d/mirrorlist && \\\n      sudo vim /etc/pacman.d/mirrorlist && \\\n      echo 'pacman mirror list updated'\n      ```\n      然后将`/etc/pacman.d/mirrorlist`中注释去掉\n        \n    第二种方法\n\n    在`/etc/pacman.d/mirrorlist`中搜索CN，放到最前面，推荐aliyun的源\n\n  - 安装系统&软件包\n  ```bash\n  pacstrap /mnt base base-devel linux linux-firmware vim vi sudo git\n  # 移动设备 可以使用基于BFQ的io调度内核linux-zen，把linux换成linux-zen\n  ```\n  *参考：[BFQ](https://www.kernel.org/doc/html/latest/block/bfq-iosched.html)*\n\n## 系统配置\n### 系统引导\n  - 配置fstab\n  ```bash\n  genfstab -U /mnt >> /mnt/etc/fstab\n  ```\n  - 安装grub\n  ```bash\n  pacman -S efibootmgr grub\n\n  # uefi\n  grub-install --target=x86_64-efi --efi-directory={挂载点,如/mnt/boot/EFI} --bootloader-id=GRUB\n\n  # bios(非GPT分区无需其他空间，但GPT分区需要有一块1M的BIOS boot分区)\n  grub-install --target=i386-pc /dev/sdX\n  ```\n  *移动设备的情况下*\n\n  假设分区顺序是：\n    - BIOS\n    - EFI\n    - root\n  要先在这块设备上写入引导信息，运行`gdisk /dev/sdX`\n\n  ```bash\n  # gdisk /dev/sdX\n\n  Command (? for help): r\n  Recovery/transformation command (? for help): h\n\n  WARNING! Hybrid MBRs are flaky and dangerous! If you decide not to use one,\n  just hit the Enter key at the below prompt and your MBR partition table will\n  be untouched.\n\n  Type from one to three GPT partition numbers, separated by spaces, to be added to the hybrid MBR, in sequence: 1 2 3\n  Place EFI GPT (0xEE) partition first in MBR (good for GRUB)? (Y/N): N\n\n  Creating entry for GPT partition #1 (MBR partition #1)\n  Enter an MBR hex code (default EF): \n  Set the bootable flag? (Y/N): N\n\n  Creating entry for GPT partition #2 (MBR partition #2)\n  Enter an MBR hex code (default EF): \n  Set the bootable flag? (Y/N): N\n\n  Creating entry for GPT partition #3 (MBR partition #3)\n  Enter an MBR hex code (default 83): \n  Set the bootable flag? (Y/N): Y\n\n  Recovery/transformation command (? for help): x\n  Expert command (? for help): h\n  Expert command (? for help): w\n\n  Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING\n  PARTITIONS!!\n\n  Do you want to proceed? (Y/N): Y\n  ```\n  \n  > **如果不需要兼容，不用做这一步，混合分区会在设备上存在两个分区表，系统识别这个设备分区的时候具体的行为完全依赖于系统的实现，非常不稳定**\n\n  > **注意：写完hybrid之后，默认的windows中就只认MBR分区，假设分区按上面的例子，且还有一个4号分区，那么由于MBR的限制**\n  > **在windows中第四个分区是无法正确识别文件系统的，如果要使用第四个分区且要通过MBR引导，那么这里就要在MBR写入134分区**\n  > **ESP分区可以不用写到MBR里**\n\n\n  ```bash\n  pacman -S efibootmgr grub amd-ucode intel-ucode\n\n  # uefi + MBR(BIOS)混合启动\n  grub-install --target=x86_64-efi --efi-directory={挂载点,如/mnt/boot/EFI} --removable\n   --bootloader-id=GRUB --boot-directory={root挂载点,如/mnt}/boot\n\n  grub-install --target=i386-pc --recheck --boot-directory=/DATA_MOUNTPOINT/boot /dev/sdX #注意这里是整个设备\n\n  # 作为保险\n  grub-install --target=i386-pc --recheck --boot-directory=/DATA_MOUNTPOINT/boot /dev/{root的那个分区}\n  ```\n  - 切换到已经安装的系统\n  ```bash\n  arch-chroot /mnt\n  ```\n\n  - 配置grub.cfg\n  ```bash\n  grub-mkconfig -o /boot/grub/grub.cfg\n  ```\n### 系统初始化设置\n\n  - 设置时区\n  ```bash\n  ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n  hwclock --systohc\n  ```\n  - 本地化\n  ```bash\n  locale-gen\n  ```\n\n  -- 移动设备最小化磁盘访问,把日志放到内存\n  修改`/etc/systemd/journald.conf.d/usbstick.conf`\n  写入\n  ```bash\n  [Journal]\n  Storage=volatile\n  RuntimeMaxUse=30M\n  ```\n\n  - initramfs\n  如果是移动设备，将`/etc/mkinitcpio.conf`中`HOOKS`里面的`block`和`keyboard`放到`autodetect`前面，然后\n  ```bash\n  mkinitcpio -P\n  ```\n\n  创建`/etc/locale.conf`,设置`LANG=en_US.UTF-8`\n  - hostname\n  创建`/etc/hostname`,写入主机名\n  - root密码\n  ```bash\n  passwd\n  ```\n  - hosts\n  向`/etc/hosts`写入\n  ```bash\n  127.0.0.1 localhost\n  ::1 localhost\n  127.0.0.1 {hostname}\n  ```\n\n  - 安装网络工具\n  \n  *networkmanager已经不使用dhcpcd, 因此需要安装dhclient\n  ```bash\n  pacman -S iw wpa_supplicant dialog dhcpcd dhclient netctl networkmanager network-manager-applet gnome-keyring\n  # 设置网络开机启动\n  systemctl enable NetworkManager.service\n  ```\n  - 新增用户\n  ```bash\n  useradd -m -G users,audio,lp,optical,storage,video,wheel,power -s /bin/bash 普通用户名\n  passwd 普通用户名\n  ```\n  运行`visudo`, 去掉`%wheel ALL=(ALL) ALL`注释\n\n**到这里基本已经完成最小系统的配置和安装，在继续之前，改启动项然后reboot**\n\n## DE/WM/DM\n\n  - 安装xorg\n  ```bash\n  sudo pacman -S xorg xorg-xinit\n  ## 移动设备要安装\n  # xf86-input-synaptics 支持触控板\n  # xf86-video-vesa, xf86-video-ati, xf86-video-intel, xf86-video-amdgpu, xf86-video-nouveau and xf86-video-fbdev. 大多数的开源显卡驱动\n  #  libeatmydata  可以禁用fsync，比如对于firefox：eatmydata firefox\n  ```\n  - 安装字体\n  ```bash\n  sudo pacman -S terminus-font \n  ```\n  - 安装DE\n    - Mate\n      - 安装mate\n      ```bash\n      sudo pacman -S mate mate-extra\n      ```\n      - 配置xinitrc\n      ```bash\n      cp /etc/X11/xinit/xinitrc ~/.xinitrc\n      ```\n      把最后的启动换成`exec mate-session`\n    - XFCE\n      - 安装xfce\n      ```bash\n      sudo pacman -S xfce4 xfce4-goodies\n      ```\n      - 配置xinitrc\n      ```bash\n      cp /etc/X11/xinit/xinitrc ~/.xinitrc\n      ```\n      把最后的启动换成`exec startxfce4`\n\n  - 仅安装WM\n    \n    *(略)*\n    \n  - 安装DM\n    - lightdm\n    ```bash\n      sudo pacman -S lightdm-gtk-greeter\n    ```\n\n## 其他\n### 支持hyper-v增强模式\n  ```bash\n  git clone https://www.github.com/Microsoft/linux-vm-tools\n  cd linux-vm-tools/arch\n  # 要先开代理\n  ./make...\n  ./install...\n  ```\n然后记得在win中用管理员设置\n```cmd\nSet-VM -VMName <your_vm_name>  -EnhancedSessionTransportType HvSocket\n```\n\n  **如果无法通过增强模式连接**\n\n  [arch wiki [loginctl or systemctl --user not working]](https://wiki.archlinux.org/title/Xrdp#loginctl_or_systemctl_--user_not_working)\n  \n  Try commenting out all the references to `systemd-home` in `/etc/pam.d/system-auth`, see [github issue](https://github.com/neutrinolabs/xrdp/issues/1684)\n\n### alias\n```bash\nalias s='sudo'\nalias ls='ls --color=auto'\nalias la='ls -a --color=auto'\nalias ll='ls -l --color=auto'\nalias lla='ls -l -a --color=auto'\nalias pac='pacman -S'\nalias pacyu='pacman -Syu'\nalias spac='sudo pacman -S'\nalias spacyu='sudo pacman -Syu'\nalias v='vim'\nalias sv='sudo vim'\n\n```\n### rsync备份\n- 安装rsync\n```bash\nsudo pacman -S rsync\n```\n- backup.sh\n```bash\n#!/bin/bash\necho '==> start to backup... type device:' && \\\n\tread device && \\\n\techo '==> type mount dir:' && \\\n\tread mount_dir && \\\n\techo '==> umount $device...'; \\\n\tumount $device;\\\n\techo '==> umount /mnt/$mount_dir...'; \\\n\tumount /mnt/$mount_dir; \n\techo '==> remove /mnt/$mount_dir...'; \\\n\trm -rf /mnt/$mount_dir && \\\n\techo '==> create directory /mnt/$mount_dir...'; \\\n\tmkdir /mnt/$mount_dir; \\\n\techo '==> mount $device to /mnt/$mount_dir...'; \\\n\tmount $device /mnt/$mount_dir; \\\n\techo '==> create direcotry /mnt/$mount_dir/system_bakcup...'; \\\n\tmkdir /mnt/$mount_dir/system_backup;\n\techo '==> start to sync files to /mnt/$mount_dir/system_backup...'; \\\n\trsync --archive --one-file-system --hard-links \\\n\t--acls --xattrs --sparse \\\n\t--human-readable --numeric-ids --delete --delete-excluded \\\n\t--itemize-changes --verbose --progress \\\n\t--exclude='*~' \\\n\t--exclude='$device' \\\n\t--exclude='/mnt' \\\n\t--exclude='/dev' \\\n\t--exclude='/var/tmp' \\\n\t--exclude='/tmp' \\\n\t/ /mnt/$mount_dir/system_backup && \\\necho '==> finished.'\n```\n\n### 中文及字体设置\n- 语言配置\n去掉`/etc/locale.gen`中的`zh_CN.UTF-8 UTF-8`和`en_US.UTF-8 UTF-8`的注释\n\n根据需要在`~/.xinitrc`或者`~/.bashrc`配置\n\n**在`~/.xinitrc`中配置要注意在`exec xxx`之前**\n```bash\nexport LANG=zh_CN.UTF-8\nexport LANGUAGE=zh_CN:en_US\n```\n- 字体配置\n```bash\nsudo pacman -S wqy-bitmapfont wqy-microhei noto-fonts noto-fonts-emoji\n```\n设置`~/.config/fontconfig/fonts.conf`\n```xml\n<?xml version=\"1.0\"?>\n<!DOCTYPE fontconfig SYSTEM 'fonts.dtd'>\n<fontconfig>\n\n  <!-- 显示器使用的像素排列方式 -->\n  <match target=\"font\">\n    <edit mode=\"assign\" name=\"rgba\">\n      <const>rgb</const>\n    </edit>\n  </match>\n\n  <!-- 字体微调的程度, 可选 hintnone, hintslight (默认), hintmedium, hintfull. -->\n  <!-- 更高的 hinting 等级可使字体更锐利，同时也会损失更多的细节 -->\n  <!-- 如果显示器的 DPI 高得不像话 (>=300), 可关闭 hinting, 字体会自然对齐像素 -->\n  <match target=\"font\">\n    <edit mode=\"assign\" name=\"hintstyle\">\n      <const>hintslight</const>\n    </edit>\n  </match>\n\n  <!-- 抗锯齿. 除非屏幕DPI奇高否则建议开启 -->\n  <match target=\"font\">\n    <edit mode=\"assign\" name=\"antialias\">\n      <bool>true</bool>\n    </edit>\n  </match>\n\n\n<!-- 全局默认字体　-->\n  <match>\n    <edit mode=\"prepend\" name=\"family\">\n      <string>Terminus</string>\n    </edit>\n  </match>\n\n<!-- 全局默认英文字体 -->\n  <match>\n    <test compare=\"contains\" name=\"lang\">\n      <string>en</string>\n    </test>\n    <edit mode=\"prepend\" name=\"family\">\n      <string>Terminus</string>\n    </edit>\n  </match>\n\n<!-- 全局默认中文字体 -->\n  <match>\n    <test compare=\"contains\" name=\"lang\">\n      <string>zh</string>\n    </test>\n    <edit mode=\"prepend\" name=\"family\">\n      <string>WenQuanYi WenQuanYi Bitmap Song</string>\n    </edit>\n  </match>\n\n<!-- 默认无衬线字体 -->\n  <match target=\"pattern\">\n    <test qual=\"any\" name=\"family\">\n      <string>sans-serif</string></test>\n    <edit name=\"family\" mode=\"prepend\" binding=\"same\">\n      <string>Terminus</string>\n    </edit>\n  </match>\n\n<!-- 默认衬线字体 -->\n  <match target=\"pattern\">\n    <test qual=\"any\" name=\"family\">\n      <string>serif</string>\n    </test>\n    <edit name=\"family\" mode=\"prepend\" binding=\"same\">\n      <string>Terminus</string>\n    </edit>\n  </match>\n\n<!-- 默认等宽字体 -->\n  <match target=\"pattern\">\n    <test qual=\"any\" name=\"family\">\n      <string>monospace</string>\n    </test>\n    <edit name=\"family\" mode=\"prepend\" binding=\"same\">\n      <string>Terminus</string>\n    </edit>\n  </match>\n\n  <!-- 字体替换 -->\n  <!--SimSun, Microsoft YaHei, SimHei -> WenQuanYi Micro Hei -->\n  <match target=\"pattern\">\n      <test name=\"family\">\n          <string>宋体</string>\n      </test>\n      <edit name=\"family\" mode=\"assign\" binding=\"strong\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n          <!-- <string>Noto Serif CJK SC</string> -->\n      </edit>\n  </match>\n  <match target=\"pattern\">\n      <test name=\"family\">\n          <string>SimSun</string>\n      </test>\n      <edit name=\"family\" mode=\"assign\" binding=\"strong\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n          <!-- <string>Noto Serif CJK SC</string> -->\n      </edit>\n  </match>\n  <match target=\"pattern\">\n      <test qual=\"any\" name=\"family\">\n          <string>SimSun-18030</string>\n      </test>\n      <edit name=\"family\" mode=\"assign\" binding=\"same\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n         <!-- <string>Noto Serif CJK SC</string> -->\n      </edit>\n  </match>\n\n  <match target=\"pattern\">\n    <test qual=\"any\" name=\"family\">\n        <string>Microsoft YaHei</string>\n    </test>\n    <edit name=\"family\" mode=\"assign\" binding=\"same\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n      </edit>\n  </match>\n\n<match target=\"pattern\">\n    <test qual=\"any\" name=\"family\">\n        <string>SimHei</string>\n    </test>\n    <edit name=\"family\" mode=\"assign\" binding=\"same\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n      </edit>\n  </match>\n\n  <match target=\"pattern\">\n      <test name=\"family\">\n          <string>Times New Roman</string>\n      </test>\n      <edit name=\"family\" mode=\"append\" binding=\"strong\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n      </edit>\n  </match>\n  <match target=\"pattern\">\n      <test name=\"family\">\n          <string>Terminus</string>\n      </test>\n      <edit name=\"family\" mode=\"append\" binding=\"strong\">\n          <string>WenQuanYi WenQuanYi Bitmap Song</string>\n      </edit>\n  </match>\n\n\n<!-- 备用字体优先顺序 -->\n  <alias>\n    <family>sans-serif</family>\n    <prefer>\n      <family>Terminus</family>\n      <family>WenQuanYi WenQuanYi Bitmap Song</family>\n      <family>Noto Color Emoji</family>\n      <family>Noto Emoji</family>\n      <family>Noto Sans</family>\n      <family>Noto Sans CJK SC</family>\n      <family>Noto Sans CJK TC</family>\n      <family>Noto Sans CJK JP</family>\n      <family>Noto Sans CJK KR</family>\n    </prefer>\n  </alias>\n  <alias>\n    <family>serif</family>\n    <prefer>\n      <family>Terminus</family>\n      <family>WenQuanYi WenQuanYi Bitmap Song</family>\n      <family>Noto Color Emoji</family>\n      <family>Noto Emoji</family>\n      <family>Noto Sans</family>\n      <family>Noto Sans CJK SC</family>\n      <family>Noto Sans CJK TC</family>\n      <family>Noto Sans CJK JP</family>\n      <family>Noto Sans CJK KR</family>\n      <family>Noto Emoji</family>\n    </prefer>\n  </alias>\n  <alias>\n    <family>monospace</family>\n    <prefer>\n      <family>Terminus</family>\n      <family>WenQuanYi WenQuanYi Bitmap Song</family>\n      <family>Noto Color Emoji</family>\n      <family>Noto Emoji</family>\n      <family>Noto Sans</family>\n      <family>Noto Sans CJK SC</family>\n      <family>Noto Sans CJK TC</family>\n      <family>Noto Sans CJK JP</family>\n      <family>Noto Sans CJK KR</family>\n    </prefer>\n  </alias>\n\n</fontconfig>\n```\n设置字体偏好:`/etc/fonts/conf.d/64-language-selector-prefer.conf`\n```xml\n<?xml version=\"1.0\"?>\n<!DOCTYPE fontconfig SYSTEM 'fonts.dtd'>\n<fontconfig>  \n<alias>\n    <family>sans-serif</family>\n    <prefer>\n      <family>Terminus</family>\n      <family>WenQuanYi WenQuanYi Bitmap Song</family>\n      <family>Noto Color Emoji</family>\n      <family>Noto Emoji</family>\n      <family>Noto Sans</family>\n      <family>Noto Sans CJK SC</family>\n      <family>Noto Sans CJK TC</family>\n      <family>Noto Sans CJK JP</family>\n      <family>Noto Sans CJK KR</family>\n    </prefer>\n  </alias>\n  <alias>\n    <family>serif</family>\n    <prefer>\n      <family>Terminus</family>\n      <family>WenQuanYi WenQuanYi Bitmap Song</family>\n      <family>Noto Color Emoji</family>\n      <family>Noto Emoji</family>\n      <family>Noto Sans</family>\n      <family>Noto Sans CJK SC</family>\n      <family>Noto Sans CJK TC</family>\n      <family>Noto Sans CJK JP</family>\n      <family>Noto Sans CJK KR</family>\n      <family>Noto Emoji</family>\n    </prefer>\n  </alias>\n  <alias>\n    <family>monospace</family>\n    <prefer>\n      <family>Terminus</family>\n      <family>WenQuanYi WenQuanYi Bitmap Song</family>\n      <family>Noto Color Emoji</family>\n      <family>Noto Emoji</family>\n      <family>Noto Sans</family>\n      <family>Noto Sans CJK SC</family>\n      <family>Noto Sans CJK TC</family>\n      <family>Noto Sans CJK JP</family>\n      <family>Noto Sans CJK KR</family>\n    </prefer>\n  </alias>\n</fontconfig>\n\n\n```\n\n### 安装fcitx5\n```bash\nsudo pacman -S fcitx5-im fcitx5-chinese-addons fcitx5-mozc\n```\n\n### xfce的声音\n```bash\n sudo pacman -S alsa-utils pulseaudio pulseaudio-alsa \\\n  pavucontrol      #与xfce4 panel里面的插件配合使用,必须要有这个进程\n```\nxfce4 panel设置里面添加一个pulseaudio plugin的插件\n\n`alsamixer` F6选择声卡,然后把mm的M键去掉,上下箭头调节,auto-mute disable了以后,loopback enable. reboot重启,这时候xfce4的插件就可以调节声音了\n\n### 安装chrome\n```bash\n#AUR 助手\ngit clone https://aur.archlinux.org/yay-git.git\ncd yay-git\nmakepkg -si\n\n#yay不要用root\nyay -S google-chrome\n\n#升级\nyay -Syu\n```\n\n### 安装clash\n\n看[这](https://blog.linioi.com/posts/clash-on-arch/)\n或者[class for windows](https://github.com/Fndroid/clash_for_windows_pkg/releases)\n\n\n### 支持ntfs\n```bash\nsudo pacman -S ntfs-3g\n```","slug":"arch-linux-setup-guide","published":1,"updated":"2022-06-18T13:27:21.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl4jxc2ck0001noou42redxtt","content":"<blockquote>\n<p><a href=\"https://wiki.archlinux.org/\">https://wiki.archlinux.org/</a></p>\n</blockquote>\n<h2 id=\"基本系统安装\"><a href=\"#基本系统安装\" class=\"headerlink\" title=\"基本系统安装\"></a>基本系统安装</h2><h3 id=\"前置准备\"><a href=\"#前置准备\" class=\"headerlink\" title=\"前置准备\"></a>前置准备</h3><ul>\n<li>检查网络<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">ip <span class=\"hljs-built_in\">link</span><br></code></pre></td></tr></table></figure></li>\n<li>更新系统时间<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">timedatectl set-ntp <span class=\"hljs-literal\">true</span><br></code></pre></td></tr></table></figure>\n<h3 id=\"准备磁盘\"><a href=\"#准备磁盘\" class=\"headerlink\" title=\"准备磁盘\"></a>准备磁盘</h3></li>\n<li>分区<ul>\n<li><p>查看当前磁盘信息</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">fdisk -l<br></code></pre></td></tr></table></figure></li>\n<li><p>进入分区</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">fdisk /dev/the_disk_to_be_partitioned（要被分区的磁盘）<br></code></pre></td></tr></table></figure>\n<p>uefi参考：</p>\n<div class=\"table-wrapper\"/>\n<table>\n<thead>\n<tr>\n<th>挂载点</th>\n<th>分区</th>\n<th>分区类型</th>\n<th>大小</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&#x2F;mnt&#x2F;boot&#x2F;EFI</td>\n<td>&#x2F;dev&#x2F;efi_system_partition</td>\n<td>EFI系统分区</td>\n<td>300M</td>\n</tr>\n<tr>\n<td>[swap] <strong>移动设备建议不要</strong></td>\n<td>&#x2F;dev&#x2F;swap_partition&#x2F;</td>\n<td>Linux swap (交换空间)</td>\n<td>&gt; 512M (2G if physical ram &gt; 4G)</td>\n</tr>\n<tr>\n<td>&#x2F;mnt</td>\n<td>&#x2F;dev&#x2F;root_partition</td>\n<td>Linux x86-64 根目录 (&#x2F;)</td>\n<td>剩余空间</td>\n</tr>\n</tbody></table>\n</div>\n</li>\n<li><p><em>移动设备的情况下:</em></p>\n<div class=\"table-wrapper\"/>\n<table>\n<thead>\n<tr>\n<th>挂载点</th>\n<th>分区</th>\n<th>分区类型</th>\n<th>大小</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><em>none</em></td>\n<td><em>none</em></td>\n<td>BIOS启动分区</td>\n<td>1M</td>\n</tr>\n<tr>\n<td>&#x2F;mnt&#x2F;boot&#x2F;EFI</td>\n<td>&#x2F;dev&#x2F;efi_system_partition</td>\n<td>EFI系统分区</td>\n<td>300M</td>\n</tr>\n<tr>\n<td>&#x2F;mnt</td>\n<td>&#x2F;dev&#x2F;root_partition</td>\n<td>Linux x86-64 根目录 (&#x2F;)</td>\n<td>剩余空间</td>\n</tr>\n</tbody></table>\n</div>\n</li>\n<li><p>格式化分区</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">mkfs.ext4 /dev/root_partition（根分区）<br><span class=\"hljs-comment\"># 移动设备关闭日志 mkfs.ext4 -O &quot;^has_journal&quot; /dev/root_partition（根分区）</span><br>mkswap /dev/swap_partition（交换空间分区）<br>mkfs.fat -F 32 /dev/efi_system_partition<br></code></pre></td></tr></table></figure></li>\n<li><p>挂载分区&amp;启用交换空间</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">mount /dev/root_partition（根分区） /mnt<br>mount /dev/efi_system_partition /mnt/boot/efi<br>swapon /dev/swap_partition（交换空间分区）<br></code></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"安装系统\"><a href=\"#安装系统\" class=\"headerlink\" title=\"安装系统\"></a>安装系统</h3><ul>\n<li><p>设置cn源</p>\n<p>第一种方法</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-meta\">#!/bin/bash</span><br>curl <span class=\"hljs-string\">&#x27;https://archlinux.org/mirrorlist/?country=CN&amp;prototcol=http&amp;protocol=https&amp;ip_version=4&#x27;</span> &gt; /etc/pacman.d/mirrorlist &amp;&amp; \\<br><span class=\"hljs-built_in\">echo</span> /etc/pacman.d/mirrorlist &amp;&amp; \\<br>sudo vim /etc/pacman.d/mirrorlist &amp;&amp; \\<br><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;pacman mirror list updated&#x27;</span><br></code></pre></td></tr></table></figure>\n<p>  然后将<code>/etc/pacman.d/mirrorlist</code>中注释去掉</p>\n<p>第二种方法</p>\n<p>在<code>/etc/pacman.d/mirrorlist</code>中搜索CN，放到最前面，推荐aliyun的源</p>\n</li>\n<li><p>安装系统&amp;软件包</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">pacstrap /mnt base base-devel linux linux-firmware vim vi sudo git<br><span class=\"hljs-comment\"># 移动设备 可以使用基于BFQ的io调度内核linux-zen，把linux换成linux-zen</span><br></code></pre></td></tr></table></figure></li>\n</ul>\n<p>  <em>参考：<a href=\"https://www.kernel.org/doc/html/latest/block/bfq-iosched.html\">BFQ</a></em></p>\n<h2 id=\"系统配置\"><a href=\"#系统配置\" class=\"headerlink\" title=\"系统配置\"></a>系统配置</h2><h3 id=\"系统引导\"><a href=\"#系统引导\" class=\"headerlink\" title=\"系统引导\"></a>系统引导</h3><ul>\n<li>配置fstab  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab<br></code></pre></td></tr></table></figure></li>\n<li>安装grub  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">pacman -S efibootmgr grub<br><br><span class=\"hljs-comment\"># uefi</span><br>grub-install --target=x86_64-efi --efi-directory=&#123;挂载点,如/mnt/boot/EFI&#125; --bootloader-id=GRUB<br><br><span class=\"hljs-comment\"># bios(非GPT分区无需其他空间，但GPT分区需要有一块1M的BIOS boot分区)</span><br>grub-install --target=i386-pc /dev/sdX<br></code></pre></td></tr></table></figure></li>\n</ul>\n<p>  <em>移动设备的情况下</em></p>\n<p>  假设分区顺序是：<br>    - BIOS<br>    - EFI<br>    - root<br>  要先在这块设备上写入引导信息，运行<code>gdisk /dev/sdX</code></p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-comment\"># gdisk /dev/sdX</span><br><br>Command (? <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>): r<br>Recovery/transformation <span class=\"hljs-built_in\">command</span> (? <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>): h<br><br>WARNING! Hybrid MBRs are flaky and dangerous! If you decide not to use one,<br>just hit the Enter key at the below prompt and your MBR partition table will<br>be untouched.<br><br>Type from one to three GPT partition numbers, separated by spaces, to be added to the hybrid MBR, <span class=\"hljs-keyword\">in</span> sequence: 1 2 3<br>Place EFI GPT (0xEE) partition first <span class=\"hljs-keyword\">in</span> MBR (good <span class=\"hljs-keyword\">for</span> GRUB)? (Y/N): N<br><br>Creating entry <span class=\"hljs-keyword\">for</span> GPT partition <span class=\"hljs-comment\">#1 (MBR partition #1)</span><br>Enter an MBR hex code (default EF): <br>Set the bootable flag? (Y/N): N<br><br>Creating entry <span class=\"hljs-keyword\">for</span> GPT partition <span class=\"hljs-comment\">#2 (MBR partition #2)</span><br>Enter an MBR hex code (default EF): <br>Set the bootable flag? (Y/N): N<br><br>Creating entry <span class=\"hljs-keyword\">for</span> GPT partition <span class=\"hljs-comment\">#3 (MBR partition #3)</span><br>Enter an MBR hex code (default 83): <br>Set the bootable flag? (Y/N): Y<br><br>Recovery/transformation <span class=\"hljs-built_in\">command</span> (? <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>): x<br>Expert <span class=\"hljs-built_in\">command</span> (? <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>): h<br>Expert <span class=\"hljs-built_in\">command</span> (? <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>): w<br><br>Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING<br>PARTITIONS!!<br><br>Do you want to proceed? (Y/N): Y<br></code></pre></td></tr></table></figure>\n<blockquote>\n<p><strong>如果不需要兼容，不用做这一步，混合分区会在设备上存在两个分区表，系统识别这个设备分区的时候具体的行为完全依赖于系统的实现，非常不稳定</strong></p>\n</blockquote>\n<blockquote>\n<p><strong>注意：写完hybrid之后，默认的windows中就只认MBR分区，假设分区按上面的例子，且还有一个4号分区，那么由于MBR的限制</strong><br><strong>在windows中第四个分区是无法正确识别文件系统的，如果要使用第四个分区且要通过MBR引导，那么这里就要在MBR写入134分区</strong><br><strong>ESP分区可以不用写到MBR里</strong></p>\n</blockquote>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">pacman -S efibootmgr grub amd-ucode intel-ucode<br><br><span class=\"hljs-comment\"># uefi + MBR(BIOS)混合启动</span><br>grub-install --target=x86_64-efi --efi-directory=&#123;挂载点,如/mnt/boot/EFI&#125; --removable<br> --bootloader-id=GRUB --boot-directory=&#123;root挂载点,如/mnt&#125;/boot<br><br>grub-install --target=i386-pc --recheck --boot-directory=/DATA_MOUNTPOINT/boot /dev/sdX <span class=\"hljs-comment\">#注意这里是整个设备</span><br><br><span class=\"hljs-comment\"># 作为保险</span><br>grub-install --target=i386-pc --recheck --boot-directory=/DATA_MOUNTPOINT/boot /dev/&#123;root的那个分区&#125;<br></code></pre></td></tr></table></figure>\n<ul>\n<li><p>切换到已经安装的系统</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">arch-chroot /mnt<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>配置grub.cfg</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">grub-mkconfig -o /boot/grub/grub.cfg<br></code></pre></td></tr></table></figure>\n<h3 id=\"系统初始化设置\"><a href=\"#系统初始化设置\" class=\"headerlink\" title=\"系统初始化设置\"></a>系统初始化设置</h3></li>\n<li><p>设置时区</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">ln</span> -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime<br>hwclock --systohc<br></code></pre></td></tr></table></figure></li>\n<li><p>本地化</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">locale-gen<br></code></pre></td></tr></table></figure></li>\n</ul>\n<p>  – 移动设备最小化磁盘访问,把日志放到内存<br>  修改<code>/etc/systemd/journald.conf.d/usbstick.conf</code><br>  写入<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">[Journal]<br>Storage=volatile<br>RuntimeMaxUse=30M<br></code></pre></td></tr></table></figure></p>\n<ul>\n<li>initramfs<br>  如果是移动设备，将<code>/etc/mkinitcpio.conf</code>中<code>HOOKS</code>里面的<code>block</code>和<code>keyboard</code>放到<code>autodetect</code>前面，然后  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">mkinitcpio -P<br></code></pre></td></tr></table></figure></li>\n</ul>\n<p>  创建<code>/etc/locale.conf</code>,设置<code>LANG=en_US.UTF-8</code></p>\n<ul>\n<li><p>hostname<br>  创建<code>/etc/hostname</code>,写入主机名</p>\n</li>\n<li><p>root密码</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">passwd<br></code></pre></td></tr></table></figure></li>\n<li><p>hosts<br>  向<code>/etc/hosts</code>写入</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">127.0.0.1 localhost<br>::1 localhost<br>127.0.0.1 &#123;hostname&#125;<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>安装网络工具</p>\n</li>\n</ul>\n<p>  *networkmanager已经不使用dhcpcd, 因此需要安装dhclient<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">pacman -S iw wpa_supplicant dialog dhcpcd dhclient netctl networkmanager network-manager-applet gnome-keyring<br><span class=\"hljs-comment\"># 设置网络开机启动</span><br>systemctl <span class=\"hljs-built_in\">enable</span> NetworkManager.service<br></code></pre></td></tr></table></figure></p>\n<ul>\n<li>新增用户  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">useradd -m -G <span class=\"hljs-built_in\">users</span>,audio,lp,optical,storage,video,wheel,power -s /bin/bash 普通用户名<br>passwd 普通用户名<br></code></pre></td></tr></table></figure>\n  运行<code>visudo</code>, 去掉<code>%wheel ALL=(ALL) ALL</code>注释</li>\n</ul>\n<p><strong>到这里基本已经完成最小系统的配置和安装，在继续之前，改启动项然后reboot</strong></p>\n<h2 id=\"DE-x2F-WM-x2F-DM\"><a href=\"#DE-x2F-WM-x2F-DM\" class=\"headerlink\" title=\"DE&#x2F;WM&#x2F;DM\"></a>DE&#x2F;WM&#x2F;DM</h2><ul>\n<li><p>安装xorg</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S xorg xorg-xinit<br><span class=\"hljs-comment\">## 移动设备要安装</span><br><span class=\"hljs-comment\"># xf86-input-synaptics 支持触控板</span><br><span class=\"hljs-comment\"># xf86-video-vesa, xf86-video-ati, xf86-video-intel, xf86-video-amdgpu, xf86-video-nouveau and xf86-video-fbdev. 大多数的开源显卡驱动</span><br><span class=\"hljs-comment\">#  libeatmydata  可以禁用fsync，比如对于firefox：eatmydata firefox</span><br></code></pre></td></tr></table></figure></li>\n<li><p>安装字体</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S terminus-font <br></code></pre></td></tr></table></figure></li>\n<li><p>安装DE</p>\n<ul>\n<li>Mate<ul>\n<li>安装mate<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S mate mate-extra<br></code></pre></td></tr></table></figure></li>\n<li>配置xinitrc<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">cp</span> /etc/X11/xinit/xinitrc ~/.xinitrc<br></code></pre></td></tr></table></figure>\n把最后的启动换成<code>exec mate-session</code></li>\n</ul>\n</li>\n<li>XFCE<ul>\n<li>安装xfce<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S xfce4 xfce4-goodies<br></code></pre></td></tr></table></figure></li>\n<li>配置xinitrc<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">cp</span> /etc/X11/xinit/xinitrc ~/.xinitrc<br></code></pre></td></tr></table></figure>\n把最后的启动换成<code>exec startxfce4</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>仅安装WM</p>\n<p><em>(略)</em></p>\n</li>\n<li><p>安装DM</p>\n<ul>\n<li>lightdm<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S lightdm-gtk-greeter<br></code></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h2><h3 id=\"支持hyper-v增强模式\"><a href=\"#支持hyper-v增强模式\" class=\"headerlink\" title=\"支持hyper-v增强模式\"></a>支持hyper-v增强模式</h3>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">git <span class=\"hljs-built_in\">clone</span> https://www.github.com/Microsoft/linux-vm-tools<br><span class=\"hljs-built_in\">cd</span> linux-vm-tools/arch<br><span class=\"hljs-comment\"># 要先开代理</span><br>./make...<br>./install...<br></code></pre></td></tr></table></figure>\n<p>然后记得在win中用管理员设置</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cmd\"><span class=\"hljs-built_in\">Set</span>-VM -VMName &lt;your_vm_name&gt;  -EnhancedSessionTransportType HvSocket<br></code></pre></td></tr></table></figure>\n\n<p>  <strong>如果无法通过增强模式连接</strong></p>\n<p>  <a href=\"https://wiki.archlinux.org/title/Xrdp#loginctl_or_systemctl_--user_not_working\">arch wiki [loginctl or systemctl –user not working]</a></p>\n<p>  Try commenting out all the references to <code>systemd-home</code> in <code>/etc/pam.d/system-auth</code>, see <a href=\"https://github.com/neutrinolabs/xrdp/issues/1684\">github issue</a></p>\n<h3 id=\"alias\"><a href=\"#alias\" class=\"headerlink\" title=\"alias\"></a>alias</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">alias</span> s=<span class=\"hljs-string\">&#x27;sudo&#x27;</span><br><span class=\"hljs-built_in\">alias</span> <span class=\"hljs-built_in\">ls</span>=<span class=\"hljs-string\">&#x27;ls --color=auto&#x27;</span><br><span class=\"hljs-built_in\">alias</span> la=<span class=\"hljs-string\">&#x27;ls -a --color=auto&#x27;</span><br><span class=\"hljs-built_in\">alias</span> ll=<span class=\"hljs-string\">&#x27;ls -l --color=auto&#x27;</span><br><span class=\"hljs-built_in\">alias</span> lla=<span class=\"hljs-string\">&#x27;ls -l -a --color=auto&#x27;</span><br><span class=\"hljs-built_in\">alias</span> pac=<span class=\"hljs-string\">&#x27;pacman -S&#x27;</span><br><span class=\"hljs-built_in\">alias</span> pacyu=<span class=\"hljs-string\">&#x27;pacman -Syu&#x27;</span><br><span class=\"hljs-built_in\">alias</span> spac=<span class=\"hljs-string\">&#x27;sudo pacman -S&#x27;</span><br><span class=\"hljs-built_in\">alias</span> spacyu=<span class=\"hljs-string\">&#x27;sudo pacman -Syu&#x27;</span><br><span class=\"hljs-built_in\">alias</span> v=<span class=\"hljs-string\">&#x27;vim&#x27;</span><br><span class=\"hljs-built_in\">alias</span> sv=<span class=\"hljs-string\">&#x27;sudo vim&#x27;</span><br><br></code></pre></td></tr></table></figure>\n<h3 id=\"rsync备份\"><a href=\"#rsync备份\" class=\"headerlink\" title=\"rsync备份\"></a>rsync备份</h3><ul>\n<li>安装rsync<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S rsync<br></code></pre></td></tr></table></figure></li>\n<li>backup.sh<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-meta\">#!/bin/bash</span><br><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; start to backup... type device:&#x27;</span> &amp;&amp; \\<br>\t<span class=\"hljs-built_in\">read</span> device &amp;&amp; \\<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; type mount dir:&#x27;</span> &amp;&amp; \\<br>\t<span class=\"hljs-built_in\">read</span> mount_dir &amp;&amp; \\<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; umount $device...&#x27;</span>; \\<br>\tumount <span class=\"hljs-variable\">$device</span>;\\<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; umount /mnt/$mount_dir...&#x27;</span>; \\<br>\tumount /mnt/<span class=\"hljs-variable\">$mount_dir</span>; <br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; remove /mnt/$mount_dir...&#x27;</span>; \\<br>\t<span class=\"hljs-built_in\">rm</span> -rf /mnt/<span class=\"hljs-variable\">$mount_dir</span> &amp;&amp; \\<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; create directory /mnt/$mount_dir...&#x27;</span>; \\<br>\t<span class=\"hljs-built_in\">mkdir</span> /mnt/<span class=\"hljs-variable\">$mount_dir</span>; \\<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; mount $device to /mnt/$mount_dir...&#x27;</span>; \\<br>\tmount <span class=\"hljs-variable\">$device</span> /mnt/<span class=\"hljs-variable\">$mount_dir</span>; \\<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; create direcotry /mnt/$mount_dir/system_bakcup...&#x27;</span>; \\<br>\t<span class=\"hljs-built_in\">mkdir</span> /mnt/<span class=\"hljs-variable\">$mount_dir</span>/system_backup;<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; start to sync files to /mnt/$mount_dir/system_backup...&#x27;</span>; \\<br>\trsync --archive --one-file-system --hard-links \\<br>\t--acls --xattrs --sparse \\<br>\t--human-readable --numeric-ids --delete --delete-excluded \\<br>\t--itemize-changes --verbose --progress \\<br>\t--exclude=<span class=\"hljs-string\">&#x27;*~&#x27;</span> \\<br>\t--exclude=<span class=\"hljs-string\">&#x27;$device&#x27;</span> \\<br>\t--exclude=<span class=\"hljs-string\">&#x27;/mnt&#x27;</span> \\<br>\t--exclude=<span class=\"hljs-string\">&#x27;/dev&#x27;</span> \\<br>\t--exclude=<span class=\"hljs-string\">&#x27;/var/tmp&#x27;</span> \\<br>\t--exclude=<span class=\"hljs-string\">&#x27;/tmp&#x27;</span> \\<br>\t/ /mnt/<span class=\"hljs-variable\">$mount_dir</span>/system_backup &amp;&amp; \\<br><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; finished.&#x27;</span><br></code></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"中文及字体设置\"><a href=\"#中文及字体设置\" class=\"headerlink\" title=\"中文及字体设置\"></a>中文及字体设置</h3><ul>\n<li>语言配置<br>去掉<code>/etc/locale.gen</code>中的<code>zh_CN.UTF-8 UTF-8</code>和<code>en_US.UTF-8 UTF-8</code>的注释</li>\n</ul>\n<p>根据需要在<code>~/.xinitrc</code>或者<code>~/.bashrc</code>配置</p>\n<p><strong>在<code>~/.xinitrc</code>中配置要注意在<code>exec xxx</code>之前</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">export</span> LANG=zh_CN.UTF-8<br><span class=\"hljs-built_in\">export</span> LANGUAGE=zh_CN:en_US<br></code></pre></td></tr></table></figure>\n<ul>\n<li>字体配置<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S wqy-bitmapfont wqy-microhei noto-fonts noto-fonts-emoji<br></code></pre></td></tr></table></figure>\n设置<code>~/.config/fontconfig/fonts.conf</code><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=<span class=\"hljs-string\">&quot;1.0&quot;</span>?&gt;</span><br><span class=\"hljs-meta\">&lt;!DOCTYPE <span class=\"hljs-keyword\">fontconfig</span> <span class=\"hljs-keyword\">SYSTEM</span> <span class=\"hljs-string\">&#x27;fonts.dtd&#x27;</span>&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">fontconfig</span>&gt;</span><br><br>  <span class=\"hljs-comment\">&lt;!-- 显示器使用的像素排列方式 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;font&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;rgba&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">const</span>&gt;</span>rgb<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">const</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br>  <span class=\"hljs-comment\">&lt;!-- 字体微调的程度, 可选 hintnone, hintslight (默认), hintmedium, hintfull. --&gt;</span><br>  <span class=\"hljs-comment\">&lt;!-- 更高的 hinting 等级可使字体更锐利，同时也会损失更多的细节 --&gt;</span><br>  <span class=\"hljs-comment\">&lt;!-- 如果显示器的 DPI 高得不像话 (&gt;=300), 可关闭 hinting, 字体会自然对齐像素 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;font&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;hintstyle&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">const</span>&gt;</span>hintslight<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">const</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br>  <span class=\"hljs-comment\">&lt;!-- 抗锯齿. 除非屏幕DPI奇高否则建议开启 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;font&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;antialias&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">bool</span>&gt;</span>true<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">bool</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><br><span class=\"hljs-comment\">&lt;!-- 全局默认字体　--&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;prepend&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><span class=\"hljs-comment\">&lt;!-- 全局默认英文字体 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">compare</span>=<span class=\"hljs-string\">&quot;contains&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;lang&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>en<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;prepend&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><span class=\"hljs-comment\">&lt;!-- 全局默认中文字体 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">compare</span>=<span class=\"hljs-string\">&quot;contains&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;lang&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>zh<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;prepend&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><span class=\"hljs-comment\">&lt;!-- 默认无衬线字体 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">qual</span>=<span class=\"hljs-string\">&quot;any&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>sans-serif<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;prepend&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;same&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><span class=\"hljs-comment\">&lt;!-- 默认衬线字体 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">qual</span>=<span class=\"hljs-string\">&quot;any&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>serif<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;prepend&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;same&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><span class=\"hljs-comment\">&lt;!-- 默认等宽字体 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">qual</span>=<span class=\"hljs-string\">&quot;any&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>monospace<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;prepend&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;same&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br>  <span class=\"hljs-comment\">&lt;!-- 字体替换 --&gt;</span><br>  <span class=\"hljs-comment\">&lt;!--SimSun, Microsoft YaHei, SimHei -&gt; WenQuanYi Micro Hei --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>宋体<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;strong&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>          <span class=\"hljs-comment\">&lt;!-- &lt;string&gt;Noto Serif CJK SC&lt;/string&gt; --&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>SimSun<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;strong&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>          <span class=\"hljs-comment\">&lt;!-- &lt;string&gt;Noto Serif CJK SC&lt;/string&gt; --&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">qual</span>=<span class=\"hljs-string\">&quot;any&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>SimSun-18030<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;same&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>         <span class=\"hljs-comment\">&lt;!-- &lt;string&gt;Noto Serif CJK SC&lt;/string&gt; --&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">qual</span>=<span class=\"hljs-string\">&quot;any&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Microsoft YaHei<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;same&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">qual</span>=<span class=\"hljs-string\">&quot;any&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>SimHei<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;same&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Times New Roman<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;append&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;strong&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;append&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;strong&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><br><span class=\"hljs-comment\">&lt;!-- 备用字体优先顺序 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">alias</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>sans-serif<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">prefer</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Color Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK SC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK TC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK JP<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK KR<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">prefer</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">alias</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">alias</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>serif<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">prefer</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Color Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK SC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK TC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK JP<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK KR<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">prefer</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">alias</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">alias</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>monospace<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">prefer</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Color Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK SC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK TC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK JP<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK KR<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">prefer</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">alias</span>&gt;</span><br><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">fontconfig</span>&gt;</span><br></code></pre></td></tr></table></figure>\n设置字体偏好:<code>/etc/fonts/conf.d/64-language-selector-prefer.conf</code><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=<span class=\"hljs-string\">&quot;1.0&quot;</span>?&gt;</span><br><span class=\"hljs-meta\">&lt;!DOCTYPE <span class=\"hljs-keyword\">fontconfig</span> <span class=\"hljs-keyword\">SYSTEM</span> <span class=\"hljs-string\">&#x27;fonts.dtd&#x27;</span>&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">fontconfig</span>&gt;</span>  <br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">alias</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>sans-serif<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">prefer</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Color Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK SC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK TC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK JP<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK KR<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">prefer</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">alias</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">alias</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>serif<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">prefer</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Color Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK SC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK TC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK JP<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK KR<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">prefer</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">alias</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">alias</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>monospace<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">prefer</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Color Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK SC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK TC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK JP<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK KR<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">prefer</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">alias</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">fontconfig</span>&gt;</span><br><br><br></code></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"安装fcitx5\"><a href=\"#安装fcitx5\" class=\"headerlink\" title=\"安装fcitx5\"></a>安装fcitx5</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S fcitx5-im fcitx5-chinese-addons fcitx5-mozc<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"xfce的声音\"><a href=\"#xfce的声音\" class=\"headerlink\" title=\"xfce的声音\"></a>xfce的声音</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S alsa-utils pulseaudio pulseaudio-alsa \\<br> pavucontrol      <span class=\"hljs-comment\">#与xfce4 panel里面的插件配合使用,必须要有这个进程</span><br></code></pre></td></tr></table></figure>\n<p>xfce4 panel设置里面添加一个pulseaudio plugin的插件</p>\n<p><code>alsamixer</code> F6选择声卡,然后把mm的M键去掉,上下箭头调节,auto-mute disable了以后,loopback enable. reboot重启,这时候xfce4的插件就可以调节声音了</p>\n<h3 id=\"安装chrome\"><a href=\"#安装chrome\" class=\"headerlink\" title=\"安装chrome\"></a>安装chrome</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-comment\">#AUR 助手</span><br>git <span class=\"hljs-built_in\">clone</span> https://aur.archlinux.org/yay-git.git<br><span class=\"hljs-built_in\">cd</span> yay-git<br>makepkg -si<br><br><span class=\"hljs-comment\">#yay不要用root</span><br>yay -S google-chrome<br><br><span class=\"hljs-comment\">#升级</span><br>yay -Syu<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"安装clash\"><a href=\"#安装clash\" class=\"headerlink\" title=\"安装clash\"></a>安装clash</h3><p>看<a href=\"https://blog.linioi.com/posts/clash-on-arch/\">这</a><br>或者<a href=\"https://github.com/Fndroid/clash_for_windows_pkg/releases\">class for windows</a></p>\n<h3 id=\"支持ntfs\"><a href=\"#支持ntfs\" class=\"headerlink\" title=\"支持ntfs\"></a>支持ntfs</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S ntfs-3g<br></code></pre></td></tr></table></figure>","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":15863,"excerpt":"","more":"<blockquote>\n<p><a href=\"https://wiki.archlinux.org/\">https://wiki.archlinux.org/</a></p>\n</blockquote>\n<h2 id=\"基本系统安装\"><a href=\"#基本系统安装\" class=\"headerlink\" title=\"基本系统安装\"></a>基本系统安装</h2><h3 id=\"前置准备\"><a href=\"#前置准备\" class=\"headerlink\" title=\"前置准备\"></a>前置准备</h3><ul>\n<li>检查网络<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">ip <span class=\"hljs-built_in\">link</span><br></code></pre></td></tr></table></figure></li>\n<li>更新系统时间<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">timedatectl set-ntp <span class=\"hljs-literal\">true</span><br></code></pre></td></tr></table></figure>\n<h3 id=\"准备磁盘\"><a href=\"#准备磁盘\" class=\"headerlink\" title=\"准备磁盘\"></a>准备磁盘</h3></li>\n<li>分区<ul>\n<li><p>查看当前磁盘信息</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">fdisk -l<br></code></pre></td></tr></table></figure></li>\n<li><p>进入分区</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">fdisk /dev/the_disk_to_be_partitioned（要被分区的磁盘）<br></code></pre></td></tr></table></figure>\n<p>uefi参考：</p>\n<div class=\"table-wrapper\"/>\n<table>\n<thead>\n<tr>\n<th>挂载点</th>\n<th>分区</th>\n<th>分区类型</th>\n<th>大小</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&#x2F;mnt&#x2F;boot&#x2F;EFI</td>\n<td>&#x2F;dev&#x2F;efi_system_partition</td>\n<td>EFI系统分区</td>\n<td>300M</td>\n</tr>\n<tr>\n<td>[swap] <strong>移动设备建议不要</strong></td>\n<td>&#x2F;dev&#x2F;swap_partition&#x2F;</td>\n<td>Linux swap (交换空间)</td>\n<td>&gt; 512M (2G if physical ram &gt; 4G)</td>\n</tr>\n<tr>\n<td>&#x2F;mnt</td>\n<td>&#x2F;dev&#x2F;root_partition</td>\n<td>Linux x86-64 根目录 (&#x2F;)</td>\n<td>剩余空间</td>\n</tr>\n</tbody></table>\n</div>\n</li>\n<li><p><em>移动设备的情况下:</em></p>\n<div class=\"table-wrapper\"/>\n<table>\n<thead>\n<tr>\n<th>挂载点</th>\n<th>分区</th>\n<th>分区类型</th>\n<th>大小</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><em>none</em></td>\n<td><em>none</em></td>\n<td>BIOS启动分区</td>\n<td>1M</td>\n</tr>\n<tr>\n<td>&#x2F;mnt&#x2F;boot&#x2F;EFI</td>\n<td>&#x2F;dev&#x2F;efi_system_partition</td>\n<td>EFI系统分区</td>\n<td>300M</td>\n</tr>\n<tr>\n<td>&#x2F;mnt</td>\n<td>&#x2F;dev&#x2F;root_partition</td>\n<td>Linux x86-64 根目录 (&#x2F;)</td>\n<td>剩余空间</td>\n</tr>\n</tbody></table>\n</div>\n</li>\n<li><p>格式化分区</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">mkfs.ext4 /dev/root_partition（根分区）<br><span class=\"hljs-comment\"># 移动设备关闭日志 mkfs.ext4 -O &quot;^has_journal&quot; /dev/root_partition（根分区）</span><br>mkswap /dev/swap_partition（交换空间分区）<br>mkfs.fat -F 32 /dev/efi_system_partition<br></code></pre></td></tr></table></figure></li>\n<li><p>挂载分区&amp;启用交换空间</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">mount /dev/root_partition（根分区） /mnt<br>mount /dev/efi_system_partition /mnt/boot/efi<br>swapon /dev/swap_partition（交换空间分区）<br></code></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"安装系统\"><a href=\"#安装系统\" class=\"headerlink\" title=\"安装系统\"></a>安装系统</h3><ul>\n<li><p>设置cn源</p>\n<p>第一种方法</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-meta\">#!/bin/bash</span><br>curl <span class=\"hljs-string\">&#x27;https://archlinux.org/mirrorlist/?country=CN&amp;prototcol=http&amp;protocol=https&amp;ip_version=4&#x27;</span> &gt; /etc/pacman.d/mirrorlist &amp;&amp; \\<br><span class=\"hljs-built_in\">echo</span> /etc/pacman.d/mirrorlist &amp;&amp; \\<br>sudo vim /etc/pacman.d/mirrorlist &amp;&amp; \\<br><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;pacman mirror list updated&#x27;</span><br></code></pre></td></tr></table></figure>\n<p>  然后将<code>/etc/pacman.d/mirrorlist</code>中注释去掉</p>\n<p>第二种方法</p>\n<p>在<code>/etc/pacman.d/mirrorlist</code>中搜索CN，放到最前面，推荐aliyun的源</p>\n</li>\n<li><p>安装系统&amp;软件包</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">pacstrap /mnt base base-devel linux linux-firmware vim vi sudo git<br><span class=\"hljs-comment\"># 移动设备 可以使用基于BFQ的io调度内核linux-zen，把linux换成linux-zen</span><br></code></pre></td></tr></table></figure></li>\n</ul>\n<p>  <em>参考：<a href=\"https://www.kernel.org/doc/html/latest/block/bfq-iosched.html\">BFQ</a></em></p>\n<h2 id=\"系统配置\"><a href=\"#系统配置\" class=\"headerlink\" title=\"系统配置\"></a>系统配置</h2><h3 id=\"系统引导\"><a href=\"#系统引导\" class=\"headerlink\" title=\"系统引导\"></a>系统引导</h3><ul>\n<li>配置fstab  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab<br></code></pre></td></tr></table></figure></li>\n<li>安装grub  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">pacman -S efibootmgr grub<br><br><span class=\"hljs-comment\"># uefi</span><br>grub-install --target=x86_64-efi --efi-directory=&#123;挂载点,如/mnt/boot/EFI&#125; --bootloader-id=GRUB<br><br><span class=\"hljs-comment\"># bios(非GPT分区无需其他空间，但GPT分区需要有一块1M的BIOS boot分区)</span><br>grub-install --target=i386-pc /dev/sdX<br></code></pre></td></tr></table></figure></li>\n</ul>\n<p>  <em>移动设备的情况下</em></p>\n<p>  假设分区顺序是：<br>    - BIOS<br>    - EFI<br>    - root<br>  要先在这块设备上写入引导信息，运行<code>gdisk /dev/sdX</code></p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-comment\"># gdisk /dev/sdX</span><br><br>Command (? <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>): r<br>Recovery/transformation <span class=\"hljs-built_in\">command</span> (? <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>): h<br><br>WARNING! Hybrid MBRs are flaky and dangerous! If you decide not to use one,<br>just hit the Enter key at the below prompt and your MBR partition table will<br>be untouched.<br><br>Type from one to three GPT partition numbers, separated by spaces, to be added to the hybrid MBR, <span class=\"hljs-keyword\">in</span> sequence: 1 2 3<br>Place EFI GPT (0xEE) partition first <span class=\"hljs-keyword\">in</span> MBR (good <span class=\"hljs-keyword\">for</span> GRUB)? (Y/N): N<br><br>Creating entry <span class=\"hljs-keyword\">for</span> GPT partition <span class=\"hljs-comment\">#1 (MBR partition #1)</span><br>Enter an MBR hex code (default EF): <br>Set the bootable flag? (Y/N): N<br><br>Creating entry <span class=\"hljs-keyword\">for</span> GPT partition <span class=\"hljs-comment\">#2 (MBR partition #2)</span><br>Enter an MBR hex code (default EF): <br>Set the bootable flag? (Y/N): N<br><br>Creating entry <span class=\"hljs-keyword\">for</span> GPT partition <span class=\"hljs-comment\">#3 (MBR partition #3)</span><br>Enter an MBR hex code (default 83): <br>Set the bootable flag? (Y/N): Y<br><br>Recovery/transformation <span class=\"hljs-built_in\">command</span> (? <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>): x<br>Expert <span class=\"hljs-built_in\">command</span> (? <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>): h<br>Expert <span class=\"hljs-built_in\">command</span> (? <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>): w<br><br>Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING<br>PARTITIONS!!<br><br>Do you want to proceed? (Y/N): Y<br></code></pre></td></tr></table></figure>\n<blockquote>\n<p><strong>如果不需要兼容，不用做这一步，混合分区会在设备上存在两个分区表，系统识别这个设备分区的时候具体的行为完全依赖于系统的实现，非常不稳定</strong></p>\n</blockquote>\n<blockquote>\n<p><strong>注意：写完hybrid之后，默认的windows中就只认MBR分区，假设分区按上面的例子，且还有一个4号分区，那么由于MBR的限制</strong><br><strong>在windows中第四个分区是无法正确识别文件系统的，如果要使用第四个分区且要通过MBR引导，那么这里就要在MBR写入134分区</strong><br><strong>ESP分区可以不用写到MBR里</strong></p>\n</blockquote>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">pacman -S efibootmgr grub amd-ucode intel-ucode<br><br><span class=\"hljs-comment\"># uefi + MBR(BIOS)混合启动</span><br>grub-install --target=x86_64-efi --efi-directory=&#123;挂载点,如/mnt/boot/EFI&#125; --removable<br> --bootloader-id=GRUB --boot-directory=&#123;root挂载点,如/mnt&#125;/boot<br><br>grub-install --target=i386-pc --recheck --boot-directory=/DATA_MOUNTPOINT/boot /dev/sdX <span class=\"hljs-comment\">#注意这里是整个设备</span><br><br><span class=\"hljs-comment\"># 作为保险</span><br>grub-install --target=i386-pc --recheck --boot-directory=/DATA_MOUNTPOINT/boot /dev/&#123;root的那个分区&#125;<br></code></pre></td></tr></table></figure>\n<ul>\n<li><p>切换到已经安装的系统</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">arch-chroot /mnt<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>配置grub.cfg</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">grub-mkconfig -o /boot/grub/grub.cfg<br></code></pre></td></tr></table></figure>\n<h3 id=\"系统初始化设置\"><a href=\"#系统初始化设置\" class=\"headerlink\" title=\"系统初始化设置\"></a>系统初始化设置</h3></li>\n<li><p>设置时区</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">ln</span> -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime<br>hwclock --systohc<br></code></pre></td></tr></table></figure></li>\n<li><p>本地化</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">locale-gen<br></code></pre></td></tr></table></figure></li>\n</ul>\n<p>  – 移动设备最小化磁盘访问,把日志放到内存<br>  修改<code>/etc/systemd/journald.conf.d/usbstick.conf</code><br>  写入<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">[Journal]<br>Storage=volatile<br>RuntimeMaxUse=30M<br></code></pre></td></tr></table></figure></p>\n<ul>\n<li>initramfs<br>  如果是移动设备，将<code>/etc/mkinitcpio.conf</code>中<code>HOOKS</code>里面的<code>block</code>和<code>keyboard</code>放到<code>autodetect</code>前面，然后  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">mkinitcpio -P<br></code></pre></td></tr></table></figure></li>\n</ul>\n<p>  创建<code>/etc/locale.conf</code>,设置<code>LANG=en_US.UTF-8</code></p>\n<ul>\n<li><p>hostname<br>  创建<code>/etc/hostname</code>,写入主机名</p>\n</li>\n<li><p>root密码</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">passwd<br></code></pre></td></tr></table></figure></li>\n<li><p>hosts<br>  向<code>/etc/hosts</code>写入</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">127.0.0.1 localhost<br>::1 localhost<br>127.0.0.1 &#123;hostname&#125;<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>安装网络工具</p>\n</li>\n</ul>\n<p>  *networkmanager已经不使用dhcpcd, 因此需要安装dhclient<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">pacman -S iw wpa_supplicant dialog dhcpcd dhclient netctl networkmanager network-manager-applet gnome-keyring<br><span class=\"hljs-comment\"># 设置网络开机启动</span><br>systemctl <span class=\"hljs-built_in\">enable</span> NetworkManager.service<br></code></pre></td></tr></table></figure></p>\n<ul>\n<li>新增用户  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">useradd -m -G <span class=\"hljs-built_in\">users</span>,audio,lp,optical,storage,video,wheel,power -s /bin/bash 普通用户名<br>passwd 普通用户名<br></code></pre></td></tr></table></figure>\n  运行<code>visudo</code>, 去掉<code>%wheel ALL=(ALL) ALL</code>注释</li>\n</ul>\n<p><strong>到这里基本已经完成最小系统的配置和安装，在继续之前，改启动项然后reboot</strong></p>\n<h2 id=\"DE-x2F-WM-x2F-DM\"><a href=\"#DE-x2F-WM-x2F-DM\" class=\"headerlink\" title=\"DE&#x2F;WM&#x2F;DM\"></a>DE&#x2F;WM&#x2F;DM</h2><ul>\n<li><p>安装xorg</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S xorg xorg-xinit<br><span class=\"hljs-comment\">## 移动设备要安装</span><br><span class=\"hljs-comment\"># xf86-input-synaptics 支持触控板</span><br><span class=\"hljs-comment\"># xf86-video-vesa, xf86-video-ati, xf86-video-intel, xf86-video-amdgpu, xf86-video-nouveau and xf86-video-fbdev. 大多数的开源显卡驱动</span><br><span class=\"hljs-comment\">#  libeatmydata  可以禁用fsync，比如对于firefox：eatmydata firefox</span><br></code></pre></td></tr></table></figure></li>\n<li><p>安装字体</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S terminus-font <br></code></pre></td></tr></table></figure></li>\n<li><p>安装DE</p>\n<ul>\n<li>Mate<ul>\n<li>安装mate<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S mate mate-extra<br></code></pre></td></tr></table></figure></li>\n<li>配置xinitrc<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">cp</span> /etc/X11/xinit/xinitrc ~/.xinitrc<br></code></pre></td></tr></table></figure>\n把最后的启动换成<code>exec mate-session</code></li>\n</ul>\n</li>\n<li>XFCE<ul>\n<li>安装xfce<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S xfce4 xfce4-goodies<br></code></pre></td></tr></table></figure></li>\n<li>配置xinitrc<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">cp</span> /etc/X11/xinit/xinitrc ~/.xinitrc<br></code></pre></td></tr></table></figure>\n把最后的启动换成<code>exec startxfce4</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>仅安装WM</p>\n<p><em>(略)</em></p>\n</li>\n<li><p>安装DM</p>\n<ul>\n<li>lightdm<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S lightdm-gtk-greeter<br></code></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h2><h3 id=\"支持hyper-v增强模式\"><a href=\"#支持hyper-v增强模式\" class=\"headerlink\" title=\"支持hyper-v增强模式\"></a>支持hyper-v增强模式</h3>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">git <span class=\"hljs-built_in\">clone</span> https://www.github.com/Microsoft/linux-vm-tools<br><span class=\"hljs-built_in\">cd</span> linux-vm-tools/arch<br><span class=\"hljs-comment\"># 要先开代理</span><br>./make...<br>./install...<br></code></pre></td></tr></table></figure>\n<p>然后记得在win中用管理员设置</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cmd\"><span class=\"hljs-built_in\">Set</span>-VM -VMName &lt;your_vm_name&gt;  -EnhancedSessionTransportType HvSocket<br></code></pre></td></tr></table></figure>\n\n<p>  <strong>如果无法通过增强模式连接</strong></p>\n<p>  <a href=\"https://wiki.archlinux.org/title/Xrdp#loginctl_or_systemctl_--user_not_working\">arch wiki [loginctl or systemctl –user not working]</a></p>\n<p>  Try commenting out all the references to <code>systemd-home</code> in <code>/etc/pam.d/system-auth</code>, see <a href=\"https://github.com/neutrinolabs/xrdp/issues/1684\">github issue</a></p>\n<h3 id=\"alias\"><a href=\"#alias\" class=\"headerlink\" title=\"alias\"></a>alias</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">alias</span> s=<span class=\"hljs-string\">&#x27;sudo&#x27;</span><br><span class=\"hljs-built_in\">alias</span> <span class=\"hljs-built_in\">ls</span>=<span class=\"hljs-string\">&#x27;ls --color=auto&#x27;</span><br><span class=\"hljs-built_in\">alias</span> la=<span class=\"hljs-string\">&#x27;ls -a --color=auto&#x27;</span><br><span class=\"hljs-built_in\">alias</span> ll=<span class=\"hljs-string\">&#x27;ls -l --color=auto&#x27;</span><br><span class=\"hljs-built_in\">alias</span> lla=<span class=\"hljs-string\">&#x27;ls -l -a --color=auto&#x27;</span><br><span class=\"hljs-built_in\">alias</span> pac=<span class=\"hljs-string\">&#x27;pacman -S&#x27;</span><br><span class=\"hljs-built_in\">alias</span> pacyu=<span class=\"hljs-string\">&#x27;pacman -Syu&#x27;</span><br><span class=\"hljs-built_in\">alias</span> spac=<span class=\"hljs-string\">&#x27;sudo pacman -S&#x27;</span><br><span class=\"hljs-built_in\">alias</span> spacyu=<span class=\"hljs-string\">&#x27;sudo pacman -Syu&#x27;</span><br><span class=\"hljs-built_in\">alias</span> v=<span class=\"hljs-string\">&#x27;vim&#x27;</span><br><span class=\"hljs-built_in\">alias</span> sv=<span class=\"hljs-string\">&#x27;sudo vim&#x27;</span><br><br></code></pre></td></tr></table></figure>\n<h3 id=\"rsync备份\"><a href=\"#rsync备份\" class=\"headerlink\" title=\"rsync备份\"></a>rsync备份</h3><ul>\n<li>安装rsync<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S rsync<br></code></pre></td></tr></table></figure></li>\n<li>backup.sh<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-meta\">#!/bin/bash</span><br><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; start to backup... type device:&#x27;</span> &amp;&amp; \\<br>\t<span class=\"hljs-built_in\">read</span> device &amp;&amp; \\<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; type mount dir:&#x27;</span> &amp;&amp; \\<br>\t<span class=\"hljs-built_in\">read</span> mount_dir &amp;&amp; \\<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; umount $device...&#x27;</span>; \\<br>\tumount <span class=\"hljs-variable\">$device</span>;\\<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; umount /mnt/$mount_dir...&#x27;</span>; \\<br>\tumount /mnt/<span class=\"hljs-variable\">$mount_dir</span>; <br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; remove /mnt/$mount_dir...&#x27;</span>; \\<br>\t<span class=\"hljs-built_in\">rm</span> -rf /mnt/<span class=\"hljs-variable\">$mount_dir</span> &amp;&amp; \\<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; create directory /mnt/$mount_dir...&#x27;</span>; \\<br>\t<span class=\"hljs-built_in\">mkdir</span> /mnt/<span class=\"hljs-variable\">$mount_dir</span>; \\<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; mount $device to /mnt/$mount_dir...&#x27;</span>; \\<br>\tmount <span class=\"hljs-variable\">$device</span> /mnt/<span class=\"hljs-variable\">$mount_dir</span>; \\<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; create direcotry /mnt/$mount_dir/system_bakcup...&#x27;</span>; \\<br>\t<span class=\"hljs-built_in\">mkdir</span> /mnt/<span class=\"hljs-variable\">$mount_dir</span>/system_backup;<br>\t<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; start to sync files to /mnt/$mount_dir/system_backup...&#x27;</span>; \\<br>\trsync --archive --one-file-system --hard-links \\<br>\t--acls --xattrs --sparse \\<br>\t--human-readable --numeric-ids --delete --delete-excluded \\<br>\t--itemize-changes --verbose --progress \\<br>\t--exclude=<span class=\"hljs-string\">&#x27;*~&#x27;</span> \\<br>\t--exclude=<span class=\"hljs-string\">&#x27;$device&#x27;</span> \\<br>\t--exclude=<span class=\"hljs-string\">&#x27;/mnt&#x27;</span> \\<br>\t--exclude=<span class=\"hljs-string\">&#x27;/dev&#x27;</span> \\<br>\t--exclude=<span class=\"hljs-string\">&#x27;/var/tmp&#x27;</span> \\<br>\t--exclude=<span class=\"hljs-string\">&#x27;/tmp&#x27;</span> \\<br>\t/ /mnt/<span class=\"hljs-variable\">$mount_dir</span>/system_backup &amp;&amp; \\<br><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&#x27;==&gt; finished.&#x27;</span><br></code></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"中文及字体设置\"><a href=\"#中文及字体设置\" class=\"headerlink\" title=\"中文及字体设置\"></a>中文及字体设置</h3><ul>\n<li>语言配置<br>去掉<code>/etc/locale.gen</code>中的<code>zh_CN.UTF-8 UTF-8</code>和<code>en_US.UTF-8 UTF-8</code>的注释</li>\n</ul>\n<p>根据需要在<code>~/.xinitrc</code>或者<code>~/.bashrc</code>配置</p>\n<p><strong>在<code>~/.xinitrc</code>中配置要注意在<code>exec xxx</code>之前</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">export</span> LANG=zh_CN.UTF-8<br><span class=\"hljs-built_in\">export</span> LANGUAGE=zh_CN:en_US<br></code></pre></td></tr></table></figure>\n<ul>\n<li>字体配置<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S wqy-bitmapfont wqy-microhei noto-fonts noto-fonts-emoji<br></code></pre></td></tr></table></figure>\n设置<code>~/.config/fontconfig/fonts.conf</code><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=<span class=\"hljs-string\">&quot;1.0&quot;</span>?&gt;</span><br><span class=\"hljs-meta\">&lt;!DOCTYPE <span class=\"hljs-keyword\">fontconfig</span> <span class=\"hljs-keyword\">SYSTEM</span> <span class=\"hljs-string\">&#x27;fonts.dtd&#x27;</span>&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">fontconfig</span>&gt;</span><br><br>  <span class=\"hljs-comment\">&lt;!-- 显示器使用的像素排列方式 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;font&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;rgba&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">const</span>&gt;</span>rgb<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">const</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br>  <span class=\"hljs-comment\">&lt;!-- 字体微调的程度, 可选 hintnone, hintslight (默认), hintmedium, hintfull. --&gt;</span><br>  <span class=\"hljs-comment\">&lt;!-- 更高的 hinting 等级可使字体更锐利，同时也会损失更多的细节 --&gt;</span><br>  <span class=\"hljs-comment\">&lt;!-- 如果显示器的 DPI 高得不像话 (&gt;=300), 可关闭 hinting, 字体会自然对齐像素 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;font&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;hintstyle&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">const</span>&gt;</span>hintslight<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">const</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br>  <span class=\"hljs-comment\">&lt;!-- 抗锯齿. 除非屏幕DPI奇高否则建议开启 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;font&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;antialias&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">bool</span>&gt;</span>true<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">bool</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><br><span class=\"hljs-comment\">&lt;!-- 全局默认字体　--&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;prepend&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><span class=\"hljs-comment\">&lt;!-- 全局默认英文字体 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">compare</span>=<span class=\"hljs-string\">&quot;contains&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;lang&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>en<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;prepend&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><span class=\"hljs-comment\">&lt;!-- 全局默认中文字体 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">compare</span>=<span class=\"hljs-string\">&quot;contains&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;lang&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>zh<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;prepend&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><span class=\"hljs-comment\">&lt;!-- 默认无衬线字体 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">qual</span>=<span class=\"hljs-string\">&quot;any&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>sans-serif<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;prepend&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;same&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><span class=\"hljs-comment\">&lt;!-- 默认衬线字体 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">qual</span>=<span class=\"hljs-string\">&quot;any&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>serif<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;prepend&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;same&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><span class=\"hljs-comment\">&lt;!-- 默认等宽字体 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">qual</span>=<span class=\"hljs-string\">&quot;any&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>monospace<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;prepend&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;same&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br>  <span class=\"hljs-comment\">&lt;!-- 字体替换 --&gt;</span><br>  <span class=\"hljs-comment\">&lt;!--SimSun, Microsoft YaHei, SimHei -&gt; WenQuanYi Micro Hei --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>宋体<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;strong&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>          <span class=\"hljs-comment\">&lt;!-- &lt;string&gt;Noto Serif CJK SC&lt;/string&gt; --&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>SimSun<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;strong&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>          <span class=\"hljs-comment\">&lt;!-- &lt;string&gt;Noto Serif CJK SC&lt;/string&gt; --&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">qual</span>=<span class=\"hljs-string\">&quot;any&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>SimSun-18030<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;same&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>         <span class=\"hljs-comment\">&lt;!-- &lt;string&gt;Noto Serif CJK SC&lt;/string&gt; --&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">qual</span>=<span class=\"hljs-string\">&quot;any&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Microsoft YaHei<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;same&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">qual</span>=<span class=\"hljs-string\">&quot;any&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>SimHei<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;assign&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;same&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Times New Roman<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;append&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;strong&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">match</span> <span class=\"hljs-attr\">target</span>=<span class=\"hljs-string\">&quot;pattern&quot;</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">edit</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;family&quot;</span> <span class=\"hljs-attr\">mode</span>=<span class=\"hljs-string\">&quot;append&quot;</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">&quot;strong&quot;</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">string</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">string</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">edit</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">match</span>&gt;</span><br><br><br><span class=\"hljs-comment\">&lt;!-- 备用字体优先顺序 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">alias</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>sans-serif<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">prefer</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Color Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK SC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK TC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK JP<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK KR<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">prefer</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">alias</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">alias</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>serif<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">prefer</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Color Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK SC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK TC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK JP<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK KR<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">prefer</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">alias</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">alias</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>monospace<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">prefer</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Color Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK SC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK TC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK JP<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK KR<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">prefer</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">alias</span>&gt;</span><br><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">fontconfig</span>&gt;</span><br></code></pre></td></tr></table></figure>\n设置字体偏好:<code>/etc/fonts/conf.d/64-language-selector-prefer.conf</code><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=<span class=\"hljs-string\">&quot;1.0&quot;</span>?&gt;</span><br><span class=\"hljs-meta\">&lt;!DOCTYPE <span class=\"hljs-keyword\">fontconfig</span> <span class=\"hljs-keyword\">SYSTEM</span> <span class=\"hljs-string\">&#x27;fonts.dtd&#x27;</span>&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">fontconfig</span>&gt;</span>  <br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">alias</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>sans-serif<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">prefer</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Color Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK SC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK TC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK JP<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK KR<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">prefer</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">alias</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">alias</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>serif<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">prefer</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Color Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK SC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK TC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK JP<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK KR<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">prefer</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">alias</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">alias</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>monospace<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">prefer</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Terminus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>WenQuanYi WenQuanYi Bitmap Song<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Color Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Emoji<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK SC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK TC<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK JP<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">family</span>&gt;</span>Noto Sans CJK KR<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">family</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">prefer</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">alias</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">fontconfig</span>&gt;</span><br><br><br></code></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"安装fcitx5\"><a href=\"#安装fcitx5\" class=\"headerlink\" title=\"安装fcitx5\"></a>安装fcitx5</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S fcitx5-im fcitx5-chinese-addons fcitx5-mozc<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"xfce的声音\"><a href=\"#xfce的声音\" class=\"headerlink\" title=\"xfce的声音\"></a>xfce的声音</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S alsa-utils pulseaudio pulseaudio-alsa \\<br> pavucontrol      <span class=\"hljs-comment\">#与xfce4 panel里面的插件配合使用,必须要有这个进程</span><br></code></pre></td></tr></table></figure>\n<p>xfce4 panel设置里面添加一个pulseaudio plugin的插件</p>\n<p><code>alsamixer</code> F6选择声卡,然后把mm的M键去掉,上下箭头调节,auto-mute disable了以后,loopback enable. reboot重启,这时候xfce4的插件就可以调节声音了</p>\n<h3 id=\"安装chrome\"><a href=\"#安装chrome\" class=\"headerlink\" title=\"安装chrome\"></a>安装chrome</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-comment\">#AUR 助手</span><br>git <span class=\"hljs-built_in\">clone</span> https://aur.archlinux.org/yay-git.git<br><span class=\"hljs-built_in\">cd</span> yay-git<br>makepkg -si<br><br><span class=\"hljs-comment\">#yay不要用root</span><br>yay -S google-chrome<br><br><span class=\"hljs-comment\">#升级</span><br>yay -Syu<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"安装clash\"><a href=\"#安装clash\" class=\"headerlink\" title=\"安装clash\"></a>安装clash</h3><p>看<a href=\"https://blog.linioi.com/posts/clash-on-arch/\">这</a><br>或者<a href=\"https://github.com/Fndroid/clash_for_windows_pkg/releases\">class for windows</a></p>\n<h3 id=\"支持ntfs\"><a href=\"#支持ntfs\" class=\"headerlink\" title=\"支持ntfs\"></a>支持ntfs</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">sudo pacman -S ntfs-3g<br></code></pre></td></tr></table></figure>"},{"title":"Frida-il2cpp-bridge script for fate/go","date":"2022-03-17T07:10:42.000Z","_content":"\nhack script for fgo based on [frida](https://github.com/frida/frida) and [frida-il2cpp-bridge](https://github.com/vfsfitvnm/frida-il2cpp-bridge) \n\n### Supports\n\n- bilibili fate go v2.36.0\n\n- aniplex fate go v2.49.0\n  \n  *fate go in other channels/platforms/versions may functional but it's not tested*\n\n### Steps\n\n#### For Android\n\n**Android 10 or 11 is recommended, among testing in android 9 sometimes game may crash*\n\n- Install nodeJs for NPM\n\n- Install frida and frida-tools with ` npm install frida && npm install frida-tools`\n\n- Download latest frida-server from https://github.com/frida/frida/releases\n\n- Start rooted device, rettach with ` adb root`\n\n- Install game apk\n\n- Copy ***frida-server*** file to device directory such as ***/data/local/tmp***\n\n- Run `adb shell` to connect to device\n\n- Change ***frida-server*** file permission with `chmod 777 {directory}/frida-server`\n\n- Navigate to directory and run server with `./frida-server`\n\n#### For IOS\n\n- TODO\n\n#### Run script\n\n- See comments in ***fgo_hack_script.ts***, and change codes according to the *fgo* version\n  \n  - there is some tiny diffrences between *bili fatego* and *aniplex fatego*\n\n- Build with `./build_aniplex.sh` or `./build_bili.sh`\n\n- Run with `./run.sh com.bilibili.fgo` or `./run.sh com.aniplex.fategrandorder`\n  \n  - you could now see some logs (if codes like `console.log(...)` is uncommented) when starting battle\n\n- Have fun.\n\n### Features\n\n![in battle](/images/0.jpg)\n\n#### active\n\n1. Increase player's servant hp (by 500,000)\n\n2. Set all skills lv to 10 (both servant's and master's)\n\n3. Change all skills charge turn down (to 1)\n\n4. Try to disable codestage anti-cheat engine (notice that there is **NO WAY** to cheat safely cause anyway the battle data will be sent to game server)\n\n#### inactive\n\n1. Never die (reset hp every time servant dies)\n\n2. Increase attack & defence np rate\n\n3. Increase attack star rate\n\n### Issues\n\n- Could not ran with X64-based simulator such as MuMu (tested) at this time ([frida-il2cpp-bridge](https://github.com/vfsfitvnm/frida-il2cpp-bridge) version 0.7.9)\n\n- Features in [inactive](#inactive) may invoked too frequently that may cause some leakage\n","source":"_posts/fgo-frida-il2cpp-bridge.md","raw":"---\ntitle: Frida-il2cpp-bridge script for fate/go\ndate: 2022-03-17 15:10:42\ncategories: \n\t- hack\ntags:\n  - wallhack\n  - injection\n  - reverse engineering\n  - fgo\n---\n\nhack script for fgo based on [frida](https://github.com/frida/frida) and [frida-il2cpp-bridge](https://github.com/vfsfitvnm/frida-il2cpp-bridge) \n\n### Supports\n\n- bilibili fate go v2.36.0\n\n- aniplex fate go v2.49.0\n  \n  *fate go in other channels/platforms/versions may functional but it's not tested*\n\n### Steps\n\n#### For Android\n\n**Android 10 or 11 is recommended, among testing in android 9 sometimes game may crash*\n\n- Install nodeJs for NPM\n\n- Install frida and frida-tools with ` npm install frida && npm install frida-tools`\n\n- Download latest frida-server from https://github.com/frida/frida/releases\n\n- Start rooted device, rettach with ` adb root`\n\n- Install game apk\n\n- Copy ***frida-server*** file to device directory such as ***/data/local/tmp***\n\n- Run `adb shell` to connect to device\n\n- Change ***frida-server*** file permission with `chmod 777 {directory}/frida-server`\n\n- Navigate to directory and run server with `./frida-server`\n\n#### For IOS\n\n- TODO\n\n#### Run script\n\n- See comments in ***fgo_hack_script.ts***, and change codes according to the *fgo* version\n  \n  - there is some tiny diffrences between *bili fatego* and *aniplex fatego*\n\n- Build with `./build_aniplex.sh` or `./build_bili.sh`\n\n- Run with `./run.sh com.bilibili.fgo` or `./run.sh com.aniplex.fategrandorder`\n  \n  - you could now see some logs (if codes like `console.log(...)` is uncommented) when starting battle\n\n- Have fun.\n\n### Features\n\n![in battle](/images/0.jpg)\n\n#### active\n\n1. Increase player's servant hp (by 500,000)\n\n2. Set all skills lv to 10 (both servant's and master's)\n\n3. Change all skills charge turn down (to 1)\n\n4. Try to disable codestage anti-cheat engine (notice that there is **NO WAY** to cheat safely cause anyway the battle data will be sent to game server)\n\n#### inactive\n\n1. Never die (reset hp every time servant dies)\n\n2. Increase attack & defence np rate\n\n3. Increase attack star rate\n\n### Issues\n\n- Could not ran with X64-based simulator such as MuMu (tested) at this time ([frida-il2cpp-bridge](https://github.com/vfsfitvnm/frida-il2cpp-bridge) version 0.7.9)\n\n- Features in [inactive](#inactive) may invoked too frequently that may cause some leakage\n","slug":"fgo-frida-il2cpp-bridge","published":1,"updated":"2022-06-13T15:23:46.980Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl4jxc2cp0003noouf8cp64u5","content":"<p>hack script for fgo based on <a href=\"https://github.com/frida/frida\">frida</a> and <a href=\"https://github.com/vfsfitvnm/frida-il2cpp-bridge\">frida-il2cpp-bridge</a> </p>\n<h3 id=\"Supports\"><a href=\"#Supports\" class=\"headerlink\" title=\"Supports\"></a>Supports</h3><ul>\n<li><p>bilibili fate go v2.36.0</p>\n</li>\n<li><p>aniplex fate go v2.49.0</p>\n<p><em>fate go in other channels&#x2F;platforms&#x2F;versions may functional but it’s not tested</em></p>\n</li>\n</ul>\n<h3 id=\"Steps\"><a href=\"#Steps\" class=\"headerlink\" title=\"Steps\"></a>Steps</h3><h4 id=\"For-Android\"><a href=\"#For-Android\" class=\"headerlink\" title=\"For Android\"></a>For Android</h4><p>*<em>Android 10 or 11 is recommended, among testing in android 9 sometimes game may crash</em></p>\n<ul>\n<li><p>Install nodeJs for NPM</p>\n</li>\n<li><p>Install frida and frida-tools with <code> npm install frida &amp;&amp; npm install frida-tools</code></p>\n</li>\n<li><p>Download latest frida-server from <a href=\"https://github.com/frida/frida/releases\">https://github.com/frida/frida/releases</a></p>\n</li>\n<li><p>Start rooted device, rettach with <code> adb root</code></p>\n</li>\n<li><p>Install game apk</p>\n</li>\n<li><p>Copy <em><strong>frida-server</strong></em> file to device directory such as <em><strong>&#x2F;data&#x2F;local&#x2F;tmp</strong></em></p>\n</li>\n<li><p>Run <code>adb shell</code> to connect to device</p>\n</li>\n<li><p>Change <em><strong>frida-server</strong></em> file permission with <code>chmod 777 &#123;directory&#125;/frida-server</code></p>\n</li>\n<li><p>Navigate to directory and run server with <code>./frida-server</code></p>\n</li>\n</ul>\n<h4 id=\"For-IOS\"><a href=\"#For-IOS\" class=\"headerlink\" title=\"For IOS\"></a>For IOS</h4><ul>\n<li>TODO</li>\n</ul>\n<h4 id=\"Run-script\"><a href=\"#Run-script\" class=\"headerlink\" title=\"Run script\"></a>Run script</h4><ul>\n<li><p>See comments in <em><strong>fgo_hack_script.ts</strong></em>, and change codes according to the <em>fgo</em> version</p>\n<ul>\n<li>there is some tiny diffrences between <em>bili fatego</em> and <em>aniplex fatego</em></li>\n</ul>\n</li>\n<li><p>Build with <code>./build_aniplex.sh</code> or <code>./build_bili.sh</code></p>\n</li>\n<li><p>Run with <code>./run.sh com.bilibili.fgo</code> or <code>./run.sh com.aniplex.fategrandorder</code></p>\n<ul>\n<li>you could now see some logs (if codes like <code>console.log(...)</code> is uncommented) when starting battle</li>\n</ul>\n</li>\n<li><p>Have fun.</p>\n</li>\n</ul>\n<h3 id=\"Features\"><a href=\"#Features\" class=\"headerlink\" title=\"Features\"></a>Features</h3><p><img src=\"/images/0.jpg\" alt=\"in battle\"></p>\n<h4 id=\"active\"><a href=\"#active\" class=\"headerlink\" title=\"active\"></a>active</h4><ol>\n<li><p>Increase player’s servant hp (by 500,000)</p>\n</li>\n<li><p>Set all skills lv to 10 (both servant’s and master’s)</p>\n</li>\n<li><p>Change all skills charge turn down (to 1)</p>\n</li>\n<li><p>Try to disable codestage anti-cheat engine (notice that there is <strong>NO WAY</strong> to cheat safely cause anyway the battle data will be sent to game server)</p>\n</li>\n</ol>\n<h4 id=\"inactive\"><a href=\"#inactive\" class=\"headerlink\" title=\"inactive\"></a>inactive</h4><ol>\n<li><p>Never die (reset hp every time servant dies)</p>\n</li>\n<li><p>Increase attack &amp; defence np rate</p>\n</li>\n<li><p>Increase attack star rate</p>\n</li>\n</ol>\n<h3 id=\"Issues\"><a href=\"#Issues\" class=\"headerlink\" title=\"Issues\"></a>Issues</h3><ul>\n<li><p>Could not ran with X64-based simulator such as MuMu (tested) at this time (<a href=\"https://github.com/vfsfitvnm/frida-il2cpp-bridge\">frida-il2cpp-bridge</a> version 0.7.9)</p>\n</li>\n<li><p>Features in <a href=\"#inactive\">inactive</a> may invoked too frequently that may cause some leakage</p>\n</li>\n</ul>\n","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":1565,"excerpt":"","more":"<p>hack script for fgo based on <a href=\"https://github.com/frida/frida\">frida</a> and <a href=\"https://github.com/vfsfitvnm/frida-il2cpp-bridge\">frida-il2cpp-bridge</a> </p>\n<h3 id=\"Supports\"><a href=\"#Supports\" class=\"headerlink\" title=\"Supports\"></a>Supports</h3><ul>\n<li><p>bilibili fate go v2.36.0</p>\n</li>\n<li><p>aniplex fate go v2.49.0</p>\n<p><em>fate go in other channels&#x2F;platforms&#x2F;versions may functional but it’s not tested</em></p>\n</li>\n</ul>\n<h3 id=\"Steps\"><a href=\"#Steps\" class=\"headerlink\" title=\"Steps\"></a>Steps</h3><h4 id=\"For-Android\"><a href=\"#For-Android\" class=\"headerlink\" title=\"For Android\"></a>For Android</h4><p>*<em>Android 10 or 11 is recommended, among testing in android 9 sometimes game may crash</em></p>\n<ul>\n<li><p>Install nodeJs for NPM</p>\n</li>\n<li><p>Install frida and frida-tools with <code> npm install frida &amp;&amp; npm install frida-tools</code></p>\n</li>\n<li><p>Download latest frida-server from <a href=\"https://github.com/frida/frida/releases\">https://github.com/frida/frida/releases</a></p>\n</li>\n<li><p>Start rooted device, rettach with <code> adb root</code></p>\n</li>\n<li><p>Install game apk</p>\n</li>\n<li><p>Copy <em><strong>frida-server</strong></em> file to device directory such as <em><strong>&#x2F;data&#x2F;local&#x2F;tmp</strong></em></p>\n</li>\n<li><p>Run <code>adb shell</code> to connect to device</p>\n</li>\n<li><p>Change <em><strong>frida-server</strong></em> file permission with <code>chmod 777 &#123;directory&#125;/frida-server</code></p>\n</li>\n<li><p>Navigate to directory and run server with <code>./frida-server</code></p>\n</li>\n</ul>\n<h4 id=\"For-IOS\"><a href=\"#For-IOS\" class=\"headerlink\" title=\"For IOS\"></a>For IOS</h4><ul>\n<li>TODO</li>\n</ul>\n<h4 id=\"Run-script\"><a href=\"#Run-script\" class=\"headerlink\" title=\"Run script\"></a>Run script</h4><ul>\n<li><p>See comments in <em><strong>fgo_hack_script.ts</strong></em>, and change codes according to the <em>fgo</em> version</p>\n<ul>\n<li>there is some tiny diffrences between <em>bili fatego</em> and <em>aniplex fatego</em></li>\n</ul>\n</li>\n<li><p>Build with <code>./build_aniplex.sh</code> or <code>./build_bili.sh</code></p>\n</li>\n<li><p>Run with <code>./run.sh com.bilibili.fgo</code> or <code>./run.sh com.aniplex.fategrandorder</code></p>\n<ul>\n<li>you could now see some logs (if codes like <code>console.log(...)</code> is uncommented) when starting battle</li>\n</ul>\n</li>\n<li><p>Have fun.</p>\n</li>\n</ul>\n<h3 id=\"Features\"><a href=\"#Features\" class=\"headerlink\" title=\"Features\"></a>Features</h3><p><img src=\"/images/0.jpg\" alt=\"in battle\"></p>\n<h4 id=\"active\"><a href=\"#active\" class=\"headerlink\" title=\"active\"></a>active</h4><ol>\n<li><p>Increase player’s servant hp (by 500,000)</p>\n</li>\n<li><p>Set all skills lv to 10 (both servant’s and master’s)</p>\n</li>\n<li><p>Change all skills charge turn down (to 1)</p>\n</li>\n<li><p>Try to disable codestage anti-cheat engine (notice that there is <strong>NO WAY</strong> to cheat safely cause anyway the battle data will be sent to game server)</p>\n</li>\n</ol>\n<h4 id=\"inactive\"><a href=\"#inactive\" class=\"headerlink\" title=\"inactive\"></a>inactive</h4><ol>\n<li><p>Never die (reset hp every time servant dies)</p>\n</li>\n<li><p>Increase attack &amp; defence np rate</p>\n</li>\n<li><p>Increase attack star rate</p>\n</li>\n</ol>\n<h3 id=\"Issues\"><a href=\"#Issues\" class=\"headerlink\" title=\"Issues\"></a>Issues</h3><ul>\n<li><p>Could not ran with X64-based simulator such as MuMu (tested) at this time (<a href=\"https://github.com/vfsfitvnm/frida-il2cpp-bridge\">frida-il2cpp-bridge</a> version 0.7.9)</p>\n</li>\n<li><p>Features in <a href=\"#inactive\">inactive</a> may invoked too frequently that may cause some leakage</p>\n</li>\n</ul>\n"},{"title":"错误的动态类加载方式引发的metaspace内存泄漏","date":"2022-03-17T07:59:28.000Z","_content":"\n## 现象\n\n通过`ClassLoader#defineClass`方法重复定义指定`name`的类, HotSpot JVM最终会在metaspace中抛出OOM。\n\n## `ClassLoader#defineClass`的行为\n\n![defineClass](jvm-metaspace-leakage-caused-by-loading-dynamic-class/0.png)\n\n`ClassLoader#defineClass`是JVM本地方法, 主要的执行步骤:\n\n1. 解析class文件并检查class文件格式是否正确。\n   \n   ![vm specification](jvm-metaspace-leakage-caused-by-loading-dynamic-class/1.png)\n\n2. 根据`name`检查`systemDictionary`中class对应的类数据Klass/KlassHandler是否已经加载过。\n\n\n## HotSpot VM解析class的时候实际行为\n\n在解析和检查class格式过程中, HotSpot VM同时也在metaspace中产生了对应class文件的结构数据 (class code, vtable, itable, etc.)。 所以即使传入的`name`完全一样, 也会在metaspace中不断产生“重复”的class数据。\n\n![native define class](jvm-metaspace-leakage-caused-by-loading-dynamic-class/2.png)\n\n![find klass in dict](jvm-metaspace-leakage-caused-by-loading-dynamic-class/3.png)\n\n![check if class already defined](jvm-metaspace-leakage-caused-by-loading-dynamic-class/4.png)\n\n选择在解析的过程中保留完整的class数据（这里“完整”指的是相对与解析一部分之后丢弃一部分的做法），除了不这么做会增加代码复杂度、增加class数据解析的次数、产生更多的内存碎片之外，另一个考虑是正确且规范的动态类加载方式应该是通过`ClassLoader#loadClass()`来进行，而不是直接调用native方法，因为直接调用native方法并不会得到不一样的结果。\n\n![loadClass in java](jvm-metaspace-leakage-caused-by-loading-dynamic-class/5.png)\n\n## metaspace中Class数据的GC时机\n\n实际上没有特定针对metaspace的GC行为，GC总是在堆中工作。但当堆中包含metaspace的class数据指针的class对象被执行回收时，class数据占用的空间也会被同时释放。\n\n![metaspace 'GC'](jvm-metaspace-leakage-caused-by-loading-dynamic-class/6.png)","source":"_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class.md","raw":"---\ntitle: 错误的动态类加载方式引发的metaspace内存泄漏\ndate: 2022-03-17 15:59:28\ncategories: \n\t- Java\ntags:\n  - JVM\n  - JVM Memory\n  - Java\n---\n\n## 现象\n\n通过`ClassLoader#defineClass`方法重复定义指定`name`的类, HotSpot JVM最终会在metaspace中抛出OOM。\n\n## `ClassLoader#defineClass`的行为\n\n![defineClass](jvm-metaspace-leakage-caused-by-loading-dynamic-class/0.png)\n\n`ClassLoader#defineClass`是JVM本地方法, 主要的执行步骤:\n\n1. 解析class文件并检查class文件格式是否正确。\n   \n   ![vm specification](jvm-metaspace-leakage-caused-by-loading-dynamic-class/1.png)\n\n2. 根据`name`检查`systemDictionary`中class对应的类数据Klass/KlassHandler是否已经加载过。\n\n\n## HotSpot VM解析class的时候实际行为\n\n在解析和检查class格式过程中, HotSpot VM同时也在metaspace中产生了对应class文件的结构数据 (class code, vtable, itable, etc.)。 所以即使传入的`name`完全一样, 也会在metaspace中不断产生“重复”的class数据。\n\n![native define class](jvm-metaspace-leakage-caused-by-loading-dynamic-class/2.png)\n\n![find klass in dict](jvm-metaspace-leakage-caused-by-loading-dynamic-class/3.png)\n\n![check if class already defined](jvm-metaspace-leakage-caused-by-loading-dynamic-class/4.png)\n\n选择在解析的过程中保留完整的class数据（这里“完整”指的是相对与解析一部分之后丢弃一部分的做法），除了不这么做会增加代码复杂度、增加class数据解析的次数、产生更多的内存碎片之外，另一个考虑是正确且规范的动态类加载方式应该是通过`ClassLoader#loadClass()`来进行，而不是直接调用native方法，因为直接调用native方法并不会得到不一样的结果。\n\n![loadClass in java](jvm-metaspace-leakage-caused-by-loading-dynamic-class/5.png)\n\n## metaspace中Class数据的GC时机\n\n实际上没有特定针对metaspace的GC行为，GC总是在堆中工作。但当堆中包含metaspace的class数据指针的class对象被执行回收时，class数据占用的空间也会被同时释放。\n\n![metaspace 'GC'](jvm-metaspace-leakage-caused-by-loading-dynamic-class/6.png)","slug":"jvm-metaspace-leakage-caused-by-loading-dynamic-class","published":1,"updated":"2022-06-18T13:18:00.176Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl4jxc2cv0007noouafti2s7a","content":"<h2 id=\"现象\"><a href=\"#现象\" class=\"headerlink\" title=\"现象\"></a>现象</h2><p>通过<code>ClassLoader#defineClass</code>方法重复定义指定<code>name</code>的类, HotSpot JVM最终会在metaspace中抛出OOM。</p>\n<h2 id=\"ClassLoader-defineClass的行为\"><a href=\"#ClassLoader-defineClass的行为\" class=\"headerlink\" title=\"ClassLoader#defineClass的行为\"></a><code>ClassLoader#defineClass</code>的行为</h2><p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/0.png\" alt=\"defineClass\"></p>\n<p><code>ClassLoader#defineClass</code>是JVM本地方法, 主要的执行步骤:</p>\n<ol>\n<li><p>解析class文件并检查class文件格式是否正确。</p>\n<p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/1.png\" alt=\"vm specification\"></p>\n</li>\n<li><p>根据<code>name</code>检查<code>systemDictionary</code>中class对应的类数据Klass&#x2F;KlassHandler是否已经加载过。</p>\n</li>\n</ol>\n<h2 id=\"HotSpot-VM解析class的时候实际行为\"><a href=\"#HotSpot-VM解析class的时候实际行为\" class=\"headerlink\" title=\"HotSpot VM解析class的时候实际行为\"></a>HotSpot VM解析class的时候实际行为</h2><p>在解析和检查class格式过程中, HotSpot VM同时也在metaspace中产生了对应class文件的结构数据 (class code, vtable, itable, etc.)。 所以即使传入的<code>name</code>完全一样, 也会在metaspace中不断产生“重复”的class数据。</p>\n<p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/2.png\" alt=\"native define class\"></p>\n<p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/3.png\" alt=\"find klass in dict\"></p>\n<p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/4.png\" alt=\"check if class already defined\"></p>\n<p>选择在解析的过程中保留完整的class数据（这里“完整”指的是相对与解析一部分之后丢弃一部分的做法），除了不这么做会增加代码复杂度、增加class数据解析的次数、产生更多的内存碎片之外，另一个考虑是正确且规范的动态类加载方式应该是通过<code>ClassLoader#loadClass()</code>来进行，而不是直接调用native方法，因为直接调用native方法并不会得到不一样的结果。</p>\n<p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/5.png\" alt=\"loadClass in java\"></p>\n<h2 id=\"metaspace中Class数据的GC时机\"><a href=\"#metaspace中Class数据的GC时机\" class=\"headerlink\" title=\"metaspace中Class数据的GC时机\"></a>metaspace中Class数据的GC时机</h2><p>实际上没有特定针对metaspace的GC行为，GC总是在堆中工作。但当堆中包含metaspace的class数据指针的class对象被执行回收时，class数据占用的空间也会被同时释放。</p>\n<p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/6.png\" alt=\"metaspace &#39;GC&#39;\"></p>\n","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":690,"excerpt":"","more":"<h2 id=\"现象\"><a href=\"#现象\" class=\"headerlink\" title=\"现象\"></a>现象</h2><p>通过<code>ClassLoader#defineClass</code>方法重复定义指定<code>name</code>的类, HotSpot JVM最终会在metaspace中抛出OOM。</p>\n<h2 id=\"ClassLoader-defineClass的行为\"><a href=\"#ClassLoader-defineClass的行为\" class=\"headerlink\" title=\"ClassLoader#defineClass的行为\"></a><code>ClassLoader#defineClass</code>的行为</h2><p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/0.png\" alt=\"defineClass\"></p>\n<p><code>ClassLoader#defineClass</code>是JVM本地方法, 主要的执行步骤:</p>\n<ol>\n<li><p>解析class文件并检查class文件格式是否正确。</p>\n<p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/1.png\" alt=\"vm specification\"></p>\n</li>\n<li><p>根据<code>name</code>检查<code>systemDictionary</code>中class对应的类数据Klass&#x2F;KlassHandler是否已经加载过。</p>\n</li>\n</ol>\n<h2 id=\"HotSpot-VM解析class的时候实际行为\"><a href=\"#HotSpot-VM解析class的时候实际行为\" class=\"headerlink\" title=\"HotSpot VM解析class的时候实际行为\"></a>HotSpot VM解析class的时候实际行为</h2><p>在解析和检查class格式过程中, HotSpot VM同时也在metaspace中产生了对应class文件的结构数据 (class code, vtable, itable, etc.)。 所以即使传入的<code>name</code>完全一样, 也会在metaspace中不断产生“重复”的class数据。</p>\n<p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/2.png\" alt=\"native define class\"></p>\n<p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/3.png\" alt=\"find klass in dict\"></p>\n<p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/4.png\" alt=\"check if class already defined\"></p>\n<p>选择在解析的过程中保留完整的class数据（这里“完整”指的是相对与解析一部分之后丢弃一部分的做法），除了不这么做会增加代码复杂度、增加class数据解析的次数、产生更多的内存碎片之外，另一个考虑是正确且规范的动态类加载方式应该是通过<code>ClassLoader#loadClass()</code>来进行，而不是直接调用native方法，因为直接调用native方法并不会得到不一样的结果。</p>\n<p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/5.png\" alt=\"loadClass in java\"></p>\n<h2 id=\"metaspace中Class数据的GC时机\"><a href=\"#metaspace中Class数据的GC时机\" class=\"headerlink\" title=\"metaspace中Class数据的GC时机\"></a>metaspace中Class数据的GC时机</h2><p>实际上没有特定针对metaspace的GC行为，GC总是在堆中工作。但当堆中包含metaspace的class数据指针的class对象被执行回收时，class数据占用的空间也会被同时释放。</p>\n<p><img src=\"/2022/03/17/jvm-metaspace-leakage-caused-by-loading-dynamic-class/6.png\" alt=\"metaspace &#39;GC&#39;\"></p>\n"},{"title":"Shell脚本笔记","date":"2022-03-19T15:27:41.000Z","_content":"\n- 接受用户输入\n  \n  ```bash\n  read var\n  echo \"input value is $var\"\n  ```\n\n- 成功后执行\n  \n  ```bash\n  rm somefile && echo \"removed\"\n  ```\n\n- 失败后执行\n  \n  ```bash\n  rm filenotexists || echo \"nothing removed\"\n  ```\n\n- 重定向输出\n  \n  - `1`代表`stdout`, 标准输出\n  \n  - `2`代表`stderr`, 标准错误输出\n  \n  - `&`代表\"按照相同方式输出\"\n  \n  - `dev/null`是null文件，可以理解为一个“黑洞”设备，所有输入都会被丢弃\n  \n  ```bash\n  echo \"blabla\" > dest.file\n  \n  # 输出所有输出到文件\n  echo \"blabla\" 1 > dest.file\n  \n  # 只输出错误输出到文件\n  rm filenotexists 2 > err.log\n  \n  # 输出所有输出到文件\n  rm somefile 1 > dest.file 2>&1\n  \n  # 输出非错误输出到文件\n  rm somefile 1 > dest.file 2 > dev/null\n  \n  # 创建两条管道\n  rm somefile 1 > log 2 > log\n  \n  # 2的管道继承于1\n  rm somefile 1 > log 2>&1\n  ```\n\n- 创建固定大小的空文件\n  \n  当`dev/zero`作为输入流的时候，会产生无限的0 (不是ASCII的'0')\n  \n  ```bash\n  # input file is /dev/zero\n  # output file is file\n  # write 10 times\n  # 1024 bytes every time\n  # so it creates a 10k blank file\n  dd if=/dev/zero of=file count=10 bs=1024\n  ```\n\n- if else\n  \n  ```bash\n  a=10\n  b=20\n  if [ $a == $b ]\n  then\n     echo \"a is equal to b\"\n  elif [ $a -gt $b ]\n  then\n     echo \"a greater than b\"\n  elif [ $a -lt $b ]\n  then\n     echo \"a less than b\"\n  else\n     echo \"\"\n  fi\n  ```\n\n- 追加到文件\n  \n  ```bash\n  file1 >> file2\n  echo \"tails\" >> file\n  date >> file\n  ```\n","source":"_posts/shell-some-memos-for-shell-script.md","raw":"---\ntitle: Shell脚本笔记\ndate: 2022-03-19 23:27:41\ncategories: \n\t- Linux\ntags:\n\t- Linux\n\t- shell script\n---\n\n- 接受用户输入\n  \n  ```bash\n  read var\n  echo \"input value is $var\"\n  ```\n\n- 成功后执行\n  \n  ```bash\n  rm somefile && echo \"removed\"\n  ```\n\n- 失败后执行\n  \n  ```bash\n  rm filenotexists || echo \"nothing removed\"\n  ```\n\n- 重定向输出\n  \n  - `1`代表`stdout`, 标准输出\n  \n  - `2`代表`stderr`, 标准错误输出\n  \n  - `&`代表\"按照相同方式输出\"\n  \n  - `dev/null`是null文件，可以理解为一个“黑洞”设备，所有输入都会被丢弃\n  \n  ```bash\n  echo \"blabla\" > dest.file\n  \n  # 输出所有输出到文件\n  echo \"blabla\" 1 > dest.file\n  \n  # 只输出错误输出到文件\n  rm filenotexists 2 > err.log\n  \n  # 输出所有输出到文件\n  rm somefile 1 > dest.file 2>&1\n  \n  # 输出非错误输出到文件\n  rm somefile 1 > dest.file 2 > dev/null\n  \n  # 创建两条管道\n  rm somefile 1 > log 2 > log\n  \n  # 2的管道继承于1\n  rm somefile 1 > log 2>&1\n  ```\n\n- 创建固定大小的空文件\n  \n  当`dev/zero`作为输入流的时候，会产生无限的0 (不是ASCII的'0')\n  \n  ```bash\n  # input file is /dev/zero\n  # output file is file\n  # write 10 times\n  # 1024 bytes every time\n  # so it creates a 10k blank file\n  dd if=/dev/zero of=file count=10 bs=1024\n  ```\n\n- if else\n  \n  ```bash\n  a=10\n  b=20\n  if [ $a == $b ]\n  then\n     echo \"a is equal to b\"\n  elif [ $a -gt $b ]\n  then\n     echo \"a greater than b\"\n  elif [ $a -lt $b ]\n  then\n     echo \"a less than b\"\n  else\n     echo \"\"\n  fi\n  ```\n\n- 追加到文件\n  \n  ```bash\n  file1 >> file2\n  echo \"tails\" >> file\n  date >> file\n  ```\n","slug":"shell-some-memos-for-shell-script","published":1,"updated":"2022-06-18T13:25:25.042Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl4jxc2d5000znoou0n48aisg","content":"<ul>\n<li><p>接受用户输入</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">read</span> var<br><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;input value is <span class=\"hljs-variable\">$var</span>&quot;</span><br></code></pre></td></tr></table></figure>\n</li>\n<li><p>成功后执行</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">rm</span> somefile &amp;&amp; <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;removed&quot;</span><br></code></pre></td></tr></table></figure>\n</li>\n<li><p>失败后执行</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">rm</span> filenotexists || <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;nothing removed&quot;</span><br></code></pre></td></tr></table></figure>\n</li>\n<li><p>重定向输出</p>\n<ul>\n<li><p><code>1</code>代表<code>stdout</code>, 标准输出</p>\n</li>\n<li><p><code>2</code>代表<code>stderr</code>, 标准错误输出</p>\n</li>\n<li><p><code>&amp;</code>代表”按照相同方式输出”</p>\n</li>\n<li><p><code>dev/null</code>是null文件，可以理解为一个“黑洞”设备，所有输入都会被丢弃</p>\n</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;blabla&quot;</span> &gt; dest.file<br><br><span class=\"hljs-comment\"># 输出所有输出到文件</span><br><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;blabla&quot;</span> 1 &gt; dest.file<br><br><span class=\"hljs-comment\"># 只输出错误输出到文件</span><br><span class=\"hljs-built_in\">rm</span> filenotexists 2 &gt; err.log<br><br><span class=\"hljs-comment\"># 输出所有输出到文件</span><br><span class=\"hljs-built_in\">rm</span> somefile 1 &gt; dest.file 2&gt;&amp;1<br><br><span class=\"hljs-comment\"># 输出非错误输出到文件</span><br><span class=\"hljs-built_in\">rm</span> somefile 1 &gt; dest.file 2 &gt; dev/null<br><br><span class=\"hljs-comment\"># 创建两条管道</span><br><span class=\"hljs-built_in\">rm</span> somefile 1 &gt; <span class=\"hljs-built_in\">log</span> 2 &gt; <span class=\"hljs-built_in\">log</span><br><br><span class=\"hljs-comment\"># 2的管道继承于1</span><br><span class=\"hljs-built_in\">rm</span> somefile 1 &gt; <span class=\"hljs-built_in\">log</span> 2&gt;&amp;1<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>创建固定大小的空文件</p>\n<p>当<code>dev/zero</code>作为输入流的时候，会产生无限的0 (不是ASCII的’0’)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-comment\"># input file is /dev/zero</span><br><span class=\"hljs-comment\"># output file is file</span><br><span class=\"hljs-comment\"># write 10 times</span><br><span class=\"hljs-comment\"># 1024 bytes every time</span><br><span class=\"hljs-comment\"># so it creates a 10k blank file</span><br><span class=\"hljs-built_in\">dd</span> <span class=\"hljs-keyword\">if</span>=/dev/zero of=file count=10 bs=1024<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>if else</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">a=10<br>b=20<br><span class=\"hljs-keyword\">if</span> [ <span class=\"hljs-variable\">$a</span> == <span class=\"hljs-variable\">$b</span> ]<br><span class=\"hljs-keyword\">then</span><br>   <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;a is equal to b&quot;</span><br><span class=\"hljs-keyword\">elif</span> [ <span class=\"hljs-variable\">$a</span> -gt <span class=\"hljs-variable\">$b</span> ]<br><span class=\"hljs-keyword\">then</span><br>   <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;a greater than b&quot;</span><br><span class=\"hljs-keyword\">elif</span> [ <span class=\"hljs-variable\">$a</span> -lt <span class=\"hljs-variable\">$b</span> ]<br><span class=\"hljs-keyword\">then</span><br>   <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;a less than b&quot;</span><br><span class=\"hljs-keyword\">else</span><br>   <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;&quot;</span><br><span class=\"hljs-keyword\">fi</span><br></code></pre></td></tr></table></figure>\n</li>\n<li><p>追加到文件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">file1 &gt;&gt; file2<br><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;tails&quot;</span> &gt;&gt; file<br><span class=\"hljs-built_in\">date</span> &gt;&gt; file<br></code></pre></td></tr></table></figure></li>\n</ul>\n","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":997,"excerpt":"","more":"<ul>\n<li><p>接受用户输入</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">read</span> var<br><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;input value is <span class=\"hljs-variable\">$var</span>&quot;</span><br></code></pre></td></tr></table></figure>\n</li>\n<li><p>成功后执行</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">rm</span> somefile &amp;&amp; <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;removed&quot;</span><br></code></pre></td></tr></table></figure>\n</li>\n<li><p>失败后执行</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">rm</span> filenotexists || <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;nothing removed&quot;</span><br></code></pre></td></tr></table></figure>\n</li>\n<li><p>重定向输出</p>\n<ul>\n<li><p><code>1</code>代表<code>stdout</code>, 标准输出</p>\n</li>\n<li><p><code>2</code>代表<code>stderr</code>, 标准错误输出</p>\n</li>\n<li><p><code>&amp;</code>代表”按照相同方式输出”</p>\n</li>\n<li><p><code>dev/null</code>是null文件，可以理解为一个“黑洞”设备，所有输入都会被丢弃</p>\n</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;blabla&quot;</span> &gt; dest.file<br><br><span class=\"hljs-comment\"># 输出所有输出到文件</span><br><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;blabla&quot;</span> 1 &gt; dest.file<br><br><span class=\"hljs-comment\"># 只输出错误输出到文件</span><br><span class=\"hljs-built_in\">rm</span> filenotexists 2 &gt; err.log<br><br><span class=\"hljs-comment\"># 输出所有输出到文件</span><br><span class=\"hljs-built_in\">rm</span> somefile 1 &gt; dest.file 2&gt;&amp;1<br><br><span class=\"hljs-comment\"># 输出非错误输出到文件</span><br><span class=\"hljs-built_in\">rm</span> somefile 1 &gt; dest.file 2 &gt; dev/null<br><br><span class=\"hljs-comment\"># 创建两条管道</span><br><span class=\"hljs-built_in\">rm</span> somefile 1 &gt; <span class=\"hljs-built_in\">log</span> 2 &gt; <span class=\"hljs-built_in\">log</span><br><br><span class=\"hljs-comment\"># 2的管道继承于1</span><br><span class=\"hljs-built_in\">rm</span> somefile 1 &gt; <span class=\"hljs-built_in\">log</span> 2&gt;&amp;1<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>创建固定大小的空文件</p>\n<p>当<code>dev/zero</code>作为输入流的时候，会产生无限的0 (不是ASCII的’0’)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-comment\"># input file is /dev/zero</span><br><span class=\"hljs-comment\"># output file is file</span><br><span class=\"hljs-comment\"># write 10 times</span><br><span class=\"hljs-comment\"># 1024 bytes every time</span><br><span class=\"hljs-comment\"># so it creates a 10k blank file</span><br><span class=\"hljs-built_in\">dd</span> <span class=\"hljs-keyword\">if</span>=/dev/zero of=file count=10 bs=1024<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>if else</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">a=10<br>b=20<br><span class=\"hljs-keyword\">if</span> [ <span class=\"hljs-variable\">$a</span> == <span class=\"hljs-variable\">$b</span> ]<br><span class=\"hljs-keyword\">then</span><br>   <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;a is equal to b&quot;</span><br><span class=\"hljs-keyword\">elif</span> [ <span class=\"hljs-variable\">$a</span> -gt <span class=\"hljs-variable\">$b</span> ]<br><span class=\"hljs-keyword\">then</span><br>   <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;a greater than b&quot;</span><br><span class=\"hljs-keyword\">elif</span> [ <span class=\"hljs-variable\">$a</span> -lt <span class=\"hljs-variable\">$b</span> ]<br><span class=\"hljs-keyword\">then</span><br>   <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;a less than b&quot;</span><br><span class=\"hljs-keyword\">else</span><br>   <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;&quot;</span><br><span class=\"hljs-keyword\">fi</span><br></code></pre></td></tr></table></figure>\n</li>\n<li><p>追加到文件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">file1 &gt;&gt; file2<br><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;tails&quot;</span> &gt;&gt; file<br><span class=\"hljs-built_in\">date</span> &gt;&gt; file<br></code></pre></td></tr></table></figure></li>\n</ul>\n"},{"title":"MySQL中的大小写敏感排序规则","date":"2022-06-17T07:51:08.000Z","_content":"\n## utf8mb4字符集排序规则\n\n在MySQL8.0.1之前，utf8mb4没有cs排序规则，大小写敏感的排序规则只能用`utf8mb4_bin`，然后通过类似于`SELECT ... ORDER BY column COLLATE utf8_croatian_ci.`的方法来得到更“human”的排序结果。（bin的排序方式按照类似ACSII顺序，比如大小写的字母不一定会在一起）\n- [SELECT * FROM mytable WHERE name COLLATE utf8_bin =\"azolia\"](https://forums.mysql.com/read.php?103,156527,198794#msg-198794)\n- [SELECT ... ORDER BY column COLLATE utf8_croatian_ci](https://forums.mysql.com/read.php?103,19380,200971#msg-200971)\n\n\nMySQL8.0.1之后的版本支持utf8mb4字符集的大小写敏感排序规则（utf8mb4_0900_*_as_cs）\n\n> 0900是指unicode的版本，同utf8mb4_general_520_ci的520，都应该是指排序算法版本（一种类似谁前谁后的排序规则），没有细究\n> as表示accent sensitive（竟然支持了重音排序，他真的，我哭死...）\n\n- [MySQL 8.0.1: Accent and case sensitive collations for utf8mb4](https://dev.mysql.com/blog-archive/mysql-8-0-1-accent-and-case-sensitive-collations-for-utf8mb4/)\n- [New collations in MySQL 8.0.0](https://dev.mysql.com/blog-archive/new-collations-in-mysql-8-0-0/)\n","source":"_posts/case-sensitive-collation-in-mysql.md","raw":"---\ntitle: MySQL中的大小写敏感排序规则\ndate: 2022-06-17 15:51:08\ntags:\n    - MySQL\n    - charset\n    - collation\ncategories:\n    - MySQL\n---\n\n## utf8mb4字符集排序规则\n\n在MySQL8.0.1之前，utf8mb4没有cs排序规则，大小写敏感的排序规则只能用`utf8mb4_bin`，然后通过类似于`SELECT ... ORDER BY column COLLATE utf8_croatian_ci.`的方法来得到更“human”的排序结果。（bin的排序方式按照类似ACSII顺序，比如大小写的字母不一定会在一起）\n- [SELECT * FROM mytable WHERE name COLLATE utf8_bin =\"azolia\"](https://forums.mysql.com/read.php?103,156527,198794#msg-198794)\n- [SELECT ... ORDER BY column COLLATE utf8_croatian_ci](https://forums.mysql.com/read.php?103,19380,200971#msg-200971)\n\n\nMySQL8.0.1之后的版本支持utf8mb4字符集的大小写敏感排序规则（utf8mb4_0900_*_as_cs）\n\n> 0900是指unicode的版本，同utf8mb4_general_520_ci的520，都应该是指排序算法版本（一种类似谁前谁后的排序规则），没有细究\n> as表示accent sensitive（竟然支持了重音排序，他真的，我哭死...）\n\n- [MySQL 8.0.1: Accent and case sensitive collations for utf8mb4](https://dev.mysql.com/blog-archive/mysql-8-0-1-accent-and-case-sensitive-collations-for-utf8mb4/)\n- [New collations in MySQL 8.0.0](https://dev.mysql.com/blog-archive/new-collations-in-mysql-8-0-0/)\n","slug":"case-sensitive-collation-in-mysql","published":1,"updated":"2022-06-18T13:34:55.711Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl4jxc2d60010noou5g1oad73","content":"<h2 id=\"utf8mb4字符集排序规则\"><a href=\"#utf8mb4字符集排序规则\" class=\"headerlink\" title=\"utf8mb4字符集排序规则\"></a>utf8mb4字符集排序规则</h2><p>在MySQL8.0.1之前，utf8mb4没有cs排序规则，大小写敏感的排序规则只能用<code>utf8mb4_bin</code>，然后通过类似于<code>SELECT ... ORDER BY column COLLATE utf8_croatian_ci.</code>的方法来得到更“human”的排序结果。（bin的排序方式按照类似ACSII顺序，比如大小写的字母不一定会在一起）</p>\n<ul>\n<li><a href=\"https://forums.mysql.com/read.php?103,156527,198794#msg-198794\">SELECT * FROM mytable WHERE name COLLATE utf8_bin &#x3D;”azolia”</a></li>\n<li><a href=\"https://forums.mysql.com/read.php?103,19380,200971#msg-200971\">SELECT … ORDER BY column COLLATE utf8_croatian_ci</a></li>\n</ul>\n<p>MySQL8.0.1之后的版本支持utf8mb4字符集的大小写敏感排序规则（utf8mb4_0900_*_as_cs）</p>\n<blockquote>\n<p>0900是指unicode的版本，同utf8mb4_general_520_ci的520，都应该是指排序算法版本（一种类似谁前谁后的排序规则），没有细究<br>as表示accent sensitive（竟然支持了重音排序，他真的，我哭死…）</p>\n</blockquote>\n<ul>\n<li><a href=\"https://dev.mysql.com/blog-archive/mysql-8-0-1-accent-and-case-sensitive-collations-for-utf8mb4/\">MySQL 8.0.1: Accent and case sensitive collations for utf8mb4</a></li>\n<li><a href=\"https://dev.mysql.com/blog-archive/new-collations-in-mysql-8-0-0/\">New collations in MySQL 8.0.0</a></li>\n</ul>\n","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":530,"excerpt":"","more":"<h2 id=\"utf8mb4字符集排序规则\"><a href=\"#utf8mb4字符集排序规则\" class=\"headerlink\" title=\"utf8mb4字符集排序规则\"></a>utf8mb4字符集排序规则</h2><p>在MySQL8.0.1之前，utf8mb4没有cs排序规则，大小写敏感的排序规则只能用<code>utf8mb4_bin</code>，然后通过类似于<code>SELECT ... ORDER BY column COLLATE utf8_croatian_ci.</code>的方法来得到更“human”的排序结果。（bin的排序方式按照类似ACSII顺序，比如大小写的字母不一定会在一起）</p>\n<ul>\n<li><a href=\"https://forums.mysql.com/read.php?103,156527,198794#msg-198794\">SELECT * FROM mytable WHERE name COLLATE utf8_bin &#x3D;”azolia”</a></li>\n<li><a href=\"https://forums.mysql.com/read.php?103,19380,200971#msg-200971\">SELECT … ORDER BY column COLLATE utf8_croatian_ci</a></li>\n</ul>\n<p>MySQL8.0.1之后的版本支持utf8mb4字符集的大小写敏感排序规则（utf8mb4_0900_*_as_cs）</p>\n<blockquote>\n<p>0900是指unicode的版本，同utf8mb4_general_520_ci的520，都应该是指排序算法版本（一种类似谁前谁后的排序规则），没有细究<br>as表示accent sensitive（竟然支持了重音排序，他真的，我哭死…）</p>\n</blockquote>\n<ul>\n<li><a href=\"https://dev.mysql.com/blog-archive/mysql-8-0-1-accent-and-case-sensitive-collations-for-utf8mb4/\">MySQL 8.0.1: Accent and case sensitive collations for utf8mb4</a></li>\n<li><a href=\"https://dev.mysql.com/blog-archive/new-collations-in-mysql-8-0-0/\">New collations in MySQL 8.0.0</a></li>\n</ul>\n"},{"title":"Spring rabbitMQ binding配置的“陷阱”","date":"2022-06-14T12:31:59.000Z","_content":"\n## Spring RabbitMQ bindings\n\n> exchange的`auto-declare`配置同时作用于binding，如果声明新的queue，但是绑定的exchange的auto-declare为false，则不会在既有的exchange上进行绑定\n\n```xml\n  <rabbit:queue id=\"queue0.id\" name=\"queue.0.name\"/>\n  <rabbit:fanout-exchange name=\"exchange.0.name\">\n    <rabbit:bindings>\n      <rabbit:binding queue=\"queue0.id\"/>\n    </rabbit:bindings>\n  </rabbit:fanout-exchange>\n```\n\n解析binding的入口：\n```java\n    protected void doParseBindings(Element element, ParserContext parserContext,\n\t\t\tString exchangeName, Element bindings, AbstractExchangeParser parser) {\n\t\tif (bindings != null) {\n\t\t\tfor (Element binding : DomUtils.getChildElementsByTagName(bindings, BINDING_ELE)) {\n                // 解析rabbit:binding\n\t\t\t\tBeanDefinitionBuilder bindingBuilder = parser.parseBinding(exchangeName, binding,\n\t\t\t\t\t\tparserContext);\n                // 这里是重点，解析bindings的时候，传入的是element，也就是rabbit:fanout-exchange对应的元素\n\t\t\t\tNamespaceUtils.parseDeclarationControls(element, bindingBuilder);\n\t\t\t\tBeanDefinition beanDefinition = bindingBuilder.getBeanDefinition();\n\t\t\t\tregisterBeanDefinition(new BeanDefinitionHolder(beanDefinition, parserContext.getReaderContext()\n\t\t\t\t\t\t.generateBeanName(beanDefinition)), parserContext.getRegistry());\n\t\t\t}\n\t\t}\n\t}\n```\n\n每个binding的自动声明`shouldDeclare`属性的设置：\n```java\n\t/**\n\t * Parses 'auto-declare' and 'declared-by' attributes.\n\t *\n\t * @param element The element.\n\t * @param builder The builder.\n\t */\n\tpublic static void parseDeclarationControls(Element element, BeanDefinitionBuilder builder) {\n        // 这里用exchange的auto-declare属性为每个binding设置shouldDeclare值\n\t\tNamespaceUtils.setValueIfAttributeDefined(builder, element, \"auto-declare\", \"shouldDeclare\");\n\t\tString admins = element.getAttribute(\"declared-by\");\n\t\tif (StringUtils.hasText(admins)) {\n\t\t\tString[] adminBeanNames = admins.split(\",\");\n\t\t\tManagedList<BeanReference> adminBeanRefs = new ManagedList<BeanReference>();\n\t\t\tfor (String adminBeanName : adminBeanNames) {\n\t\t\t\tadminBeanRefs.add(new RuntimeBeanReference(adminBeanName.trim()));\n\t\t\t}\n\t\t\tbuilder.addPropertyValue(\"adminsThatShouldDeclare\", adminBeanRefs);\n\t\t}\n\t\tNamespaceUtils.setValueIfAttributeDefined(builder, element, \"ignore-declaration-exceptions\");\n\t}\n```\n\n`shouldDeclare`在声明中的作用:\n```java\n\n\t/**\n\t * Remove any instances that should not be declared by this admin.\n\t * @param declarables the collection of {@link Declarable}s.\n\t * @return a new collection containing {@link Declarable}s that should be declared by this\n\t * admin.\n\t */\n\tprivate <T extends Declarable> Collection<T> filterDeclarables(Collection<T> declarables) {\n\t\tCollection<T> filtered = new ArrayList<T>();\n\t\tfor (T declarable : declarables) {\n\t\t\tCollection<?> adminsWithWhichToDeclare = declarable.getDeclaringAdmins();\n            // 此处只保留shouldDeclare=true的bean\n\t\t\tif (declarable.shouldDeclare() &&\n\t\t\t\t\t(adminsWithWhichToDeclare.isEmpty() || adminsWithWhichToDeclare.contains(this))) {\n\t\t\t\tfiltered.add(declarable);\n\t\t\t}\n\t\t}\n\t\treturn filtered;\n\t}\n```\n\n初始化的部分：\n```java\n\n\t/**\n\t * Declares all the exchanges, queues and bindings in the enclosing application context, if any. It should be safe\n\t * (but unnecessary) to call this method more than once.\n\t */\n\tpublic void initialize() {\n\n\t\t...\n\n\t\tfinal Collection<Exchange> exchanges = filterDeclarables(contextExchanges);\n\t\tfinal Collection<Queue> queues = filterDeclarables(contextQueues);\n        // 这里过滤掉了shouldDeclare=false的binding\n\t\tfinal Collection<Binding> bindings = filterDeclarables(contextBindings);\n\n\t\t...\n\n\t\tthis.rabbitTemplate.execute(new ChannelCallback<Object>() {\n\n\t\t\t@Override\n\t\t\tpublic Object doInRabbit(Channel channel) throws Exception {\n\t\t\t\tdeclareExchanges(channel, exchanges.toArray(new Exchange[exchanges.size()]));\n\t\t\t\tdeclareQueues(channel, queues.toArray(new Queue[queues.size()]));\n                // 向rabbit声明binding的部分\n\t\t\t\tdeclareBindings(channel, bindings.toArray(new Binding[bindings.size()]));\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\t\tthis.logger.debug(\"Declarations finished\");\n\n\t}\n```","source":"_posts/spring-rabbitmq-binding-trap.md","raw":"---\ntitle: Spring rabbitMQ binding配置的“陷阱”\ndate: 2022-06-14 20:31:59\ncategories: \n\t- Spring\ntags:\n\t- RabbitMQ\n\t- Spring\n---\n\n## Spring RabbitMQ bindings\n\n> exchange的`auto-declare`配置同时作用于binding，如果声明新的queue，但是绑定的exchange的auto-declare为false，则不会在既有的exchange上进行绑定\n\n```xml\n  <rabbit:queue id=\"queue0.id\" name=\"queue.0.name\"/>\n  <rabbit:fanout-exchange name=\"exchange.0.name\">\n    <rabbit:bindings>\n      <rabbit:binding queue=\"queue0.id\"/>\n    </rabbit:bindings>\n  </rabbit:fanout-exchange>\n```\n\n解析binding的入口：\n```java\n    protected void doParseBindings(Element element, ParserContext parserContext,\n\t\t\tString exchangeName, Element bindings, AbstractExchangeParser parser) {\n\t\tif (bindings != null) {\n\t\t\tfor (Element binding : DomUtils.getChildElementsByTagName(bindings, BINDING_ELE)) {\n                // 解析rabbit:binding\n\t\t\t\tBeanDefinitionBuilder bindingBuilder = parser.parseBinding(exchangeName, binding,\n\t\t\t\t\t\tparserContext);\n                // 这里是重点，解析bindings的时候，传入的是element，也就是rabbit:fanout-exchange对应的元素\n\t\t\t\tNamespaceUtils.parseDeclarationControls(element, bindingBuilder);\n\t\t\t\tBeanDefinition beanDefinition = bindingBuilder.getBeanDefinition();\n\t\t\t\tregisterBeanDefinition(new BeanDefinitionHolder(beanDefinition, parserContext.getReaderContext()\n\t\t\t\t\t\t.generateBeanName(beanDefinition)), parserContext.getRegistry());\n\t\t\t}\n\t\t}\n\t}\n```\n\n每个binding的自动声明`shouldDeclare`属性的设置：\n```java\n\t/**\n\t * Parses 'auto-declare' and 'declared-by' attributes.\n\t *\n\t * @param element The element.\n\t * @param builder The builder.\n\t */\n\tpublic static void parseDeclarationControls(Element element, BeanDefinitionBuilder builder) {\n        // 这里用exchange的auto-declare属性为每个binding设置shouldDeclare值\n\t\tNamespaceUtils.setValueIfAttributeDefined(builder, element, \"auto-declare\", \"shouldDeclare\");\n\t\tString admins = element.getAttribute(\"declared-by\");\n\t\tif (StringUtils.hasText(admins)) {\n\t\t\tString[] adminBeanNames = admins.split(\",\");\n\t\t\tManagedList<BeanReference> adminBeanRefs = new ManagedList<BeanReference>();\n\t\t\tfor (String adminBeanName : adminBeanNames) {\n\t\t\t\tadminBeanRefs.add(new RuntimeBeanReference(adminBeanName.trim()));\n\t\t\t}\n\t\t\tbuilder.addPropertyValue(\"adminsThatShouldDeclare\", adminBeanRefs);\n\t\t}\n\t\tNamespaceUtils.setValueIfAttributeDefined(builder, element, \"ignore-declaration-exceptions\");\n\t}\n```\n\n`shouldDeclare`在声明中的作用:\n```java\n\n\t/**\n\t * Remove any instances that should not be declared by this admin.\n\t * @param declarables the collection of {@link Declarable}s.\n\t * @return a new collection containing {@link Declarable}s that should be declared by this\n\t * admin.\n\t */\n\tprivate <T extends Declarable> Collection<T> filterDeclarables(Collection<T> declarables) {\n\t\tCollection<T> filtered = new ArrayList<T>();\n\t\tfor (T declarable : declarables) {\n\t\t\tCollection<?> adminsWithWhichToDeclare = declarable.getDeclaringAdmins();\n            // 此处只保留shouldDeclare=true的bean\n\t\t\tif (declarable.shouldDeclare() &&\n\t\t\t\t\t(adminsWithWhichToDeclare.isEmpty() || adminsWithWhichToDeclare.contains(this))) {\n\t\t\t\tfiltered.add(declarable);\n\t\t\t}\n\t\t}\n\t\treturn filtered;\n\t}\n```\n\n初始化的部分：\n```java\n\n\t/**\n\t * Declares all the exchanges, queues and bindings in the enclosing application context, if any. It should be safe\n\t * (but unnecessary) to call this method more than once.\n\t */\n\tpublic void initialize() {\n\n\t\t...\n\n\t\tfinal Collection<Exchange> exchanges = filterDeclarables(contextExchanges);\n\t\tfinal Collection<Queue> queues = filterDeclarables(contextQueues);\n        // 这里过滤掉了shouldDeclare=false的binding\n\t\tfinal Collection<Binding> bindings = filterDeclarables(contextBindings);\n\n\t\t...\n\n\t\tthis.rabbitTemplate.execute(new ChannelCallback<Object>() {\n\n\t\t\t@Override\n\t\t\tpublic Object doInRabbit(Channel channel) throws Exception {\n\t\t\t\tdeclareExchanges(channel, exchanges.toArray(new Exchange[exchanges.size()]));\n\t\t\t\tdeclareQueues(channel, queues.toArray(new Queue[queues.size()]));\n                // 向rabbit声明binding的部分\n\t\t\t\tdeclareBindings(channel, bindings.toArray(new Binding[bindings.size()]));\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\t\tthis.logger.debug(\"Declarations finished\");\n\n\t}\n```","slug":"spring-rabbitmq-binding-trap","published":1,"updated":"2022-06-18T13:36:10.158Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl4jxc2d80012noouhvoh4730","content":"<h2 id=\"Spring-RabbitMQ-bindings\"><a href=\"#Spring-RabbitMQ-bindings\" class=\"headerlink\" title=\"Spring RabbitMQ bindings\"></a>Spring RabbitMQ bindings</h2><blockquote>\n<p>exchange的<code>auto-declare</code>配置同时作用于binding，如果声明新的queue，但是绑定的exchange的auto-declare为false，则不会在既有的exchange上进行绑定</p>\n</blockquote>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">rabbit:queue</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;queue0.id&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;queue.0.name&quot;</span>/&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">rabbit:fanout-exchange</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;exchange.0.name&quot;</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">rabbit:bindings</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">rabbit:binding</span> <span class=\"hljs-attr\">queue</span>=<span class=\"hljs-string\">&quot;queue0.id&quot;</span>/&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">rabbit:bindings</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">rabbit:fanout-exchange</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p>解析binding的入口：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">   <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">doParseBindings</span><span class=\"hljs-params\">(Element element, ParserContext parserContext,</span><br><span class=\"hljs-params\">\t\tString exchangeName, Element bindings, AbstractExchangeParser parser)</span> &#123;<br>\t<span class=\"hljs-keyword\">if</span> (bindings != <span class=\"hljs-literal\">null</span>) &#123;<br>\t\t<span class=\"hljs-keyword\">for</span> (Element binding : DomUtils.getChildElementsByTagName(bindings, BINDING_ELE)) &#123;<br>               <span class=\"hljs-comment\">// 解析rabbit:binding</span><br>\t\t\t<span class=\"hljs-type\">BeanDefinitionBuilder</span> <span class=\"hljs-variable\">bindingBuilder</span> <span class=\"hljs-operator\">=</span> parser.parseBinding(exchangeName, binding,<br>\t\t\t\t\tparserContext);<br>               <span class=\"hljs-comment\">// 这里是重点，解析bindings的时候，传入的是element，也就是rabbit:fanout-exchange对应的元素</span><br>\t\t\tNamespaceUtils.parseDeclarationControls(element, bindingBuilder);<br>\t\t\t<span class=\"hljs-type\">BeanDefinition</span> <span class=\"hljs-variable\">beanDefinition</span> <span class=\"hljs-operator\">=</span> bindingBuilder.getBeanDefinition();<br>\t\t\tregisterBeanDefinition(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">BeanDefinitionHolder</span>(beanDefinition, parserContext.getReaderContext()<br>\t\t\t\t\t.generateBeanName(beanDefinition)), parserContext.getRegistry());<br>\t\t&#125;<br>\t&#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>每个binding的自动声明<code>shouldDeclare</code>属性的设置：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Parses &#x27;auto-declare&#x27; and &#x27;declared-by&#x27; attributes.</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@param</span> element The element.</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@param</span> builder The builder.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">parseDeclarationControls</span><span class=\"hljs-params\">(Element element, BeanDefinitionBuilder builder)</span> &#123;<br>       <span class=\"hljs-comment\">// 这里用exchange的auto-declare属性为每个binding设置shouldDeclare值</span><br>\tNamespaceUtils.setValueIfAttributeDefined(builder, element, <span class=\"hljs-string\">&quot;auto-declare&quot;</span>, <span class=\"hljs-string\">&quot;shouldDeclare&quot;</span>);<br>\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">admins</span> <span class=\"hljs-operator\">=</span> element.getAttribute(<span class=\"hljs-string\">&quot;declared-by&quot;</span>);<br>\t<span class=\"hljs-keyword\">if</span> (StringUtils.hasText(admins)) &#123;<br>\t\tString[] adminBeanNames = admins.split(<span class=\"hljs-string\">&quot;,&quot;</span>);<br>\t\tManagedList&lt;BeanReference&gt; adminBeanRefs = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ManagedList</span>&lt;BeanReference&gt;();<br>\t\t<span class=\"hljs-keyword\">for</span> (String adminBeanName : adminBeanNames) &#123;<br>\t\t\tadminBeanRefs.add(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">RuntimeBeanReference</span>(adminBeanName.trim()));<br>\t\t&#125;<br>\t\tbuilder.addPropertyValue(<span class=\"hljs-string\">&quot;adminsThatShouldDeclare&quot;</span>, adminBeanRefs);<br>\t&#125;<br>\tNamespaceUtils.setValueIfAttributeDefined(builder, element, <span class=\"hljs-string\">&quot;ignore-declaration-exceptions&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p><code>shouldDeclare</code>在声明中的作用:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Remove any instances that should not be declared by this admin.</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@param</span> declarables the collection of &#123;<span class=\"hljs-doctag\">@link</span> Declarable&#125;s.</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@return</span> a new collection containing &#123;<span class=\"hljs-doctag\">@link</span> Declarable&#125;s that should be declared by this</span><br><span class=\"hljs-comment\"> * admin.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">private</span> &lt;T <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">Declarable</span>&gt; Collection&lt;T&gt; <span class=\"hljs-title function_\">filterDeclarables</span><span class=\"hljs-params\">(Collection&lt;T&gt; declarables)</span> &#123;<br>\tCollection&lt;T&gt; filtered = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayList</span>&lt;T&gt;();<br>\t<span class=\"hljs-keyword\">for</span> (T declarable : declarables) &#123;<br>\t\tCollection&lt;?&gt; adminsWithWhichToDeclare = declarable.getDeclaringAdmins();<br>           <span class=\"hljs-comment\">// 此处只保留shouldDeclare=true的bean</span><br>\t\t<span class=\"hljs-keyword\">if</span> (declarable.shouldDeclare() &amp;&amp;<br>\t\t\t\t(adminsWithWhichToDeclare.isEmpty() || adminsWithWhichToDeclare.contains(<span class=\"hljs-built_in\">this</span>))) &#123;<br>\t\t\tfiltered.add(declarable);<br>\t\t&#125;<br>\t&#125;<br>\t<span class=\"hljs-keyword\">return</span> filtered;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>初始化的部分：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Declares all the exchanges, queues and bindings in the enclosing application context, if any. It should be safe</span><br><span class=\"hljs-comment\"> * (but unnecessary) to call this method more than once.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">initialize</span><span class=\"hljs-params\">()</span> &#123;<br><br>\t...<br><br>\t<span class=\"hljs-keyword\">final</span> Collection&lt;Exchange&gt; exchanges = filterDeclarables(contextExchanges);<br>\t<span class=\"hljs-keyword\">final</span> Collection&lt;Queue&gt; queues = filterDeclarables(contextQueues);<br>       <span class=\"hljs-comment\">// 这里过滤掉了shouldDeclare=false的binding</span><br>\t<span class=\"hljs-keyword\">final</span> Collection&lt;Binding&gt; bindings = filterDeclarables(contextBindings);<br><br>\t...<br><br>\t<span class=\"hljs-built_in\">this</span>.rabbitTemplate.execute(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ChannelCallback</span>&lt;Object&gt;() &#123;<br><br>\t\t<span class=\"hljs-meta\">@Override</span><br>\t\t<span class=\"hljs-keyword\">public</span> Object <span class=\"hljs-title function_\">doInRabbit</span><span class=\"hljs-params\">(Channel channel)</span> <span class=\"hljs-keyword\">throws</span> Exception &#123;<br>\t\t\tdeclareExchanges(channel, exchanges.toArray(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Exchange</span>[exchanges.size()]));<br>\t\t\tdeclareQueues(channel, queues.toArray(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Queue</span>[queues.size()]));<br>               <span class=\"hljs-comment\">// 向rabbit声明binding的部分</span><br>\t\t\tdeclareBindings(channel, bindings.toArray(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Binding</span>[bindings.size()]));<br>\t\t\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;<br>\t\t&#125;<br>\t&#125;);<br>\t<span class=\"hljs-built_in\">this</span>.logger.debug(<span class=\"hljs-string\">&quot;Declarations finished&quot;</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure>","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":3816,"excerpt":"","more":"<h2 id=\"Spring-RabbitMQ-bindings\"><a href=\"#Spring-RabbitMQ-bindings\" class=\"headerlink\" title=\"Spring RabbitMQ bindings\"></a>Spring RabbitMQ bindings</h2><blockquote>\n<p>exchange的<code>auto-declare</code>配置同时作用于binding，如果声明新的queue，但是绑定的exchange的auto-declare为false，则不会在既有的exchange上进行绑定</p>\n</blockquote>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">rabbit:queue</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;queue0.id&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;queue.0.name&quot;</span>/&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">rabbit:fanout-exchange</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;exchange.0.name&quot;</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">rabbit:bindings</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">rabbit:binding</span> <span class=\"hljs-attr\">queue</span>=<span class=\"hljs-string\">&quot;queue0.id&quot;</span>/&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">rabbit:bindings</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">rabbit:fanout-exchange</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p>解析binding的入口：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">   <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">doParseBindings</span><span class=\"hljs-params\">(Element element, ParserContext parserContext,</span><br><span class=\"hljs-params\">\t\tString exchangeName, Element bindings, AbstractExchangeParser parser)</span> &#123;<br>\t<span class=\"hljs-keyword\">if</span> (bindings != <span class=\"hljs-literal\">null</span>) &#123;<br>\t\t<span class=\"hljs-keyword\">for</span> (Element binding : DomUtils.getChildElementsByTagName(bindings, BINDING_ELE)) &#123;<br>               <span class=\"hljs-comment\">// 解析rabbit:binding</span><br>\t\t\t<span class=\"hljs-type\">BeanDefinitionBuilder</span> <span class=\"hljs-variable\">bindingBuilder</span> <span class=\"hljs-operator\">=</span> parser.parseBinding(exchangeName, binding,<br>\t\t\t\t\tparserContext);<br>               <span class=\"hljs-comment\">// 这里是重点，解析bindings的时候，传入的是element，也就是rabbit:fanout-exchange对应的元素</span><br>\t\t\tNamespaceUtils.parseDeclarationControls(element, bindingBuilder);<br>\t\t\t<span class=\"hljs-type\">BeanDefinition</span> <span class=\"hljs-variable\">beanDefinition</span> <span class=\"hljs-operator\">=</span> bindingBuilder.getBeanDefinition();<br>\t\t\tregisterBeanDefinition(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">BeanDefinitionHolder</span>(beanDefinition, parserContext.getReaderContext()<br>\t\t\t\t\t.generateBeanName(beanDefinition)), parserContext.getRegistry());<br>\t\t&#125;<br>\t&#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>每个binding的自动声明<code>shouldDeclare</code>属性的设置：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Parses &#x27;auto-declare&#x27; and &#x27;declared-by&#x27; attributes.</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@param</span> element The element.</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@param</span> builder The builder.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">parseDeclarationControls</span><span class=\"hljs-params\">(Element element, BeanDefinitionBuilder builder)</span> &#123;<br>       <span class=\"hljs-comment\">// 这里用exchange的auto-declare属性为每个binding设置shouldDeclare值</span><br>\tNamespaceUtils.setValueIfAttributeDefined(builder, element, <span class=\"hljs-string\">&quot;auto-declare&quot;</span>, <span class=\"hljs-string\">&quot;shouldDeclare&quot;</span>);<br>\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">admins</span> <span class=\"hljs-operator\">=</span> element.getAttribute(<span class=\"hljs-string\">&quot;declared-by&quot;</span>);<br>\t<span class=\"hljs-keyword\">if</span> (StringUtils.hasText(admins)) &#123;<br>\t\tString[] adminBeanNames = admins.split(<span class=\"hljs-string\">&quot;,&quot;</span>);<br>\t\tManagedList&lt;BeanReference&gt; adminBeanRefs = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ManagedList</span>&lt;BeanReference&gt;();<br>\t\t<span class=\"hljs-keyword\">for</span> (String adminBeanName : adminBeanNames) &#123;<br>\t\t\tadminBeanRefs.add(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">RuntimeBeanReference</span>(adminBeanName.trim()));<br>\t\t&#125;<br>\t\tbuilder.addPropertyValue(<span class=\"hljs-string\">&quot;adminsThatShouldDeclare&quot;</span>, adminBeanRefs);<br>\t&#125;<br>\tNamespaceUtils.setValueIfAttributeDefined(builder, element, <span class=\"hljs-string\">&quot;ignore-declaration-exceptions&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p><code>shouldDeclare</code>在声明中的作用:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Remove any instances that should not be declared by this admin.</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@param</span> declarables the collection of &#123;<span class=\"hljs-doctag\">@link</span> Declarable&#125;s.</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@return</span> a new collection containing &#123;<span class=\"hljs-doctag\">@link</span> Declarable&#125;s that should be declared by this</span><br><span class=\"hljs-comment\"> * admin.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">private</span> &lt;T <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">Declarable</span>&gt; Collection&lt;T&gt; <span class=\"hljs-title function_\">filterDeclarables</span><span class=\"hljs-params\">(Collection&lt;T&gt; declarables)</span> &#123;<br>\tCollection&lt;T&gt; filtered = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayList</span>&lt;T&gt;();<br>\t<span class=\"hljs-keyword\">for</span> (T declarable : declarables) &#123;<br>\t\tCollection&lt;?&gt; adminsWithWhichToDeclare = declarable.getDeclaringAdmins();<br>           <span class=\"hljs-comment\">// 此处只保留shouldDeclare=true的bean</span><br>\t\t<span class=\"hljs-keyword\">if</span> (declarable.shouldDeclare() &amp;&amp;<br>\t\t\t\t(adminsWithWhichToDeclare.isEmpty() || adminsWithWhichToDeclare.contains(<span class=\"hljs-built_in\">this</span>))) &#123;<br>\t\t\tfiltered.add(declarable);<br>\t\t&#125;<br>\t&#125;<br>\t<span class=\"hljs-keyword\">return</span> filtered;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>初始化的部分：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Declares all the exchanges, queues and bindings in the enclosing application context, if any. It should be safe</span><br><span class=\"hljs-comment\"> * (but unnecessary) to call this method more than once.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">initialize</span><span class=\"hljs-params\">()</span> &#123;<br><br>\t...<br><br>\t<span class=\"hljs-keyword\">final</span> Collection&lt;Exchange&gt; exchanges = filterDeclarables(contextExchanges);<br>\t<span class=\"hljs-keyword\">final</span> Collection&lt;Queue&gt; queues = filterDeclarables(contextQueues);<br>       <span class=\"hljs-comment\">// 这里过滤掉了shouldDeclare=false的binding</span><br>\t<span class=\"hljs-keyword\">final</span> Collection&lt;Binding&gt; bindings = filterDeclarables(contextBindings);<br><br>\t...<br><br>\t<span class=\"hljs-built_in\">this</span>.rabbitTemplate.execute(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ChannelCallback</span>&lt;Object&gt;() &#123;<br><br>\t\t<span class=\"hljs-meta\">@Override</span><br>\t\t<span class=\"hljs-keyword\">public</span> Object <span class=\"hljs-title function_\">doInRabbit</span><span class=\"hljs-params\">(Channel channel)</span> <span class=\"hljs-keyword\">throws</span> Exception &#123;<br>\t\t\tdeclareExchanges(channel, exchanges.toArray(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Exchange</span>[exchanges.size()]));<br>\t\t\tdeclareQueues(channel, queues.toArray(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Queue</span>[queues.size()]));<br>               <span class=\"hljs-comment\">// 向rabbit声明binding的部分</span><br>\t\t\tdeclareBindings(channel, bindings.toArray(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Binding</span>[bindings.size()]));<br>\t\t\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;<br>\t\t&#125;<br>\t&#125;);<br>\t<span class=\"hljs-built_in\">this</span>.logger.debug(<span class=\"hljs-string\">&quot;Declarations finished&quot;</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure>"},{"title":"一些好用的工具","date":"2022-06-14T12:33:35.000Z","_content":"## UriComponentsBuilder\n\n`org.springframework.web.util.UriComponentsBuilder`\n\n> spring带的解析uri工具\n\n```java\n    String url = \"http://domain:port/path1/subpath1?param0=0&param1=1\";\n\n    UriComponentsBuilder.fromHttpUrl(url).build();\n    UriComponentsBuilder.fromUri(URI.create(uri)).build();\n    UriComponentsBuilder.fromUriString(uri).build();\n    ....\n\n    uriComponents.getHost(); // e.g. domain\n    uriComponents.getPath(); // e.g. /path1/subpath1\n    uriComponents.getPathSegments(); // e.g. [path1, subpath1]\n    uriComponents.getScheme(); // e.g. http\n    uriComponents.getQueryParams(); // [param0:0, param1:1]\n```\n","source":"_posts/useful-utils.md","raw":"---\ntitle: 一些好用的工具\ndate: 2022-06-14 20:33:35\ncategories: \n\t- tools\ntags:\n\t- URI\n\t- Spring\n---\n## UriComponentsBuilder\n\n`org.springframework.web.util.UriComponentsBuilder`\n\n> spring带的解析uri工具\n\n```java\n    String url = \"http://domain:port/path1/subpath1?param0=0&param1=1\";\n\n    UriComponentsBuilder.fromHttpUrl(url).build();\n    UriComponentsBuilder.fromUri(URI.create(uri)).build();\n    UriComponentsBuilder.fromUriString(uri).build();\n    ....\n\n    uriComponents.getHost(); // e.g. domain\n    uriComponents.getPath(); // e.g. /path1/subpath1\n    uriComponents.getPathSegments(); // e.g. [path1, subpath1]\n    uriComponents.getScheme(); // e.g. http\n    uriComponents.getQueryParams(); // [param0:0, param1:1]\n```\n","slug":"useful-utils","published":1,"updated":"2022-06-18T13:36:19.132Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl4jxc2da0014noou7agtb6gl","content":"<h2 id=\"UriComponentsBuilder\"><a href=\"#UriComponentsBuilder\" class=\"headerlink\" title=\"UriComponentsBuilder\"></a>UriComponentsBuilder</h2><p><code>org.springframework.web.util.UriComponentsBuilder</code></p>\n<blockquote>\n<p>spring带的解析uri工具</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">url</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;http://domain:port/path1/subpath1?param0=0&amp;param1=1&quot;</span>;<br><br>UriComponentsBuilder.fromHttpUrl(url).build();<br>UriComponentsBuilder.fromUri(URI.create(uri)).build();<br>UriComponentsBuilder.fromUriString(uri).build();<br>....<br><br>uriComponents.getHost(); <span class=\"hljs-comment\">// e.g. domain</span><br>uriComponents.getPath(); <span class=\"hljs-comment\">// e.g. /path1/subpath1</span><br>uriComponents.getPathSegments(); <span class=\"hljs-comment\">// e.g. [path1, subpath1]</span><br>uriComponents.getScheme(); <span class=\"hljs-comment\">// e.g. http</span><br>uriComponents.getQueryParams(); <span class=\"hljs-comment\">// [param0:0, param1:1]</span><br></code></pre></td></tr></table></figure>\n","site":{"data":{"languages/ja":{"name":"日本語","home":{"menu":"ホーム","title":"ホーム"},"archive":{"menu":"記録","title":"記録","subtitle":"記録","post_total":"全%d件の記事"},"category":{"menu":"分類","title":"分類","subtitle":"分類","post_total":"全%d件の記事","more":"さらに見る..."},"tag":{"menu":"付箋","title":"付箋","subtitle":"付箋","post_total":"全 %d 件の記事"},"about":{"menu":"サイト情報","title":"サイト情報","subtitle":"サイト情報"},"links":{"menu":"リンク","title":"リンク","subtitle":"リンク"},"page404":{"menu":"ページが見つかりませんでした","title":"ページが見つかりませんでした","subtitle":"ページが見つかりませんでした"},"post":{"toc":"目録","prev_post":"前の記事","next_post":"次の記事","updated":"最終更新日：%s","meta":{"wordcount":"単語数：%s","min2read":"約%s分間","views":"{} 閲覧"},"copyright":{"author":"作者","posted":"作成日","updated":"修正日","licensed":"著作権","CC":"CC - Creative Commons license","BY":"BY - Attribution","SA":"SA - Share-alike","NC":"NC - Non-commercial","ND":"ND - No derivative works"}},"footer":{"pv":"合計閲覧数: {}","uv":"合計閲覧者数: {}"},"search":{"title":"検索","keyword":"キーワード"},"noscript_warning":"このブログはJavaScriptを有効にすると最適に機能します"},"languages/zh-CN":{"name":"简体中文","home":{"menu":"首页","title":"首页"},"archive":{"menu":"归档","title":"归档","subtitle":"归档","post_total":"共计 %d 篇文章"},"category":{"menu":"分类","title":"分类","subtitle":"分类","post_total":"共计 %d 篇文章","more":"More..."},"tag":{"menu":"标签","title":"标签","subtitle":"标签","post_total":"共计 %d 篇文章"},"about":{"menu":"关于","title":"关于","subtitle":"关于"},"links":{"menu":"友链","title":"友链","subtitle":"友情链接"},"page404":{"menu":"页面不存在","title":"页面不存在","subtitle":"页面不存在"},"post":{"toc":"目录","prev_post":"上一篇","next_post":"下一篇","updated":"本文最后更新于：%s","meta":{"wordcount":"%s 字","min2read":"%s 分钟","views":"{} 次"},"copyright":{"author":"作者","posted":"发布于","updated":"更新于","licensed":"许可协议","CC":"CC - 知识共享许可协议","BY":"BY - 署名","SA":"SA - 相同方式共享","NC":"NC - 非商业性使用","ND":"ND - 禁止演绎"}},"footer":{"pv":"总访问量 {} 次","uv":"总访客数 {} 人"},"search":{"title":"搜索","keyword":"关键词"},"noscript_warning":"博客在允许 JavaScript 运行的环境下浏览效果更佳"}}},"wordcount":552,"excerpt":"","more":"<h2 id=\"UriComponentsBuilder\"><a href=\"#UriComponentsBuilder\" class=\"headerlink\" title=\"UriComponentsBuilder\"></a>UriComponentsBuilder</h2><p><code>org.springframework.web.util.UriComponentsBuilder</code></p>\n<blockquote>\n<p>spring带的解析uri工具</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">url</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;http://domain:port/path1/subpath1?param0=0&amp;param1=1&quot;</span>;<br><br>UriComponentsBuilder.fromHttpUrl(url).build();<br>UriComponentsBuilder.fromUri(URI.create(uri)).build();<br>UriComponentsBuilder.fromUriString(uri).build();<br>....<br><br>uriComponents.getHost(); <span class=\"hljs-comment\">// e.g. domain</span><br>uriComponents.getPath(); <span class=\"hljs-comment\">// e.g. /path1/subpath1</span><br>uriComponents.getPathSegments(); <span class=\"hljs-comment\">// e.g. [path1, subpath1]</span><br>uriComponents.getScheme(); <span class=\"hljs-comment\">// e.g. http</span><br>uriComponents.getQueryParams(); <span class=\"hljs-comment\">// [param0:0, param1:1]</span><br></code></pre></td></tr></table></figure>\n"}],"PostAsset":[{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/0.png","post":"cl4jxc2cv0007noouafti2s7a","slug":"0.png","modified":1,"renderable":1},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/1.png","post":"cl4jxc2cv0007noouafti2s7a","slug":"1.png","modified":1,"renderable":1},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/2.png","post":"cl4jxc2cv0007noouafti2s7a","slug":"2.png","modified":1,"renderable":1},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/3.png","post":"cl4jxc2cv0007noouafti2s7a","slug":"3.png","modified":1,"renderable":1},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/4.png","post":"cl4jxc2cv0007noouafti2s7a","slug":"4.png","modified":1,"renderable":1},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/5.png","post":"cl4jxc2cv0007noouafti2s7a","slug":"5.png","modified":1,"renderable":1},{"_id":"source/_posts/jvm-metaspace-leakage-caused-by-loading-dynamic-class/6.png","post":"cl4jxc2cv0007noouafti2s7a","slug":"6.png","modified":1,"renderable":1}],"PostCategory":[{"post_id":"cl4jxc2ck0001noou42redxtt","category_id":"cl4jxc2cs0004nooufebm5y9t","_id":"cl4jxc2cy000dnoougvbf443h"},{"post_id":"cl4jxc2cp0003noouf8cp64u5","category_id":"cl4jxc2cx000anoou1zdx13vh","_id":"cl4jxc2d0000gnoou2wz4dyof"},{"post_id":"cl4jxc2cv0007noouafti2s7a","category_id":"cl4jxc2cy000enoou3t4g0opk","_id":"cl4jxc2d1000knoouawdcb27b"},{"post_id":"cl4jxc2d5000znoou0n48aisg","category_id":"cl4jxc2cs0004nooufebm5y9t","_id":"cl4jxc2da0015noouh9b8cgwz"},{"post_id":"cl4jxc2d60010noou5g1oad73","category_id":"cl4jxc2d90013noou28ndcf74","_id":"cl4jxc2de001bnoou48674p0w"},{"post_id":"cl4jxc2d80012noouhvoh4730","category_id":"cl4jxc2de0018nooubnh92az8","_id":"cl4jxc2df001enoou6txifl19"},{"post_id":"cl4jxc2da0014noou7agtb6gl","category_id":"cl4jxc2de001cnooufqxg2ovz","_id":"cl4jxc2df001gnooueo866ipt"}],"PostTag":[{"post_id":"cl4jxc2ck0001noou42redxtt","tag_id":"cl4jxc2ct0005nooudyu855kh","_id":"cl4jxc2d1000inooud91nbusz"},{"post_id":"cl4jxc2ck0001noou42redxtt","tag_id":"cl4jxc2cx000bnoouhkbk5l4m","_id":"cl4jxc2d1000jnoou9amv9r34"},{"post_id":"cl4jxc2ck0001noou42redxtt","tag_id":"cl4jxc2d0000fnooue8m0dlgq","_id":"cl4jxc2d1000mnoou40fbgdu0"},{"post_id":"cl4jxc2cp0003noouf8cp64u5","tag_id":"cl4jxc2d1000hnoou66da7dfh","_id":"cl4jxc2d2000qnoou5lpu7vl3"},{"post_id":"cl4jxc2cp0003noouf8cp64u5","tag_id":"cl4jxc2d1000lnoou1sux71jz","_id":"cl4jxc2d2000rnoou2ke1g5tr"},{"post_id":"cl4jxc2cp0003noouf8cp64u5","tag_id":"cl4jxc2d1000nnoouhk8a5kwp","_id":"cl4jxc2d3000tnoou7eoq9lis"},{"post_id":"cl4jxc2cp0003noouf8cp64u5","tag_id":"cl4jxc2d2000onoouhdg7e8r4","_id":"cl4jxc2d3000unoou04m550a0"},{"post_id":"cl4jxc2cv0007noouafti2s7a","tag_id":"cl4jxc2d2000pnoouh4008oyc","_id":"cl4jxc2d3000wnooug6eb7gzn"},{"post_id":"cl4jxc2cv0007noouafti2s7a","tag_id":"cl4jxc2d2000snoougwi7fbpx","_id":"cl4jxc2d3000xnoouhg3z2wbh"},{"post_id":"cl4jxc2cv0007noouafti2s7a","tag_id":"cl4jxc2d3000vnoou47djdxsh","_id":"cl4jxc2d3000ynooub2pg4dyj"},{"post_id":"cl4jxc2d5000znoou0n48aisg","tag_id":"cl4jxc2d0000fnooue8m0dlgq","_id":"cl4jxc2de0017nooueik2ctqk"},{"post_id":"cl4jxc2d5000znoou0n48aisg","tag_id":"cl4jxc2d80011noou6kf12wya","_id":"cl4jxc2de0019noou82febzsj"},{"post_id":"cl4jxc2d60010noou5g1oad73","tag_id":"cl4jxc2db0016noouh9swgie9","_id":"cl4jxc2df001hnooud9r42wjw"},{"post_id":"cl4jxc2d60010noou5g1oad73","tag_id":"cl4jxc2de001anooudwph4m9v","_id":"cl4jxc2df001inooua9ap04sg"},{"post_id":"cl4jxc2d60010noou5g1oad73","tag_id":"cl4jxc2df001dnoou1cwy1pls","_id":"cl4jxc2dg001knoou3ilf5y4s"},{"post_id":"cl4jxc2d80012noouhvoh4730","tag_id":"cl4jxc2df001fnoougj954m5w","_id":"cl4jxc2dg001mnoou2zxv9885"},{"post_id":"cl4jxc2d80012noouhvoh4730","tag_id":"cl4jxc2dg001jnoou0oyoa5uz","_id":"cl4jxc2dg001nnooucu0b5a4z"},{"post_id":"cl4jxc2da0014noou7agtb6gl","tag_id":"cl4jxc2dg001lnooucbxf0fkv","_id":"cl4jxc2dh001pnoou2glcaeww"},{"post_id":"cl4jxc2da0014noou7agtb6gl","tag_id":"cl4jxc2dg001jnoou0oyoa5uz","_id":"cl4jxc2dh001qnooudff1ghbs"}],"Tag":[{"name":"setup","_id":"cl4jxc2ct0005nooudyu855kh"},{"name":"Arch Linux","_id":"cl4jxc2cx000bnoouhkbk5l4m"},{"name":"Linux","_id":"cl4jxc2d0000fnooue8m0dlgq"},{"name":"wallhack","_id":"cl4jxc2d1000hnoou66da7dfh"},{"name":"injection","_id":"cl4jxc2d1000lnoou1sux71jz"},{"name":"reverse engineering","_id":"cl4jxc2d1000nnoouhk8a5kwp"},{"name":"fgo","_id":"cl4jxc2d2000onoouhdg7e8r4"},{"name":"JVM","_id":"cl4jxc2d2000pnoouh4008oyc"},{"name":"JVM Memory","_id":"cl4jxc2d2000snoougwi7fbpx"},{"name":"Java","_id":"cl4jxc2d3000vnoou47djdxsh"},{"name":"shell script","_id":"cl4jxc2d80011noou6kf12wya"},{"name":"MySQL","_id":"cl4jxc2db0016noouh9swgie9"},{"name":"charset","_id":"cl4jxc2de001anooudwph4m9v"},{"name":"collation","_id":"cl4jxc2df001dnoou1cwy1pls"},{"name":"RabbitMQ","_id":"cl4jxc2df001fnoougj954m5w"},{"name":"Spring","_id":"cl4jxc2dg001jnoou0oyoa5uz"},{"name":"URI","_id":"cl4jxc2dg001lnooucbxf0fkv"}]}}